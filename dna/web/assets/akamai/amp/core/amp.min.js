function _typeof(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?babelHelpers.typeof=_typeof=function(e){return typeof e}:babelHelpers.typeof=_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _createRawReactElement(e,t,n,i){REACT_ELEMENT_TYPE=REACT_ELEMENT_TYPE||"function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;var r=e&&e.defaultProps,a=arguments.length-3;if(t||0==a||(t={children:void 0}),1==a)t.children=i;else if(1<a){for(var s=new Array(a),o=0;o<a;o++)s[o]=arguments[o+3];t.children=s}if(t&&r)for(var l in r)void 0===t[l]&&(t[l]=r[l]);else t=t||r||{};return{$$typeof:REACT_ELEMENT_TYPE,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function _asyncIterator(e){var t;if("undefined"!=typeof Symbol){if(Symbol.asyncIterator&&null!=(t=e[Symbol.asyncIterator]))return t.call(e);if(Symbol.iterator&&null!=(t=e[Symbol.iterator]))return t.call(e)}throw new TypeError("Object is not async iterable")}function AsyncGenerator(e){function t(i,r){try{var a=e[i](r),s=a.value,o=s instanceof babelHelpers.AwaitValue;Promise.resolve(o?s.wrapped:s).then(function(e){o?t("return"===i?"return":"next",e):n(a.done?"return":"normal",e)},function(e){t("throw",e)})}catch(e){n("throw",e)}}function n(e,n){switch(e){case"return":i.resolve({value:n,done:!0});break;case"throw":i.reject(n);break;default:i.resolve({value:n,done:!1})}(i=i.next)?t(i.key,i.arg):r=null}var i,r;this._invoke=function(e,n){return new Promise(function(a,s){s={key:e,arg:n,resolve:a,reject:s,next:null},r?r=r.next=s:(i=r=s,t(e,n))})},"function"!=typeof e.return&&(this.return=void 0)}function _asyncGeneratorDelegate(e,t){function n(n,i){return r=!0,i=new Promise(function(t){t(e[n](i))}),{done:!1,value:t(i)}}var i={},r=!1;return"function"==typeof Symbol&&Symbol.iterator&&(i[Symbol.iterator]=function(){return this}),i.next=function(e){return r?(r=!1,e):n("next",e)},"function"==typeof e.throw&&(i.throw=function(e){if(r)throw r=!1,e;return n("throw",e)}),"function"==typeof e.return&&(i.return=function(e){return r?(r=!1,e):n("return",e)}),i}function asyncGeneratorStep(e,t,n,i,r,a,s){try{var o=e[a](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(i,r)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){function a(e){asyncGeneratorStep(o,i,r,a,s,"next",e)}function s(e){asyncGeneratorStep(o,i,r,a,s,"throw",e)}var o=e.apply(t,n);a(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _defineEnumerableProperties(e,t){for(var n in t)(a=t[n]).configurable=a.enumerable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,n,a);if(Object.getOwnPropertySymbols)for(var i=Object.getOwnPropertySymbols(t),r=0;r<i.length;r++){var a,s=i[r];(a=t[s]).configurable=a.enumerable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,s,a)}return e}function _defaults(e,t){for(var n=Object.getOwnPropertyNames(t),i=0;i<n.length;i++){var r=n[i],a=Object.getOwnPropertyDescriptor(t,r);a&&a.configurable&&void 0===e[r]&&Object.defineProperty(e,r,a)}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _extends(){return babelHelpers.extends=_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,i=arguments[t];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},_extends.apply(this,arguments)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&babelHelpers.setPrototypeOf(e,t)}function _getPrototypeOf(e){return babelHelpers.getPrototypeOf=_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _setPrototypeOf(e,t){return babelHelpers.setPrototypeOf=_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _construct(e,t,n){return babelHelpers.isNativeReflectConstruct()?babelHelpers.construct=_construct=Reflect.construct:babelHelpers.construct=_construct=function(e,t,n){var i=[null];return i.push.apply(i,t),i=new(Function.bind.apply(e,i)),n&&babelHelpers.setPrototypeOf(i,n.prototype),i},_construct.apply(null,arguments)}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return babelHelpers.wrapNativeSuper=_wrapNativeSuper=function(e){function n(){return babelHelpers.construct(e,arguments,babelHelpers.getPrototypeOf(this).constructor)}if(null===e||!babelHelpers.isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),babelHelpers.setPrototypeOf(n,e)},_wrapNativeSuper(e)}function _instanceof(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache();if(t&&t.has(e))return t.get(e);var n,i,r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&((i=a?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n]);return r.default=e,t&&t.set(e,r),r}function _newArrowCheck(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}function _objectDestructuringEmpty(e){if(null==e)throw new TypeError("Cannot destructure undefined")}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};for(var n,i={},r=Object.keys(e),a=0;a<r.length;a++)n=r[a],0<=t.indexOf(n)||(i[n]=e[n]);return i}function _objectWithoutProperties(e,t){if(null==e)return{};var n,i=babelHelpers.objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(e),a=0;a<r.length;a++)n=r[a],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n]);return i}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?babelHelpers.assertThisInitialized(e):t}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=babelHelpers.getPrototypeOf(e)););return e}function _get(e,t,n){return"undefined"!=typeof Reflect&&Reflect.get?babelHelpers.get=_get=Reflect.get:babelHelpers.get=_get=function(e,t,n){if(e=babelHelpers.superPropBase(e,t))return t=Object.getOwnPropertyDescriptor(e,t),t.get?t.get.call(n):t.value},_get(e,t,n||e)}function set(e,t,n,i){return(set="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,n,i){var r,e=babelHelpers.superPropBase(e,t);if(e){if((r=Object.getOwnPropertyDescriptor(e,t)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(i,t)){if(!r.writable)return!1;r.value=n,Object.defineProperty(i,t,r)}else babelHelpers.defineProperty(i,t,n);return!0})(e,t,n,i)}function _set(e,t,n,i,r){if(!set(e,t,n,i||e)&&r)throw new Error("failed to set property");return n}function _taggedTemplateLiteral(e,t){return t=t||e.slice(0),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _taggedTemplateLiteralLoose(e,t){return t=t||e.slice(0),e.raw=t,e}function _temporalUndefined(){}function _temporalRef(e,t){return e===babelHelpers.temporalUndefined?babelHelpers.tdz(t):e}function _slicedToArray(e,t){return babelHelpers.arrayWithHoles(e)||babelHelpers.iterableToArrayLimit(e,t)||babelHelpers.unsupportedIterableToArray(e,t)||babelHelpers.nonIterableRest()}function _slicedToArrayLoose(e,t){return babelHelpers.arrayWithHoles(e)||babelHelpers.iterableToArrayLimitLoose(e,t)||babelHelpers.unsupportedIterableToArray(e,t)||babelHelpers.nonIterableRest()}function _toArray(e){return babelHelpers.arrayWithHoles(e)||babelHelpers.iterableToArray(e)||babelHelpers.unsupportedIterableToArray(e)||babelHelpers.nonIterableRest()}function _toConsumableArray(e){return babelHelpers.arrayWithoutHoles(e)||babelHelpers.iterableToArray(e)||babelHelpers.unsupportedIterableToArray(e)||babelHelpers.nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e))return babelHelpers.arrayLikeToArray(e)}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var REACT_ELEMENT_TYPE,babelHelpers={};babelHelpers.typeof=_typeof,babelHelpers.jsx=_createRawReactElement,babelHelpers.asyncIterator=_asyncIterator,"function"==typeof Symbol&&Symbol.asyncIterator&&(AsyncGenerator.prototype[Symbol.asyncIterator]=function(){return this}),AsyncGenerator.prototype.next=function(e){return this._invoke("next",e)},AsyncGenerator.prototype.throw=function(e){return this._invoke("throw",e)},AsyncGenerator.prototype.return=function(e){return this._invoke("return",e)},babelHelpers.AsyncGenerator=AsyncGenerator,babelHelpers.asyncGeneratorDelegate=_asyncGeneratorDelegate,babelHelpers.asyncToGenerator=_asyncToGenerator,babelHelpers.classCallCheck=_classCallCheck,babelHelpers.createClass=_createClass,babelHelpers.defineEnumerableProperties=_defineEnumerableProperties,babelHelpers.defaults=_defaults,babelHelpers.defineProperty=_defineProperty,babelHelpers.extends=_extends,babelHelpers.inherits=_inherits,babelHelpers.getPrototypeOf=_getPrototypeOf,babelHelpers.setPrototypeOf=_setPrototypeOf,babelHelpers.isNativeReflectConstruct=_isNativeReflectConstruct,babelHelpers.construct=_construct,babelHelpers.isNativeFunction=_isNativeFunction,babelHelpers.wrapNativeSuper=_wrapNativeSuper,babelHelpers.instanceof=_instanceof,babelHelpers.interopRequireDefault=_interopRequireDefault,babelHelpers.interopRequireWildcard=_interopRequireWildcard,babelHelpers.newArrowCheck=_newArrowCheck,babelHelpers.objectDestructuringEmpty=_objectDestructuringEmpty,babelHelpers.objectWithoutPropertiesLoose=_objectWithoutPropertiesLoose,babelHelpers.objectWithoutProperties=_objectWithoutProperties,babelHelpers.assertThisInitialized=_assertThisInitialized,babelHelpers.possibleConstructorReturn=_possibleConstructorReturn,babelHelpers.superPropBase=_superPropBase,babelHelpers.get=_get,babelHelpers.set=_set,babelHelpers.taggedTemplateLiteral=_taggedTemplateLiteral,babelHelpers.taggedTemplateLiteralLoose=_taggedTemplateLiteralLoose,babelHelpers.temporalUndefined=_temporalUndefined,babelHelpers.temporalRef=_temporalRef,babelHelpers.slicedToArray=_slicedToArray,babelHelpers.slicedToArrayLoose=_slicedToArrayLoose,babelHelpers.toArray=_toArray,babelHelpers.toConsumableArray=_toConsumableArray,babelHelpers.arrayWithoutHoles=_arrayWithoutHoles,babelHelpers.arrayWithHoles=_arrayWithHoles,babelHelpers.iterableToArray=_iterableToArray,babelHelpers.arrayLikeToArray=_arrayLikeToArray;try{var ce=new window.CustomEvent("test");if(ce.preventDefault(),!0!==ce.defaultPrevented)throw Error("Could not prevent default")}catch(e){var CustomEvent=function(e,t){var n,i;return t=t||{bubbles:!1,cancelable:!1,detail:void 0},n=document.createEvent("CustomEvent"),n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i=n.preventDefault,n.preventDefault=function(){i.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch(e){this.defaultPrevented=!0}},n};CustomEvent.prototype=window.Event.prototype,window.CustomEvent=CustomEvent}!function(e,t){e.ES6Promise||(e.ES6Promise=t(),e.ES6Promise.polyfill())}(this,function(){"use strict";function e(e){return"function"==typeof e||"object"==typeof e&&null!==e}function t(e){return"function"==typeof e}function n(e){K=e}function i(e){W=e}function r(){return function(){return process.nextTick(u)}}function a(){return"undefined"!=typeof j?function(){j(u)}:l()}function s(){var e=0,t=new Z(u),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function o(){var e=new MessageChannel;return e.port1.onmessage=u,function(){return e.port2.postMessage(0)}}function l(){var e=setTimeout;return function(){return e(u,1)}}function u(){for(var e=0;e<F;e+=2){var t=J[e],n=J[e+1];t(n),J[e]=void 0,J[e+1]=void 0}F=0}function c(){try{var e=require,t=e("vertx");return j=t.runOnLoop||t.runOnContext,a()}catch(e){return l()}}function h(e,t){var n=arguments,i=this,r=new this.constructor(f);void 0===r[te]&&I(r);var a=i._state;return a?!function(){var e=n[a-1];W(function(){return H(a,r,e,i._result)})}():N(i,r,e,t),r}function d(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(f);return k(n,e),n}function f(){}function p(){return new TypeError("You cannot resolve a promise with itself")}function y(){return new TypeError("A promises callback cannot return that same promise.")}function A(e){try{return e.then}catch(e){return ae.error=e,ae}}function v(e,t,n,i){try{e.call(t,n,i)}catch(e){return e}}function g(e,t,n){W(function(e){var i=!1,r=v(n,t,function(n){i||(i=!0,t!==n?k(e,n):T(e,n))},function(t){i||(i=!0,C(e,t))},"Settle: "+(e._label||" unknown promise"));!i&&r&&(i=!0,C(e,r))},e)}function m(e,t){t._state===ie?T(e,t._result):t._state===re?C(e,t._result):N(t,void 0,function(t){return k(e,t)},function(t){return C(e,t)})}function b(e,n,i){n.constructor===e.constructor&&i===h&&n.constructor.resolve===d?m(e,n):i===ae?C(e,ae.error):void 0===i?T(e,n):t(i)?g(e,n,i):T(e,n)}function k(t,n){t===n?C(t,p()):e(n)?b(t,n,A(n)):T(t,n)}function E(e){e._onerror&&e._onerror(e._result),_(e)}function T(e,t){e._state===ne&&(e._result=t,e._state=ie,0!==e._subscribers.length&&W(_,e))}function C(e,t){e._state===ne&&(e._state=re,e._result=t,W(E,e))}function N(e,t,n,i){var r=e._subscribers,a=r.length;e._onerror=null,r[a]=t,r[a+ie]=n,r[a+re]=i,0===a&&e._state&&W(_,e)}function _(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var i=void 0,r=void 0,a=e._result,s=0;s<t.length;s+=3)i=t[s],r=t[s+n],i?H(n,i,r,a):r(a);e._subscribers.length=0}}function P(){this.error=null}function S(e,t){try{return e(t)}catch(e){return se.error=e,se}}function H(e,n,i,r){var a=t(i),s=void 0,o=void 0,l=void 0,u=void 0;if(a){if(s=S(i,r),s===se?(u=!0,o=s.error,s=null):l=!0,n===s)return void C(n,y())}else s=r,l=!0;n._state!==ne||(a&&l?k(n,s):u?C(n,o):e===ie?T(n,s):e===re&&C(n,s))}function M(e,t){try{t(function(t){k(e,t)},function(t){C(e,t)})}catch(t){C(e,t)}}function L(){return oe++}function I(e){e[te]=oe++,e._state=void 0,e._result=void 0,e._subscribers=[]}function R(e,t){this._instanceConstructor=e,this.promise=new e(f),this.promise[te]||I(this.promise),B(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?T(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&T(this.promise,this._result))):C(this.promise,O())}function O(){return new Error("Array Methods must be provided an Array")}function D(e){return new R(this,e).promise}function w(e){var t=this;return new t(B(e)?function(n,i){for(var r=e.length,a=0;a<r;a++)t.resolve(e[a]).then(n,i)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function x(e){var t=this,n=new t(f);return C(n,e),n}function G(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function U(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function V(e){this[te]=L(),this._result=this._state=void 0,this._subscribers=[],f!==e&&("function"!=typeof e&&G(),this instanceof V?M(this,e):U())}function Y(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=V}var z=void 0;z=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var B=z,F=0,j=void 0,K=void 0,W=function(e,t){J[F]=e,J[F+1]=t,F+=2,2===F&&(K?K(u):ee())},q="undefined"!=typeof window?window:void 0,Q=q||{},Z=Q.MutationObserver||Q.WebKitMutationObserver,X="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),$="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,J=new Array(1e3),ee=void 0;ee=X?r():Z?s():$?o():void 0===q&&"function"==typeof require?c():l();var te=Math.random().toString(36).substring(16),ne=void 0,ie=1,re=2,ae=new P,se=new P,oe=0;return R.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===ne&&n<e;n++)this._eachEntry(t[n],n)},R.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,i=n.resolve;if(i===d){var r=A(e);if(r===h&&e._state!==ne)this._settledAt(e._state,t,e._result);else if("function"!=typeof r)this._remaining--,this._result[t]=e;else if(n===V){var a=new n(f);b(a,e,r),this._willSettleAt(a,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(i(e),t)},R.prototype._settledAt=function(e,t,n){var i=this.promise;i._state===ne&&(this._remaining--,e===re?C(i,n):this._result[t]=n),0===this._remaining&&T(i,this._result)},R.prototype._willSettleAt=function(e,t){var n=this;N(e,void 0,function(e){return n._settledAt(ie,t,e)},function(e){return n._settledAt(re,t,e)})},V.all=D,V.race=w,V.resolve=d,V.reject=x,V._setScheduler=n,V._setAsap=i,V._asap=W,V.prototype={constructor:V,then:h,catch:function(e){return this.then(null,e)}},V.polyfill=Y,V.Promise=V,V}),"function"!=typeof Object.values&&(Object.values=function(e){return Object.keys(e).map(function(t){return e[t]})}),"function"!=typeof Object.entries&&(Object.entries=function(e){return Object.keys(e).map(function(t){return[t,e[t]]})}),"function"!=typeof Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=0;r<i;){var a=n[r];if(e.call(t,a,r,n))return a;r++}},configurable:!0,writable:!0}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=0;r<i;){if(e.call(t,n[r],r,n))return r;r++}return-1}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0===i)return!1;var r=0|t;for(r=Math.max(0<=r?r:i-Math.abs(r),0);r<i;){var a=n[r],s=e;if(a===s||"number"==typeof a&&"number"==typeof s&&isNaN(a)&&isNaN(s))return!0;r++}return!1}}),Array.from||(Array.from=function(){var e=Object.prototype.toString,t=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},n=Math.pow(2,53)-1;return function(e){var i=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var r,a=1<arguments.length?arguments[1]:void 0;if("undefined"!=typeof a){if(!t(a))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(r=arguments[2])}var s=Number(i.length);s=isNaN(s)?0:0!==s&&isFinite(s)?(0<s?1:-1)*Math.floor(Math.abs(s)):s,s=Math.min(Math.max(s,0),n);for(var o,l=t(this)?Object(new this(s)):Array(s),u=0;u<s;)o=i[u],l[u]=a?"undefined"==typeof r?a(o,u):a.call(r,o,u):o,u+=1;return l.length=s,l}}()),String.prototype.padStart||Object.defineProperty(String.prototype,"padStart",{value:function(e,t){return e>>=0,t=String("undefined"!=typeof t?t:" "),this.length>e?String(this):(e-=this.length,e>t.length&&(t+=t.repeat(e/t.length)),t.slice(0,e)+String(this))}}),String.prototype.includes||Object.defineProperty(String.prototype,"includes",{value:function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}}),function(e){function t(e,t){this.setNotifyMethod(e),this.setNotifyContext(t)}function n(e,t,n){this.name=e,this.body=t,this.type=n}function i(){}function r(){}function a(){this.subCommands=[],this.initializeMacroCommand()}function s(e,t){this.mediatorName=e||this.constructor.NAME,this.viewComponent=t}function o(e,t){this.proxyName=e||this.constructor.NAME,null!=t&&this.setData(t)}function l(e){if(null!=l.instanceMap[e])throw Error(l.MULTITON_MSG);this.initializeNotifier(e),l.instanceMap[e]=this,this.initializeFacade()}function u(e){if(null!=u.instanceMap[e])throw Error(u.MULTITON_MSG);this.multitonKey=e,u.instanceMap[this.multitonKey]=this,this.mediatorMap=[],this.observerMap=[],this.initializeView()}function c(e){if(c.instanceMap[e])throw Error(c.MULTITON_MSG);this.multitonKey=e,c.instanceMap[e]=this,this.proxyMap=[],this.initializeModel()}function h(e){if(null!=h.instanceMap[e])throw Error(h.MULTITON_MSG);this.multitonKey=e,h.instanceMap[this.multitonKey]=this,this.commandMap=[],this.initializeController()}function d(e,t,n){for(var i,r,e=e.split("."),n=n||f.global,a=0,s=e.length;a<s;a++)i=n,r=e[a],n=null==n[r]?n[r]={}:n[r];return null==t?n:i[r]=t}if(null==e&&(e=window),!e.puremvc){t.prototype.setNotifyMethod=function(e){this.notify=e},t.prototype.setNotifyContext=function(e){this.context=e},t.prototype.getNotifyMethod=function(){return this.notify},t.prototype.getNotifyContext=function(){return this.context},t.prototype.notifyObserver=function(e){this.getNotifyMethod().call(this.getNotifyContext(),e)},t.prototype.compareNotifyContext=function(e){return e===this.context},t.prototype.notify=null,t.prototype.context=null,n.prototype.getName=function(){return this.name},n.prototype.setBody=function(e){this.body=e},n.prototype.getBody=function(){return this.body},n.prototype.setType=function(e){this.type=e},n.prototype.getType=function(){return this.type},n.prototype.toString=function(){var e="Notification Name: "+this.getName(),e=e+("\nBody:"+(null==this.body?"null":this.body.toString()));return e+="\nType:"+(null==this.type?"null":this.type)},n.prototype.name=null,n.prototype.type=null,n.prototype.body=null,i.prototype.sendNotification=function(e,t,n){var i=this.getFacade();i&&i.sendNotification(e,t,n)},i.prototype.initializeNotifier=function(e){this.multitonKey=""+e,this.facade=this.getFacade()},i.prototype.getFacade=function(){if(null==this.multitonKey)throw Error(i.MULTITON_MSG);return l.getInstance(this.multitonKey)},i.prototype.multitonKey=null,i.MULTITON_MSG="multitonKey for this Notifier not yet initialized!",r.prototype=new i,r.prototype.constructor=r,r.prototype.execute=function(){},a.prototype=new i,a.prototype.constructor=a,a.prototype.subCommands=null,a.prototype.initializeMacroCommand=function(){},a.prototype.addSubCommand=function(e){this.subCommands.push(e)},a.prototype.execute=function(e){for(;0<this.subCommands.length;){var t=new(this.subCommands.shift());t.initializeNotifier(this.multitonKey),t.execute(e)}},s.NAME="Mediator",s.prototype=new i,s.prototype.constructor=s,s.prototype.getMediatorName=function(){return this.mediatorName},s.prototype.setViewComponent=function(e){this.viewComponent=e},s.prototype.getViewComponent=function(){return this.viewComponent},s.prototype.listNotificationInterests=function(){return[]},s.prototype.handleNotification=function(){},s.prototype.onRegister=function(){},s.prototype.onRemove=function(){},s.prototype.mediatorName=null,s.prototype.viewComponent=null,o.NAME="Proxy",o.prototype=new i,o.prototype.constructor=o,o.prototype.getProxyName=function(){return this.proxyName},o.prototype.setData=function(e){this.data=e},o.prototype.getData=function(){return this.data},o.prototype.onRegister=function(){},o.prototype.onRemove=function(){},o.prototype.proxyName=null,o.prototype.data=null,l.prototype.initializeFacade=function(){this.initializeModel(),this.initializeController(),this.initializeView()},l.getInstance=function(e){return null==e?null:(null==l.instanceMap[e]&&(l.instanceMap[e]=new l(e)),l.instanceMap[e])},l.prototype.initializeController=function(){null==this.controller&&(this.controller=h.getInstance(this.multitonKey))},l.prototype.initializeModel=function(){null==this.model&&(this.model=c.getInstance(this.multitonKey))},l.prototype.initializeView=function(){null==this.view&&(this.view=u.getInstance(this.multitonKey))},l.prototype.registerCommand=function(e,t){this.controller.registerCommand(e,t)},l.prototype.removeCommand=function(e){this.controller.removeCommand(e)},l.prototype.hasCommand=function(e){return this.controller.hasCommand(e)},l.prototype.registerProxy=function(e){this.model.registerProxy(e)},l.prototype.retrieveProxy=function(e){return this.model.retrieveProxy(e)},l.prototype.removeProxy=function(e){var t=null;return null!=this.model&&(t=this.model.removeProxy(e)),t},l.prototype.hasProxy=function(e){return this.model.hasProxy(e)},l.prototype.registerMediator=function(e){null!=this.view&&this.view.registerMediator(e)},l.prototype.retrieveMediator=function(e){return this.view.retrieveMediator(e)},l.prototype.removeMediator=function(e){var t=null;return null!=this.view&&(t=this.view.removeMediator(e)),t},l.prototype.hasMediator=function(e){return this.view.hasMediator(e)},l.prototype.sendNotification=function(e,t,i){this.notifyObservers(new n(e,t,i))},l.prototype.notifyObservers=function(e){null!=this.view&&this.view.notifyObservers(e)},l.prototype.initializeNotifier=function(e){this.multitonKey=e},l.hasCore=function(e){return null!=l.instanceMap[e]},l.removeCore=function(e){null!=l.instanceMap[e]&&(c.removeModel(e),u.removeView(e),h.removeController(e),delete l.instanceMap[e])},l.prototype.controller=null,l.prototype.model=null,l.prototype.view=null,l.prototype.multitonKey=null,l.instanceMap=[],l.MULTITON_MSG="Facade instance for this Multiton key already constructed!",u.prototype.initializeView=function(){},u.getInstance=function(e){return null==e?null:(null==u.instanceMap[e]&&(u.instanceMap[e]=new u(e)),u.instanceMap[e])},u.prototype.registerObserver=function(e,t){null!=this.observerMap[e]?this.observerMap[e].push(t):this.observerMap[e]=[t]},u.prototype.notifyObservers=function(e){if(null!=this.observerMap[e.getName()]){for(var t,n=this.observerMap[e.getName()],i=[],r=0;r<n.length;r++)t=n[r],i.push(t);for(r=0;r<i.length;r++)t=i[r],t.notifyObserver(e)}},u.prototype.removeObserver=function(e,t){for(var n=this.observerMap[e],i=0;i<n.length;i++)if(1==n[i].compareNotifyContext(t)){n.splice(i,1);break}0==n.length&&delete this.observerMap[e]},u.prototype.registerMediator=function(e){if(null==this.mediatorMap[e.getMediatorName()]){e.initializeNotifier(this.multitonKey),this.mediatorMap[e.getMediatorName()]=e;var n=e.listNotificationInterests();if(0<n.length)for(var i=new t(e.handleNotification,e),r=0;r<n.length;r++)this.registerObserver(n[r],i);e.onRegister()}},u.prototype.retrieveMediator=function(e){return this.mediatorMap[e]},u.prototype.removeMediator=function(e){var t=this.mediatorMap[e];if(t){for(var n=t.listNotificationInterests(),i=0;i<n.length;i++)this.removeObserver(n[i],t);delete this.mediatorMap[e],t.onRemove()}return t},u.prototype.hasMediator=function(e){return null!=this.mediatorMap[e]},u.removeView=function(e){delete u.instanceMap[e]},u.prototype.mediatorMap=null,u.prototype.observerMap=null,u.instanceMap=[],u.prototype.multitonKey=null,u.MULTITON_MSG="View instance for this Multiton key already constructed!",c.prototype.initializeModel=function(){},c.getInstance=function(e){return null==e?null:(null==c.instanceMap[e]&&(c.instanceMap[e]=new c(e)),c.instanceMap[e])},c.prototype.registerProxy=function(e){e.initializeNotifier(this.multitonKey),this.proxyMap[e.getProxyName()]=e,e.onRegister()},c.prototype.retrieveProxy=function(e){return this.proxyMap[e]},c.prototype.hasProxy=function(e){return null!=this.proxyMap[e]},c.prototype.removeProxy=function(e){var t=this.proxyMap[e];return t&&(this.proxyMap[e]=null,t.onRemove()),t},c.removeModel=function(e){delete c.instanceMap[e]},c.prototype.proxyMap=null,c.instanceMap=[],c.MULTITON_MSG="Model instance for this Multiton key already constructed!",h.prototype.initializeController=function(){this.view=u.getInstance(this.multitonKey)},h.getInstance=function(e){return null==e?null:(null==this.instanceMap[e]&&(this.instanceMap[e]=new this(e)),this.instanceMap[e])},h.prototype.executeCommand=function(e){var t=this.commandMap[e.getName()];null!=t&&(t=new t,t.initializeNotifier(this.multitonKey),t.execute(e))},h.prototype.registerCommand=function(e,n){null==this.commandMap[e]&&this.view.registerObserver(e,new t(this.executeCommand,this)),this.commandMap[e]=n},h.prototype.hasCommand=function(e){return null!=this.commandMap[e]},h.prototype.removeCommand=function(e){this.hasCommand(e)&&(this.view.removeObserver(e,this),this.commandMap[e]=null)},h.removeController=function(e){delete this.instanceMap[e]},h.prototype.view=null,h.prototype.commandMap=null,h.prototype.multitonKey=null,h.instanceMap=[],h.MULTITON_MSG="controller key for this Multiton key already constructed";var f={global:function(){return this}(),extend:function(e,t){if("function"!=typeof e)throw new TypeError("#extend- child should be Function");if("function"!=typeof t)throw new TypeError("#extend- parent should be Function");if(t!==e){var n=new Function;return n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},decorate:function(e,t){for(var n in t)e[n]=t[n];return e}};e.puremvc={View:u,Model:c,Controller:h,SimpleCommand:r,MacroCommand:a,Facade:l,Mediator:s,Observer:t,Notification:n,Notifier:i,Proxy:o,define:function(e,t,n){e||(e={});var i=e.name,r=e.parent,a="function"==typeof r,s=e.scope||null;if("parent"in e&&!a)throw new TypeError("Class parent must be Function");if(e.hasOwnProperty("constructor")){if(e=e.constructor,"function"!=typeof e)throw new TypeError("Class constructor must be Function")}else e=a?function(){r.apply(this,arguments)}:new Function;if(a&&f.extend(e,r),t&&(a=e.prototype,f.decorate(a,t),a.constructor=e),n&&f.decorate(e,n),i){if("string"!=typeof i)throw new TypeError("Class name must be primitive string");
d(i,e,s)}return e},declare:d}}}(this),!function(e,t,n){"undefined"!=typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define(t,n):e[t]=n()}(this,"bowser",function(){function e(e){function t(t){var n=e.match(t);return n&&n.length>1&&n[1]||""}function n(t){var n=e.match(t);return n&&n.length>1&&n[2]||""}function i(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}var r,a=t(/(ipod|iphone|ipad)/i).toLowerCase(),o=/like android/i.test(e),l=!o&&/android/i.test(e),u=/nexus\s*[0-6]\s*/i.test(e),c=!u&&/nexus\s*[0-9]+/i.test(e),h=/CrOS/.test(e),d=/silk/i.test(e),f=/sailfish/i.test(e),p=/tizen/i.test(e),y=/(web|hpw)os/i.test(e),A=/windows phone/i.test(e),v=(/SamsungBrowser/i.test(e),!A&&/windows/i.test(e)),g=!a&&!d&&/macintosh/i.test(e),m=!l&&!f&&!p&&!y&&/linux/i.test(e),b=n(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),k=t(/version\/(\d+(\.\d+)?)/i),E=/tablet/i.test(e)&&!/tablet pc/i.test(e),T=!E&&/[^-]mobi/i.test(e),C=/xbox/i.test(e);/opera/i.test(e)?r={name:"Opera",opera:s,version:k||t(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(e)?r={name:"Opera",opera:s,version:t(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||k}:/SamsungBrowser/i.test(e)?r={name:"Samsung Internet for Android",samsungBrowser:s,version:k||t(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/coast/i.test(e)?r={name:"Opera Coast",coast:s,version:k||t(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(e)?r={name:"Yandex Browser",yandexbrowser:s,version:k||t(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(e)?r={name:"UC Browser",ucbrowser:s,version:t(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(e)?r={name:"Maxthon",maxthon:s,version:t(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(e)?r={name:"Epiphany",epiphany:s,version:t(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(e)?r={name:"Puffin",puffin:s,version:t(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(e)?r={name:"Sleipnir",sleipnir:s,version:t(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(e)?r={name:"K-Meleon",kMeleon:s,version:t(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:A?(r={name:"Windows Phone",osname:"Windows Phone",windowsphone:s},b?(r.msedge=s,r.version=b):(r.msie=s,r.version=t(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(e)?r={name:"Internet Explorer",msie:s,version:t(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:h?r={name:"Chrome",osname:"Chrome OS",chromeos:s,chromeBook:s,chrome:s,version:t(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(e)?r={name:"Microsoft Edge",msedge:s,version:b}:/vivaldi/i.test(e)?r={name:"Vivaldi",vivaldi:s,version:t(/vivaldi\/(\d+(\.\d+)?)/i)||k}:f?r={name:"Sailfish",osname:"Sailfish OS",sailfish:s,version:t(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(e)?r={name:"SeaMonkey",seamonkey:s,version:t(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(e)?(r={name:"Firefox",firefox:s,version:t(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(e)&&(r.firefoxos=s,r.osname="Firefox OS")):d?r={name:"Amazon Silk",silk:s,version:t(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(e)?r={name:"PhantomJS",phantom:s,version:t(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(e)?r={name:"SlimerJS",slimer:s,version:t(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(e)||/rim\stablet/i.test(e)?r={name:"BlackBerry",osname:"BlackBerry OS",blackberry:s,version:k||t(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:y?(r={name:"WebOS",osname:"WebOS",webos:s,version:k||t(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(e)&&(r.touchpad=s)):/bada/i.test(e)?r={name:"Bada",osname:"Bada",bada:s,version:t(/dolfin\/(\d+(\.\d+)?)/i)}:p?r={name:"Tizen",osname:"Tizen",tizen:s,version:t(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||k}:/qupzilla/i.test(e)?r={name:"QupZilla",qupzilla:s,version:t(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||k}:/chromium/i.test(e)?r={name:"Chromium",chromium:s,version:t(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||k}:/chrome|crios|crmo/i.test(e)?r={name:"Chrome",chrome:s,version:t(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:l?r={name:"Android",version:k}:/safari|applewebkit/i.test(e)?(r={name:"Safari",safari:s},k&&(r.version=k)):a?(r={name:"iphone"==a?"iPhone":"ipad"==a?"iPad":"iPod"},k&&(r.version=k)):r=/googlebot/i.test(e)?{name:"Googlebot",googlebot:s,version:t(/googlebot\/(\d+(\.\d+))/i)||k}:{name:t(/^(.*)\/(.*) /),version:n(/^(.*)\/(.*) /)},!r.msedge&&/(apple)?webkit/i.test(e)?(/(apple)?webkit\/537\.36/i.test(e)?(r.name=r.name||"Blink",r.blink=s):(r.name=r.name||"Webkit",r.webkit=s),!r.version&&k&&(r.version=k)):!r.opera&&/gecko\//i.test(e)&&(r.name=r.name||"Gecko",r.gecko=s,r.version=r.version||t(/gecko\/(\d+(\.\d+)?)/i)),r.windowsphone||!l&&!r.silk?!r.windowsphone&&a?(r[a]=s,r.ios=s,r.osname="iOS"):g?(r.mac=s,r.osname="macOS"):C?(r.xbox=s,r.osname="Xbox"):v?(r.windows=s,r.osname="Windows"):m&&(r.linux=s,r.osname="Linux"):(r.android=s,r.osname="Android");var N="";r.windows?N=i(t(/Windows ((NT|XP)( \d\d?.\d)?)/i)):r.windowsphone?N=t(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):r.mac?(N=t(/Mac OS X (\d+([_\.\s]\d+)*)/i),N=N.replace(/[_\s]/g,".")):a?(N=t(/os (\d+([_\s]\d+)*) like mac os x/i),N=N.replace(/[_\s]/g,".")):l?N=t(/android[ \/-](\d+(\.\d+)*)/i):r.webos?N=t(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):r.blackberry?N=t(/rim\stablet\sos\s(\d+(\.\d+)*)/i):r.bada?N=t(/bada\/(\d+(\.\d+)*)/i):r.tizen&&(N=t(/tizen[\/\s](\d+(\.\d+)*)/i)),N&&(r.osversion=N);var _=!r.windows&&N.split(".")[0];return E||c||"ipad"==a||l&&(3==_||_>=4&&!T)||r.silk?r.tablet=s:(T||"iphone"==a||"ipod"==a||l||u||r.blackberry||r.webos||r.bada)&&(r.mobile=s),r.msedge||r.msie&&r.version>=10||r.yandexbrowser&&r.version>=15||r.vivaldi&&r.version>=1||r.chrome&&r.version>=20||r.samsungBrowser&&r.version>=4||r.firefox&&r.version>=20||r.safari&&r.version>=6||r.opera&&r.version>=10||r.ios&&r.osversion&&r.osversion.split(".")[0]>=6||r.blackberry&&r.version>=10.1||r.chromium&&r.version>=20?r.a=s:r.msie&&r.version<10||r.chrome&&r.version<20||r.firefox&&r.version<20||r.safari&&r.version<6||r.opera&&r.version<10||r.ios&&r.osversion&&r.osversion.split(".")[0]<6||r.chromium&&r.version<20?r.c=s:r.x=s,r}function t(e){return e.split(".").length}function n(e,t){var n,i=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n++)i.push(t(e[n]));return i}function i(e){for(var i=Math.max(t(e[0]),t(e[1])),r=n(e,function(e){var r=i-t(e);return e+=new Array(r+1).join(".0"),n(e.split("."),function(e){return new Array(20-e.length).join("0")+e}).reverse()});--i>=0;){if(r[0][i]>r[1][i])return 1;if(r[0][i]!==r[1][i])return-1;if(0===i)return 0}}function r(t,n,r){var a=o;"string"==typeof n&&(r=n,n=void 0),void 0===n&&(n=!1),r&&(a=e(r));var s=""+a.version;for(var l in t)if(t.hasOwnProperty(l)&&a[l]){if("string"!=typeof t[l])throw new Error("Browser version in the minVersion map should be a string: "+l+": "+String(t));return i([s,t[l]])<0}return n}function a(e,t,n){return!r(e,t,n)}var s=!0,o=e("undefined"!=typeof navigator?navigator.userAgent||"":"");return o.test=function(e){for(var t=0;t<e.length;++t){var n=e[t];if("string"==typeof n&&n in o)return!0}return!1},o.isUnsupportedBrowser=r,o.compareVersions=i,o.check=a,o._detect=e,o.detect=e,o});var akamai=function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function t(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach(function(e){babelHelpers.defineProperty(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function n(){hn.observe(document.body,{childList:!0,subtree:!0})}function i(e){if(e&&0!=e.length){var t=Promise.resolve();_.each(e,function(e){e.classList&&e.classList.contains("amp-inline")&&Object.keys(e.dataset)&&"true"!=e.dataset.embedded&&(t=t.then(Tt.embed.bind(null,e)))})}}function r(){i(document.querySelectorAll(".amp-inline"))}var a=function(e){function t(n){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return babelHelpers.classCallCheck(this,t),i=e.call(this)||this,i.code=r,i.metadata=a,n instanceof t?babelHelpers.possibleConstructorReturn(i,n):("object"===babelHelpers.typeof(n)?(i.metadata=n.metadata||n,i.message=n.message||("function"==typeof n.toString?n.toString():void 0),n.code&&(i.code=n.code)):i.message=n,i)}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,null,[{key:"create",value:function(e,n,i){return new t(e,n,i)}}]),t}(babelHelpers.wrapNativeSuper(Error)),s=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};babelHelpers.classCallCheck(this,e),this.type=t,this.detail=this.data=n,this.target=null}return babelHelpers.createClass(e,null,[{key:"create",value:function(t,n){return new e(t,n)}}]),e}(),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;babelHelpers.classCallCheck(this,e),this._target=t,this._listenerMap={},this._regex=[],this.emit=this.dispatch.bind(this),this.on=this.addListener=this.addEventListener.bind(this),this.off=this.removeListener=this.removeEventListener.bind(this)}return babelHelpers.createClass(e,[{key:"addEventListener",value:function(e,t){if(null!=t&&null!=e)if(e instanceof RegExp)t.__regex=e,this._regex.push(t);else{if(null==this._listenerMap[e]&&(this._listenerMap[e]=[]),this._listenerMap[e].indexOf(t)!==-1)return;this._listenerMap[e].push(t)}}},{key:"once",value:function(e,t){t.__once=!0,this.addEventListener(e,t)}},{key:"dispatchEvent",value:function(e){if(null!=this._target||null!=this._listenerMap){null==e.target&&"object"===babelHelpers.typeof(e)&&(e.target=this._target);var t=e.type,n=this._target,i=n["on"+t];null!=i&&i.apply(n,[e]);var r=this._listenerMap[t];if(r&&r.length>0)for(var a=r.slice(),s=0,o=a.length;s<o;++s)i=a[s],i.call(n,e),i.__once===!0&&r.splice(s,1);if(r=this._regex,r.length>0)for(var l=r.slice(),u=0,c=l.length;u<c;++u)i=l[u],0!=i.__regex.test(t)&&(i.call(n,e),i.__once===!0&&r.splice(u,1))}}},{key:"dispatch",value:function(e,t){this.dispatchEvent(s.create(e,t))}},{key:"removeEventListener",value:function(e,t){if(null!=t&&null!=e){var n=e instanceof RegExp,i=n?this._regex:this._listenerMap[e];if(null!=i){var r=i.indexOf(t);if(r!==-1&&(!n||e.toString()===i[r].__regex.toString()))return i.splice(r,1)}}}},{key:"destroy",value:function(){this._listenerMap=null,this._target=null}}],[{key:"create",value:function(t){return new e(t)}}]),e}(),l=function(e){function t(n){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:setTimeout,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:clearTimeout;return babelHelpers.classCallCheck(this,t),i=e.call(this)||this,i.delay=n,i.repeatCount=r,i.timerGroup=timerGroup,i._running=!1,i._currentCount=0,i._timeout=null,i._startTime=null,i._currentTime=0,i.setTimeout=a,i.clearTimeout=s,i.next=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.delay;return i.setTimeout(function(){return i.tick()},e)},i.clear=function(){return i.clearTimeout(i._timeout)},i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"currentCount",get:function(){return this._currentCount}},{key:"running",get:function(){return this._running}},{key:"time",get:function(){return this._currentTime+(Date.now()-this._startTime)}},{key:"reset",value:function(){this.stop(),this._currentCount=0,this._currentTime=0,this._startTime=null}},{key:"start",value:function(){if(this._running!==!0){var e=this.delay-(this._currentTime-this.delay*this._currentCount);this._running=!0,this._timeout=this.next(e)}}},{key:"stop",value:function(){this._running!==!1&&(this.clear(),this._currentTime+=Date.now()-this._startTime,this._timeout=null,this._running=!1)}},{key:"tick",value:function(){this.clear();var e=0!==this.repeatCount&&this._currentCount>=this.repeatCount;this._currentCount++,this._currentTime+=this.delay,this._startTime=Date.now(),e===!1&&(this._timeout=this.next(this.delay)),this.dispatch(t.TIMER,this),e===!0&&(this.stop(),this.dispatch(t.COMPLETE,this))}},{key:"destroy",value:function(){this.clear(),babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"destroy",this).call(this),this.next=null}}],[{key:"TIMER",get:function(){return"timer"}},{key:"COMPLETE",get:function(){return"complete"}},{key:"create",value:function(e,n,i,r){return new t(e,n,i,r)}}]),t}(o),u=function(){function e(t){babelHelpers.classCallCheck(this,e),this.id=t,this.intervals=[],this.timeouts=[],this.timers=[],this.groups=[]}return babelHelpers.createClass(e,[{key:"setTimeout",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){for(var n=this,i=arguments.length,r=new Array(i>2?i-2:0),a=2;a<i;a++)r[a-2]=arguments[a];var s=setTimeout(function(){e.apply(null,r),n.clearTimeout(s)},t);return this.timeouts.push(s),s})},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=this.timeouts.indexOf(e);return t!==-1&&this.timeouts.splice(t,1),clearTimeout(e)})},{key:"setInterval",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=setInterval.apply(null,t);return this.intervals.push(i),i})},{key:"clearInterval",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=this.intervals.indexOf(e);return t!==-1&&this.intervals.splice(t,1),clearInterval(e)})},{key:"setImmediate",value:function(e){for(var t=this,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];var a=setTimeout(function(){e.apply(null,i),t.clearImmediate(a)},0);return this.timeouts.push(a),a}},{key:"clearImmediate",value:function(e){var t=this.timeouts.indexOf(e);return t!==-1&&this.timeouts.splice(t,1),clearTimeout(e)}},{key:"setTimer",value:function(e,t){var n=l.create(e,t,this.setTimeout.bind(this),this.clearTimeout.bind(this));return this.timers.push(n),n}},{key:"clearTimer",value:function(e){var t=this.timers.indexOf(e);t!==-1&&(e=this.timers.splice(t,1),e.destroy())}},{key:"setGroup",value:function(t){var n=e.create(t);return this.groups.push(n),n}},{key:"clearGroup",value:function(e){var t=this.groups.indexOf(timer);if(t!==-1){var n=this.groups.splice(t,1);n.destroy()}}},{key:"destroy",value:function(){this.intervals.forEach(function(e){return clearInterval(e)}),this.timeouts.forEach(function(e){return clearTimeout(e)}),this.timers.forEach(function(e){return e.destroy()}),this.groups.forEach(function(e){return e.destroy()}),this.id=null,this.intervals=null,this.timeouts=null,this.timers=null,this.groups=null}}],[{key:"create",value:function(t){return new e(t)}}]),e}(),c=function(e,t){return function(){return e(t.apply(void 0,arguments))}},h=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(c)},d="__DONE__",f=function(e,t){if(null!=e&&"function"==typeof t)if(void 0!=e.length){for(var n=0,i=e.length;n<i;n++)if(t(e[n],n,e)===d)return}else for(var r in e)if(t(e[r],r,e)===d)return},p=function(){return function(e,t){return e.push(t),e}},y=function(){return function(e,t){return t}},A=function(e){return function(t){return function(n,i,r){return t(n,e(i,r),r)}}},v=function(e){return function(t){return function(n,i,r){return e(i,r)?t(n,i,r):n}}},g=function(e){return function(t){return function(n,i,r){return e(i,r),t(n,i,r)}}},m=function(e){return function(t){return function(n,i,r){return e(i,r)?t(n,i,r):(r(),n)}}},b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return function(n){return function(i,r,a){return--t>0?n(i,r,a):(t=e,a(),n(i,r,a))}}},k=function(e,t,n,i){var r=e(t),a=function(){return s=!0},s=!1;return f(i,function(e){return s?d:void(n=r(n,e,a))}),n},E=function(e,t,n){return k(t,p(),e,n)},T=function(e,t){return E([],e,t)},C=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return T(h.apply(void 0,n),e)},N=function(e){for(var t=null,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];var a=h.apply(void 0,i)(y());return f(e,function(e){if(t=a(null,e))return d}),t},_={pipe:h,map:A,filter:v,tap:g,take:b,until:m,each:f,DONE:d,transform:C,find:N},P=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"construct",value:function(){var t=this,n=this.decode(window.location.search);e.typed={},e.amp={};var i=/^amp(_|-)/;return _.each(n,function(n,r){e[r]=n;var a=t.parse(n);e.typed[r]=a,i.test(r)&&(e.amp[U.toCamelCase(r.replace(i,""))]=a)}),!0}},{key:"encode",value:function(e,t){var n=this,i=[];return _.each(e,function(e,r){if(null!=e){var a=t?t+"["+r+"]":r;i.push("object"===babelHelpers.typeof(e)?n.encode(e,a):a+"="+encodeURIComponent(e))}}),i.join("&")}},{key:"decode",value:function(e){var t,n=this;return null!=e&&(t={},e=e.replace(/^[^?]*\?/,""),e.replace(new RegExp("([^?=&]+)(=([^&]+))","g"),function(e,i,r,a){var s=decodeURIComponent(i),o=decodeURIComponent(a);if(/~/.test(o)&&(o=n.decodeObject(o)),/\[/.test(s)){var l=s.match(/[^\[]+/)[0];return s=s.match(/\[([A-Za-z]+)\]/)[1],null==t[l]&&(t[l]={}),void(t[l][s]=o)}t[s]=o})),t}},{key:"decodeObject",value:function(e){var t,n=this;return null!=e&&(t={},e.replace(/([^:~]+)(:([^~]*))?/g,function(e,i,r,a){t[decodeURIComponent(i)]=n.parse(decodeURIComponent(a))})),t}},{key:"parse",value:function(e){if("object"===babelHelpers.typeof(e))return e;if("undefined"===e)return!0;var t=e.toLowerCase();if("true"===t||"false"===t)return"true"===t;if("null"===t)return null;if(t=parseFloat(e),!isNaN(t))return t;try{return t=JSON.parse(e)}catch(t){return e}}}]),e}(),S=function(){function e(t){if(babelHelpers.classCallCheck(this,e),this._url="string"==typeof t?t:t.url,this._method=t.method||"GET",this._withCredentials=t.withCredentials||!1,this._headers=t.headers||{},this._data=t.data||t.body||{},this._responseType=t.responseType,this._query=t.query,null!=t.query){var n=/\?/.test(this._url)?"&":"?";this._url+=n+P.encode(t.query)}}return babelHelpers.createClass(e,[{key:"url",get:function(){return this._url}},{key:"method",get:function(){return this._method}},{key:"withCredentials",get:function(){return this._withCredentials}},{key:"headers",get:function(){return this._headers}},{key:"query",get:function(){return this._query}},{key:"responseType",get:function(){return this._responseType}},{key:"data",get:function(){return this._data}},{key:"body",get:function(){return this._data}}],[{key:"create",value:function(t){return new e(t)}}]),e}(),H=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"WIDEVINE",get:function(){return"com.widevine.alpha"}},{key:"PLAYREADY",get:function(){return"com.microsoft.playready"}},{key:"FAIRPLAY",get:function(){return"com.apple.fps.1_0"}},{key:"CLEARKEY",get:function(){return"org.w3.clearkey"}},{key:"UNKNOWN",get:function(){return"unknown"}},{key:"key",get:function(){return M},set:function(e){M=e}},{key:"robustnessLevel",get:function(){return L},set:function(e){L=e}},{key:"init",value:function(t){return this.isEMEBrowser()!==!0?Promise.resolve(e.UNKNOWN):("robustnessLevel"in t&&(L=t.robustnessLevel),this.detect())}},{key:"isEMEBrowser",value:function(){return"MediaKeys"in window||"WebKitMediaKeys"in window||"MSMediaKeys"in window}},{key:"detect",value:function(){var t=this,n=this.requestMediaKeyAccess(e.WIDEVINE),i=this.requestMediaKeyAccess(e.PLAYREADY),r=new Promise(function(t){t("WebKitMediaKeys"in window&&WebKitMediaKeys.isTypeSupported(e.FAIRPLAY,"video/mp4")?e.FAIRPLAY:e.UNKNOWN)}),a=this.requestMediaKeyAccess(e.CLEARKEY);return Promise.all([n,i,r,a]).then(function(n){t.key=n.filter(function(t){return t!==e.UNKNOWN})})}},{key:"requestMediaKeyAccess",value:function(t){return new Promise(function(n,i){var r=[{initDataTypes:["cenc"],videoCapabilities:[{contentType:'video/mp4;codecs="avc1.42E01E"',robustness:L},{contentType:'video/webm; codecs="vp9"',robustness:L}]}],a=function(e){return n(e)},s=function(){a(e.UNKNOWN)};try{navigator.requestMediaKeySystemAccess(t,r).then(function(){return a(t)}).catch(s)}catch(t){a(e.UNKNOWN)}})}}]),e}(),M=[H.UNKNOWN],L="",I=navigator,R=I.userAgent,O=I.appName,D=I.platform,w=I.appVersion,G=/((0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?)(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?/,U=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"mimeTypes",get:function(){return{mp4:"video/mp4",m3u8:"application/x-mpegURL",mp3:"audio/mpeg",json:"application/json",txt:"text/plain",xml:"application/xml",ogv:"video/ogg",webm:"video/webm",mpd:"application/dash+xml",ism:"application/vnd.ms-sstr+xml",js:"text/javascript",css:"text/css",vtt:"text/vtt",ttml:"application/ttml+xml",srt:"application/x-subrip",cea608:"text/cea-608",cea708:"text/cea-708"}}},{key:"semver",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.match(G)||[];return{major:parseInt(t[2]),minor:parseInt(t[3]),patch:parseInt(t[4]),pre:t[5],build:t[6],version:t[1],raw:t[0],toString:function(){return this.raw}}}},{key:"blankVideo",value:function(){return"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE="}},{key:"getIEVersion",value:function(){var e,t=-1;return"Microsoft Internet Explorer"===O?e=/MSIE ([0-9]{1,}[\.0-9]{0,})/:"Netscape"===O?e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/:/Edge\/[0-9\.]+$/.test(R)&&(e=/Edge\/([0-9\.]+)/),null!=(null!=e?e.exec(R):void 0)&&(t=parseFloat(RegExp.$1)),t}},{key:"getEdgeVersion",value:function(){var e=-1;return/Edge\/([\d]+)/.exec(R)&&(e=parseFloat(RegExp.$1)),e}},{key:"getFFVersion",value:function(){var e=-1;return/Firefox\/([0-9\.]+)$/.exec(R)&&(e=parseFloat(RegExp.$1)),e}},{key:"getSafariVersion",value:function(){var e=-1;return/Safari\/[0-9\.]+$/.test(R)&&null!=/Version\/([0-9]+\.[0-9]+)/.exec(R)&&(e=parseFloat(RegExp.$1)),e}},{key:"isChrome",value:function(){return/Chrom(e|ium)/.test(R)}},{key:"getChromeVersion",value:function(){var e=-1;return/Chrome( Mobile)?\/([0-9\.]+)/.test(R)&&(e=parseFloat(R.match(/Chrome( Mobile)?\/([0-9\.]+)/)[2].split(".").slice(0,2).join("."))),e}},{key:"selectSource",value:function(t,n){return _.find(t.source,_.map(function(n){return Object.assign({type:e.getMimeType(t.src||n.src)},t,n)}),_.filter(function(e){return n(e)}))}},{key:"getSourceByType",value:function(t,n){var i=null!=t.source?t.source.slice():[];return null==t.type&&(t.type=e.getMimeType(t.src)),i.push(t),i.find(function(e){return e.type===n})}},{key:"getMimeType",value:function(t){return e.mimeTypes[e.getFileExtension(t)]}},{key:"selectTrack",value:function(e,t){return e.find(function(e){return e.kind===t})}},{key:"isIPhone",value:function(){return/iPhone/.test(D)||/iPhone/.test(R)}},{key:"isIPad",value:function(){return/iPad/.test(D)||/iPad/.test(R)}},{key:"isAndroid",value:function(){return/Android [4-9]/.test(R)}},{key:"isKindleFireHD",value:function(){return/Silk\/2/.test(R)}},{key:"isKindleFire",value:function(){return/Silk\/1/.test(R)}},{key:"isBlackBerry",value:function(){return/BlackBerry;|PlayBook|BB10/.test(R)}},{key:"isFirefoxOS",value:function(){return/\(Mobile;.*Firefox\//.test(R)}},{key:"isHTML5",value:function(){return e.isIOS()||e.isAndroid()||e.isKindleFireHD()||e.isBlackBerry()||e.isFirefoxOS()}},{key:"isIOS",value:function(){var e=/iP(hone|od|ad)/i;return e.test(D)||e.test(R)}},{key:"getIOSversion",value:function(){if(e.isIOS()){var t=w.match(/OS (\d+)_(\d+)_?(\d+)?/);if(null==t&&(t=w.match(/Version\/(\d+)\.(\d+)/)),null!=t)return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3]||0,10)]}}},{key:"isFullscreenDevice",value:function(){return e.isKindleFireHD()||e.isIPhone()}},{key:"getDevice",value:function(){var t="desktop";return e.isIPhone()?t="iphone":e.isIPad()?t="ipad":/Android/.test(R)?t="android":e.isKindleFireHD()?t="kindlefirehd":e.isKindleFire()&&(t="kindlefire"),t}},{key:"xmlToJson",value:function(t){var n={};return 9===t.nodeType&&(t=t.firstChild),1===t.nodeType?t.attributes.length>0&&(n["@attributes"]={},_.each(t.attributes,function(e){n["@attributes"][e.nodeName]=e.nodeValue})):3!==t.nodeType&&4!==t.nodeType||(n=t.nodeValue),t.hasChildNodes()&&_.each(t.childNodes,function(t){if(3!==t.nodeType||/\S/.test(t.nodeValue)){var i=t.nodeName.replace(/:/,"-"),r=e.xmlToJson(t);null==r["@attributes"]&&null!=r["#text"]&&(r=r["#text"]),null==n[i]?n[i]=r:(n[i]instanceof Array||(n[i]=[n[i]]),n[i].push(r))}}),n}},{key:"getXHR",value:function(){return new XMLHttpRequest}},{key:"getUTC",value:function(){return e.request("//time.akamai.com").then(function(e){return 1e3*parseFloat(e.responseText)})}},{key:"request",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(n,i){t=S.create(t);var r=e.getXHR();if(r.open(t.method,t.url),r.onload=function(){t.checkStatus!==!1&&r.status>399&&i(r),n(r)},r.onerror=function(e){return i(r)},r.withCredentials=t.withCredentials,null!=t.responseType)try{r.responseType=t.responseType}catch(e){}if(null!=t.headers){var a=t.headers;_.each(a,function(e,t){null!=t&&null!=e&&r.setRequestHeader(t,e)})}return r.send(t.data)})}},{key:"requestText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.request(t).then(function(e){return e.responseText})}},{key:"requestJson",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.requestText(t).then(function(e){return JSON.parse(e)})}},{key:"jsonp",value:function(t,n){return new Promise(function(i,r){return window[n]=i,e.loadScript(t).then(function(e){e.parentNode.removeChild(e),window[n]=null;try{delete window[n]}catch(e){}}).catch(r)})}},{key:"loadScript",value:function(e,t){return new Promise(function(n,i){var r=t||document.getElementsByTagName("head")[0],a=document.createElement("script");a.type="text/javascript",a.addEventListener?(a.onload=function(){n(a)},a.onerror=function(e){i(e)}):a.readyState&&(a.onreadystatechange=function(e){"loaded"!==this.readyState&&"complete"!==this.readyState||(this.onreadystatechange=null,n(a))}),a.src=e,r.appendChild(a)})}},{key:"loadStyleSheet",value:function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("link");return n.rel="stylesheet",n.type="text/css",n.href=e,t.appendChild(n)}},{key:"loadImage",value:function(e){return new Promise(function(t,n){try{var i=document.createElement("img");return i.onload=function(e){return t(i)},i.onerror=function(e){return n(e)},i.src=e}catch(e){return n(e)}})}},{key:"getFileExtension",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/\?.*/,"").replace(/\#.*/,"").split(".").pop()}},{key:"isTouchDevice",value:function(){if(null==e.isTouch)try{document.createEvent("TouchEvent"),e.isTouch=!0}catch(t){e.isTouch=!1}return e.isTouch}},{key:"clamp",value:function(e,t,n){return e<t&&(e=t),e>n&&(e=n),e}},{key:"override",value:function(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return null==t?n:null==n?t:(i===!0&&(t=e.clone(t),n=e.clone(n)),Object.getOwnPropertyNames(n).forEach(function(i){var r=n[i],a=t[i],s=babelHelpers.typeof(r);"undefined"!==s&&(null==a||"object"!==babelHelpers.typeof(a)||r instanceof Array?t[i]=r:"object"===s&&(t[i]=e.override(a,r,!1)))}),t)}},{key:"merge",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=n[0]instanceof Array?n[0]:n;return r.reduce(function(t,n){return null!=n?e.override(t,n,!1):t},{})}},{key:"mixin",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(null==e||n.length<1)return e;var r=Object.getOwnPropertyNames,a=Object.getPrototypeOf;return n.forEach(function(t){var n=r(t).concat(r(a(t)));n.forEach(function(n){return e[n]=t[n]})}),e}},{key:"diff",value:function t(n,i){if(null==i)return null;if(null==n&&null!=i)return i;var r={};for(var a in i){var s=i[a],o=n[a];if(o!==s)if(null==o)r[a]=s;else switch(babelHelpers.typeof(s)){case"string":case"number":case"boolean":case"function":r[a]=s;break;case"object":if(s instanceof Array)o.length!==s.length&&(r[a]=s);else{var t=e.diff(o,s);null!=t&&(r[a]=t)}}}return 0===Object.keys(r).length?null:r}},{key:"clone",value:function t(n){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(null==n)return n;var t=n;if("object"===babelHelpers.typeof(n)){t=n instanceof Array?[]:{};var r=function(r){var a=n[r];if("object"===babelHelpers.typeof(a)&&null!==a&&i===!0)if(a instanceof Array)t[r]=[],a.forEach(function(n){return t[r].push(e.clone(n))});else{t[r]={};for(var s in a)t[r][s]=e.clone(a[s])}else t[r]=a};for(var a in n)r(a)}return t}},{key:"get",value:function(e,t){if(!(null==e||null==t||t.length<1)){"string"==typeof t&&(t=t.split("."));for(var n=0,i=t.length;n<i;++n){var r=t[n];if(null==e[r])return;e=e[r]}return e}}},{key:"set",value:function(e,t,n){if(!(null==e||null==t||t.length<1)){var i=t.length-1;t.forEach(function(t,r){return r===i?e[t]=n:(null==e[t]&&(e[t]={}),void(e=e[t]))})}}},{key:"formatTimecode",value:function(t,n){if(t=parseInt(t),isNaN(t))return"00:00";var i=e.formatZeroFill(t%60);return t=parseInt(t/60),i=e.formatZeroFill(t%60)+":"+i,t=parseInt(t/60),t>0&&(i=e.formatZeroFill(t)+":"+i),
n>=3600&&5===i.length&&(i="00:"+i),i}},{key:"formatZeroFill",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return e.toString().padStart(t,"0")}},{key:"toDate",value:function(e){return e instanceof Date?e:new Date(e)}},{key:"formatTime",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"h:mm:ss A",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{timezone:"",offset:-((new Date).getTimezoneOffset()/60)};if(t=e.toDate(t),null!=i.offset&&0!==i.offset&&(t=new Date(t.getTime()+Math.round(60*i.offset*60*1e3))),!isNaN(t.getTime())){var r=t.getUTCHours(),a=t.getUTCMinutes(),s=t.getUTCSeconds(),o=t.getUTCMilliseconds(),l=r%12||12,u=r<12?"am":"pm",c={hh:e.formatZeroFill(l),h:l,HH:e.formatZeroFill(r),H:r,mm:e.formatZeroFill(a),m:a,sss:e.formatZeroFill(o,3),ss:e.formatZeroFill(s),s:s,a:u,A:u.toUpperCase(),z:i.timezone};for(var h in c)n=n.replace(h,c[h]);return n}}},{key:"flattenTimecode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;if(!e)return NaN;var n=e.split(":"),i=0;if(4===n.length)i=parseInt(n.pop())/t;else if(3===n.length&&(n[2]=n[2].replace(",","."),n[2].indexOf(".")!==-1)){var r=n[2].split(".");(null!=r?r.length:void 0)>1&&(n[2]=r[0],i=parseInt(r[1])/1e3)}for(var a=parseInt(n.pop());n.length>0;)a+=Math.pow(60,n.length)*parseInt(n.shift());return a+i}},{key:"cacheBust",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"cacheBust",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),i=e.indexOf("?")===-1?"?":"&";return e+i+t+"="+n}},{key:"getFeed",value:function(t){return e.request(t).then(function(t){return"document"===t.responseType||/^</.test(t.responseText)?e.xmlToJson(t.responseXML):JSON.parse(t.responseText)})}},{key:"trackMouse",value:function(){try{document.addEventListener("mousemove",e.mouseTracker),document.documentElement.addEventListener("mouseleave",function(t){if(null===t.relatedTarget)return e.doc=!1}),document.documentElement.addEventListener("mouseenter",function(t){if(null===t.relatedTarget)return e.doc=!0})}catch(e){}}},{key:"mouseTracker",value:function(t){e.clientX=t.clientX,e.clientY=t.clientY,e.pageX=t.pageX,e.pageY=t.pageY}},{key:"isMouseOverElement",value:function(t){var n=!1;if(null==t)return n;try{n=t.contains(document.elementFromPoint(e.clientX,e.clientY))}catch(e){n=!1}return n}},{key:"isMouseOverDocument",value:function(){return e.doc}},{key:"getActualSize",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.offsetWidth,i=e.offsetHeight;if(t===!0){var r=getComputedStyle(e);n+=parseInt(r.marginLeft)+parseInt(r.marginRight),i+=parseInt(r.marginTop)+parseInt(r.marginBottom)}return{width:n,height:i}}},{key:"isVolumeSettable",value:function(){var e=/ipad|iphone|ipod|android|blackberry|windows ce|windows phone|webos|playbook/.exec(R.toLowerCase());return null==e||"android"===e[0]&&/Firefox/.test(R)}},{key:"createUID",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,i=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},r="",a=t-1,s=0;s<a;s++)r+=i(0,n-1).toString(n).toUpperCase();return e.uids[r]===!0?e.createUID(t,n):(e.uids[r]=!0,r)}},{key:"chain",value:function e(t,n){var e=Promise.resolve(n);return t.forEach(function(t){return e=e.then(t)}),e}},{key:"first",value:function(t,n){return Promise.resolve(n).then(t.shift()).then(function(e){return e}).catch(function(i){return t.length>0?e.first(t,n):null})}},{key:"transform",value:function(e,t){if(null==t||0===t.length)return Promise.resolve(e);t=t.map(function(e){return"function"==typeof e.transform?e.transform:e});var n=0,i=t.length-1,r=function(e){return n++,a(e)},a=function(e){var a=t[n];if("function"!=typeof a)throw new Error("Transform must be a valid function");return Promise.resolve(a(e,r)).then(function(e){return n<i?r(e):e})};return a(e)}},{key:"arrayBufferToString",value:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}},{key:"parseJWT",value:function(e){var t=e.split(".");return{header:JSON.parse(atob(t[0])),payload:JSON.parse(atob(t[1])),signature:t[2]}}},{key:"getFullScreenApi",value:function(e,t){var n={};return null!=e.webkitRequestFullScreen?(n.enter=e.webkitRequestFullScreen.bind(e),n.exit=null!=document.webkitExitFullscreen?document.webkitExitFullscreen.bind(document):document.webkitCancelFullScreen.bind(document),n.event="onwebkitfullscreenchange",n.element="webkitFullscreenElement",n.error="webkitfullscreenerror"):null!=e.requestFullscreen?(n.enter=e.requestFullscreen.bind(e),n.exit=null!=document.exitFullscreen?document.exitFullscreen.bind(document):document.cancelFullscreen.bind(document),n.event="onfullscreenchange",n.element="fullscreenElement",n.error="fullscreenerror"):null!=e.mozRequestFullScreen?(n.enter=e.mozRequestFullScreen.bind(e),n.exit=document.mozCancelFullScreen.bind(document),n.event="onmozfullscreenchange",n.element="mozFullscreenElement",n.error="mozfullscreenerror"):null!=e.msRequestFullscreen?(n.enter=e.msRequestFullscreen.bind(e),n.exit=document.msExitFullscreen.bind(document),n.event="onmsfullscreenchange",n.element="msFullscreenElement",n.error="MSFullscreenError"):null!=t.webkitEnterFullscreen&&(n.enter=t.webkitEnterFullscreen.bind(t),n.exit=t.webkitExitFullscreen.bind(t),n.event=null,n.error=null),n}},{key:"getPictureInPictureApi",value:function(e){var t={};return null!=e.requestPictureInPicture?(t.enter=e.requestPictureInPicture.bind(e),t.exit=document.exitPictureInPicture.bind(document),t.event="onleavepictureinpicture",t.eventName="leavepictureinpicture",t.element="pictureInPictureElement"):null!=e.webkitSetPresentationMode&&(t.enter=e.webkitSetPresentationMode.bind(e,"picture-in-picture"),t.exit=e.webkitSetPresentationMode.bind(e,"inline"),t.event="onwebkitpresentationmodechanged",t.eventName="webkitpresentationmodechanged",t.element="pictureInPictureElement"),t}},{key:"isPictureInPictureSupported",value:function(e){return 1!=e.disablePictureInPicture&&0!=document.pictureInPictureEnabled&&("function"==typeof e.webkitSupportsPresentationMode||"function"==typeof e.requestPictureInPicture)}},{key:"stringToArray",value:function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),i=0,r=e.length;i<r;i++)n[i]=e.charCodeAt(i);return n}},{key:"arrayToString",value:function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))}},{key:"base64DecodeUint8Array",value:function(e){for(var t=window.atob(e),n=t.length,i=new Uint8Array(new ArrayBuffer(n)),r=0,a=0,s=n-1;0<=s?a<=s:a>=s;r=0<=s?++a:--a)i[r]=t.charCodeAt(r);return i}},{key:"base64EncodeUint8Array",value:function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=e.length,i="",r=0;r<n;){var a=e[r++],s=r<n?e[r++]:Number.NaN,o=r<n?e[r++]:Number.NaN,l=a>>2,u=(3&a)<<4|s>>4,c=(15&s)<<2|o>>6,h=63&o;isNaN(s)?c=h=64:isNaN(o)&&(h=64),i+=t.charAt(l)+t.charAt(u)+t.charAt(c)+t.charAt(h)}return i}},{key:"getKeySystem",value:function(){var t=H.key;return 0===t.length||t.indexOf(H.UNKNOWN)!==-1?e.getKeySystemByUserAgent():t}},{key:"getKeySystemByUserAgent",value:function(){return/Edge/.test(R)||/Trident/.test(R)||/Tizen/.test(R)?[H.PLAYREADY,H.CLEARKEY]:/Chrome/.test(R)||/Firefox/.test(R)?[H.WIDEVINE,H.CLEARKEY]:/Safari/.test(R)?[H.FAIRPLAY]:[H.UNKNOWN]}},{key:"isAutoplaySupported",value:function(){var t=!0;if(e.isIOS())if(e.getSafariVersion()!==-1){var n=e.getIOSversion()||[];t=n[0]>=10}else e.isChrome()&&(t=e.getChromeVersion()>=53);return e.isChrome()&&e.isAndroid()&&(t=e.getChromeVersion()>=53),t}},{key:"fieldIsUnique",value:function(e,t,n){return n=n.toString().toLowerCase(),!e.some(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.hasOwnProperty(t)?e[t]:"";return i.toString().toLowerCase()===n})}},{key:"toCamelCase",value:function(e){return e.replace(/-|_([a-z])/g,function(e){return e[1].toUpperCase()})}},{key:"toHyphenated",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return e.replace(/([A-Z])/g,function(e){return t+e[0].toLowerCase()})}},{key:"toSnakeCase",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t=e.toHyphenated(t,"_"),n===!0?t.toUpperCase():t}},{key:"createElement",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"div";return"string"==typeof i&&(i=document.createElement(i)),null!=e&&("string"==typeof e&&(e=[e]),e.forEach(function(e){return i.classList.add(e)})),null!=n&&(i.textContent=n),null!=t&&t.appendChild(i),i}},{key:"select",value:function(e){if("string"==typeof e){var t=document.getElementById(e);null==t&&(t=document.querySelector(e)),e=t}return e}},{key:"getViewability",value:function(t){t=e.select(t);var n=t.getBoundingClientRect(),i=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight,a=n.top>=0,s=n.left>=0,o=n.bottom<=r,l=n.right<=i;switch(!0){case a&&s&&o&&l:return"full";case!a&&n.bottom<=0||!s&&n.right<=0||!l&&n.left>=i||!o&&n.top>=r:return"none";case a||s||o||l:return"partial"}}},{key:"isViewable",value:function(t){return"full"===e.getViewability(t)}},{key:"timerGroup",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null==e.timerGroups&&(e.timerGroups={}),n===!0){var i=e.timerGroups[t];return null!=i&&i.destroy(),void delete e.timerGroups[t]}return null==e.timerGroups[t]&&(e.timerGroups[t]=u.create(t)),e.timerGroups[t]}},{key:"startsWith",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.substring(n,n+t.length)===t}},{key:"compareLanguageTags",value:function(e,t){return this.startsWith(e,t)||this.startsWith(t,e)}}]),e}();U.isTouch=null,U.clientX=0,U.clientY=0,U.pageX=0,U.pageY=0,U.doc=!0,U.trackMouse(),U.uids={};var V=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"toColor",value:function(e){var t;t=/$#/.test(e)?hex.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,i){return"#"+t+t+n+n+i+i}).substring(1).match(/.{2}/g).map(x(function(){return parseInt(x,16)})):e.match(/[0-9\.]+/g);var n=parseInt(t[0]),i=parseInt(t[1]),r=parseInt(t[2]),a=null!==t[3]?parseFloat(t[3]):1;return{r:n,g:i,b:r,a:a}}},{key:"fromColor",value:function(e){return null==e.a&&(e.a=1),"rgba(".concat(e.r,",").concat(e.g,",").concat(e.b,",").concat(e.a,")")}},{key:"toPercent",value:function(e){return"string"==typeof e?e:"".concat(Math.round(100*e),"%")}},{key:"fromPercent",value:function(e){return"number"==typeof e?e:parseFloat(e)/100}},{key:"toSize",value:function(e){return/^[0-9]+$/.test(e)?e+"px":e}},{key:"toCSS",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="";return t=t===!0?" !important":"",_.each(e,function(e,i){return n+="".concat(U.toHyphenated(i),":").concat(e).concat(t,";")}),n}}]),e}(),Y=function(){function e(t){babelHelpers.classCallCheck(this,e),this.enabled=t,this.enabled||(this.log=this.trace=this.debug=this.info=this.warn=this.error=this.fatal=function(){})}return babelHelpers.createClass(e,[{key:"log",value:function(){try{arguments.length>1&&null!=arguments[1]?console.log.apply(console,arguments):console.log(arguments[0])}catch(e){}}},{key:"trace",value:function(){try{console.trace.apply(console,arguments)}catch(e){}}},{key:"debug",value:function(){try{console.log.apply(console,arguments)}catch(e){this.log.apply(this,arguments)}}},{key:"info",value:function(){try{console.info.apply(console,arguments)}catch(e){}}},{key:"warn",value:function(){try{console.warn.apply(console,arguments)}catch(e){}}},{key:"error",value:function(){try{console.error.apply(console,arguments)}catch(e){this.log.apply(this,arguments)}}},{key:"fatal",value:function(){try{console.fatal.apply(console,arguments)}catch(e){}}}]),e}(),z={LOADED_METADATA:"loadedmetadata",READY:"ready",ERROR:"error",ENDED:"ended",STARTED:"started",DURATION_CHANGE:"durationchange",SEEKING:"seeking",SEEKED:"seeked",TIME_UPDATE:"timeupdate",LOAD_START:"loadstart",LOADED_DATA:"loadeddata",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",PROGRESS:"progress",MEDIA_CHANGE:"mediachange",WAITING:"waiting",BUFFERING_CHANGE:"bufferingchange",STALLED:"stalled",PLAY:"play",PLAYING:"playing",PAUSE:"pause",PAUSED:"paused",PLAY_REQUEST:"playrequest",MEDIUM_CHANGE:"mediumchange",TEMPORAL_TYPE_CHANGE:"temporaltypechange",VOLUME_CHANGE:"volumechange",FAIL_OVER_ATTEMPT:"failoverattempt",PLAYBACK_TARGET_CHANGE:"playbacktargetchange",PLAYBACK_TARGET_AVAILABILITY_CHANGE:"playbacktargetavailabilitychange",RECORD_CONTENT_CHANGE:"recordcontentchange",IS_LIVE:"islive",CONTENT_CHANGED:"contentchanged",PLAYBACK_RATE_CHANGE:"playbackratechange",SETTINGS_CHANGE:"settingschange",TRACK_ERROR:"trackerror",QUALITY_CHANGE:"qualitychange",QUALITY_CHANGING:"qualitychanging",QUALITY_SWITCHED:"qualityswitched",QUALITY_MODE_CHANGE:"qualitymodechange",QUALITY_LEVELS_LOADED:"qualitylevelsloaded",MEDIA_SEQUENCE_INITIALIZED:"mediasequenceinitialized",MEDIA_SEQUENCE_STARTED:"mediasequencestarted",MEDIA_SEQUENCE_ENDED:"mediasequenceended",MEDIA_SEQUENCE_ABORTED:"mediasequenceaborted",AUTOPLAY_BLOCKED:"autoplayblocked",LANGUAGE_CHANGE:"languagechange",TIMED_METADATA:"timedmetadata",CUES_CHANGE:"cueschange",VIEW_CREATED:"viewcreated",MUTE_CHANGE:"mutechange",RESUME:"resume",PLAY_STATE_CHANGE:"playstatechange",FULL_SCREEN_CHANGE:"fullscreenchange",DISPLAY_STATE_CHANGE:"displaystatechange",BUSY:"busy",CREATE:"create",DESTROY:"destroy",GO_LIVE:"golive"},B={NONE:"none",DEFAULT:"default",MUTED:"muted"},F=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"UNKNOWN",get:function(){return"unknown"}},{key:"ALLOWED",get:function(){return"allowed"}},{key:"MUTED",get:function(){return"muted"}},{key:"MUTED_INLINE",get:function(){return"mutedinline"}},{key:"BLOCKED",get:function(){return"blocked"}},{key:"threshold",get:function(){return j},set:function(e){j=e}},{key:"detect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U.blankVideo();return new Promise(function(n,i){var r=function(e){try{l.removeEventListener("error",a),l.pause()}catch(e){}n(e)},a=function(){r(e.UNKNOWN)},s=function(){l.muted=!0,l.play().then(function(){return r(e.MUTED)}).catch(o)},o=function(){l.playsInline=!0,l.play().then(function(){return r(e.MUTED_INLINE)}).catch(function(){return r(e.BLOCKED)})};try{if(!U.isAutoplaySupported())return n(e.BLOCKED);var l=document.createElement("video");l.addEventListener("error",a),l.volume=.01,l.src=t,Promise.resolve(l.play()).then(function(){return r(e.ALLOWED)}).catch(s)}catch(e){a()}})}},{key:"init",value:function(t){return t.autoplayPolicy===B.NONE?Promise.resolve(j=e.UNKNOWN):U.isHTML5()===!0?(j=U.isAutoplaySupported()?U.isIOS()?e.MUTED_INLINE:e.MUTED:e.BLOCKED,Promise.resolve(j)):this.value(j===e.UNKNOWN)}},{key:"value",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e===!0&&(j=null,K=null),null!=j?Promise.resolve(j):(null==K&&(K=this.detect().then(function(e){return j=e,K=null,e})),K)}}]),e}(),j=F.UNKNOWN,K=null,W={NONE:"none",METADATA:"metadata",AUTO:"auto"},q={VERSION:"9.1.11",PRODUCT:"premier",PLATFORM:"web",PLAYER_ID:"",CREATE:"http://localhost:2672/beacon/create/",TRACK:"http://localhost:2672/beacon/track/"},Q=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};babelHelpers.classCallCheck(this,e);var n=U.override(e.defaults,t),i=P.amp.debug;null!=i&&(n.debug=i),null==n.defaults&&(n.defaults={}),n.controls===!0&&(n.plugins.react=null),Object.assign(this,n),/muted/i.test(this.autoplay)&&(this.autoplayPolicy=B.MUTED,this.autoplay=!0)}return babelHelpers.createClass(e,null,[{key:"create",value:function(t){return new e(t)}}]),e}();Q.defaults={id:null,paths:{base:"../",player:"${paths.base}akamai/amp/core/",plugins:"${paths.base}akamai/amp/",libs:"${paths.player}libs/",resources:"${paths.base}resources/"},resources:[{debug:"${paths.player}amp.css",src:"${paths.player}amp.min.css",type:"text/css",async:!0}],plugins:{react:{resources:[{src:"${paths.plugins}react/libs/react.min.js",debug:"${paths.plugins}react/libs/react.js",type:"text/javascript"},{src:"${paths.plugins}react/React.min.css",debug:"${paths.plugins}react/React.css",type:"text/css"},{src:"${paths.plugins}react/React.min.js",debug:"${paths.plugins}react/React.js",type:"text/javascript"}],autoHide:3,hint:{enabled:!0}}},pid:q.PLAYER_ID,dataset:{},settings:{},preload:W.NONE,language:navigator.language||navigator.browserLanguage,autoplay:!1,autoplayPolicy:B.DEFAULT,loop:!1,controls:!1,playsinline:null,withCredentials:!1,muted:null,fullscreen:{},captioning:{},hls:{resources:[{type:"text/javascript",src:"${paths.libs}hls.min.js",debug:"${paths.libs}hls.js",defer:!0}],quality:{startLevel:-1},data:{enableWorker:!0}},dash:{resources:[{type:"text/javascript",src:"//cdn.dashjs.org/v4.1.0/dash.all.min.js",debug:"//cdn.dashjs.org/v4.1.0/dash.all.debug.js",defer:!0}],buffer:1},locales:{},defaults:{language:"en"}},Q.locales={en:{MONOSPACED_SERIF:"Monospaced Serif",PROPORTIONAL_SERIF:"Proportional Serif",MONOSPACED_SANS_SERIF:"Monospaced Sans-Serif",PROPORTIONAL_SANS_SERIF:"Proportional Sans-Serif",CASUAL:"Casual",CURSIVE:"Cursive",SMALL_CAPS:"Small Capitals",ERROR:"Error",ERROR_ABORTED:"Media Aborted",ERROR_DECODE:"Decode Error",ERROR_NETWORK:"Network Error",ERROR_SRC:"Source not supported",ERROR_DEFAULT:"An unknown error has occurred",STREAM_NOT_FOUND:"Stream not found",EN:"English",ENG:"English",ES:"Spanish",SPA:"Spanish",DE:"German",DEU:"German",GER:"German",FR:"French",FRE:"French",FRA:"French",IT:"Italian",ITA:"Italian",RU:"Russian",RUS:"Russian",ZH:"Chinese",ZHO:"Chinese",CHI:"Chinese",JA:"Japanese",JPN:"Japanese",KO:"Korean",KOR:"Korean",SV:"Swedish",SWE:"Swedish",PHI:"Philippine",PT:"Portuguese",POR:"Portuguese",UNKNOWN:"Unknown"},es:"#{paths.player}es.json",fr:"#{paths.player}fr.json"};var Z=/^\s*[#\$]{([^\$#{}]+)}\s*$/,X=/[#\$]{([^\$#}]*)}/g,$=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"SINGLE",get:function(){return Z}},{key:"TOKEN",get:function(){return X}},{key:"eval",value:function(e,t){var n=this;if(null==e)return e;if(Z.test(e))try{return this.exec(e.replace(Z,"$1"),t)}catch(t){return e}return e.replace(X,function(e,i,r,a){try{return n.exec(i,t)}catch(t){return e}})}},{key:"exec",value:function(e,t){return new Function("with (this) { return ".concat(e," }")).bind(t)()}},{key:"evaluateBindings",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null!=e){if("object"===babelHelpers.typeof(e)){var r=i===!0?JSON.parse(JSON.stringify(e)):e;if(e instanceof Array)return r.map(function(e){return n.evaluateBindings(e,t,!1)});e={};for(var a in r)e[a]=this.evaluateBindings(r[a],t,!1);return e}if("string"==typeof e){var s=this.eval(e,t);return s!==e&&X.test(s)===!0?this.evaluateBindings(s,t,i):s}return e}}}]),e}(),J=function(e){function t(n,i){var r;return babelHelpers.classCallCheck(this,t),r=e.call(this,i)||this,r.config=n,r}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"initializeNotifier",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"initializeNotifier",this).call(this,e),this.createData()}},{key:"createData",value:function(){this.setData(this.config)}},{key:"getDefaults",value:function(){return this.defaults||{}}},{key:"setData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={};return this.getDefaults(),_.each(this.getDefaults(),function(t,i){return n[i]=i in e?e[i]:t}),babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"setData",this).call(this,n),e}},{key:"destroy",value:function(){}}],[{key:"NAME",get:function(){return"ModuleProxy"}}]),t}(puremvc.Proxy),ee=function(e){function t(n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,n.getModuleName())||this,i.module=n,i.mediator=null,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"initializeNotifier",value:function(e){var n=this;babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"initializeNotifier",this).call(this,e);var i=this.module.listNotificationPublications();null!=i&&(this.mediator=new puremvc.Mediator(this.facade.getModuleName()),this.mediator.listNotificationInterests=function(){return i},this.mediator.handleNotification=function(e){n.facade.sendNotification(e.getName(),e.getBody(),e.getType())})}},{key:"onRegister",value:function(){null!=this.mediator&&this.module.registerMediator(this.mediator)}},{key:"onRemove",value:function(){null!=this.mediator&&this.module.removeMediator(this.mediator)}},{key:"listNotificationInterests",value:function(){return this.module.listNotificationInterests()}},{key:"handleNotification",value:function(e){this.module.sendNotification(e.getName(),e.getBody(),e.getType())}}]),t}(puremvc.Mediator),te=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"execute",value:function(e){var t=e.getBody();t.player=this.facade.player||this.facade,this.facade.dispatchEvent(t)}}]),t}(puremvc.SimpleCommand),ne=function(){function e(){babelHelpers.classCallCheck(this,e),this._transformMap={}}return babelHelpers.createClass(e,[{key:"addTransform",value:function(e,t){if(null!=t&&null!=e){if(null==this._transformMap[e])this._transformMap[e]=[];else if(this._transformMap[e].indexOf(t)!==-1)return;this._transformMap[e].push(t),this.sortTransforms(e)}}},{key:"sortTransforms",value:function(e,t){return null==t&&(t=function(e,t){var n=e.priority||0,i=t.priority||0;return i-n}),this._transformMap[e].sort(t)}},{key:"transform",value:function(e,t){var n=this._transformMap[e];return null==n?Promise.resolve(t):U.transform(t,n)}},{key:"removeTransform",value:function(e,t){if(null!=t&&null!=e){var n=this._transformMap[e];if(null!=n){var i=n.indexOf(t);if(i!==-1)return n.splice(i,1)}}}}],[{key:"create",value:function(){return new e}}]),e}(),ie={TIME:"time",SEEK:"seek",MEDIA:"media",AD_REQUEST:"adrequest",AD_BREAK:"adbreak",PLAY_STATE:"playstate",EVENT:"event",ERROR:"error",CUE_CHANGE:"cuechange"},re={INTERNAL:"internal",STARTUP:"startup",LOAD:"load",REQUEST_PLAY:"requestplay",PAUSE_REQUEST:"pauserequest",TOGGLE_PLAY_PAUSE:"toggleplaypause",CHANGE_PLAY_STATE:"changeplaystate",MEDIA_ELEMENT_CHANGE:"mediaelementchange",HIDDEN_CHANGE:"hiddenchange",TOGGLE_FULL_SCREEN:"togglefullscreen",CHANGE_DISPLAY_STATE:"changedisplaystate",DISABLE_FULL_SCREEN:"disablefullscreen",ENABLE_FULL_SCREEN:"enablefullscreen",CHANGE_ACTIVE_STATE:"changeactivestate",ACTIVE_STATE_CHANGE:"activestatechange",CHANGE_MEDIA:"changemedia",SET_MEDIA:"setmedia",MEDIA_VALIDATED:"mediavalidated",CHANGE_SETTINGS:"changesettings",CHANGE_VOLUME:"changevolume",CHANGE_MUTED:"changemuted",TOGGLE_MUTED:"togglemuted",CHANGE_TIME:"changetime",TIME_CHANGE:"timechange",SEEK:"seek",SEEK_COMPLETE:"seekcomplete",CHANGE_DURATION:"changeduration",CHANGE_AUTOPLAY:"changeautoplay",AUTOPLAY_CHANGE:"autoplaychange",CHANGE_LOOP:"changeloop",CHANGE_PRELOAD:"changepreload",CHANGE_CONTROLS:"changecontrols",PLAYBACK_CORE_CHANGE:"playbackcorechange",START:"start",END:"end",REPLAY:"replay",ADD_LAYER:"addlayer",REMOVE_LAYER:"removelayer",ADD_OVERLAY:"addoverlay",REMOVE_OVERLAY:"removeoverlay",ADD_CONTROL:"addcontrol",REMOVE_CONTROL:"removecontrol",ADD_CONTROL_STATE:"addcontrolstate",REMOVE_CONTROL_STATE:"removecontrolstate",ADD_APPLICATION_STATE:"addapplicationstate",REMOVE_APPLICATION_STATE:"removeapplicationstate",DISPATCH_EVENT:"dispatchevent",INITIALIZED:"initialized",REGISTER_PLAYBACK_CORE:"registerplaybackcore",REMOVE_PLAYBACK_CORE:"removeplaybackcore",CHANGE_PLAYBACK_TARGET:"changeplaybacktarget",LOCK:"lock",FRAGMENT_LOAD_START:"fragmentloadstart",FRAGMENT_LOADED:"fragmentloaded",CHANGE_CONTENT:"changecontent",ENABLE_VIDEO_EVENTS:"enablevideoevents",DISABLE_VIDEO_EVENTS:"disablevideoevents",HAS_POST_CONTENT:"haspostcontent",AUDIO_TRACK_SWITCH:"audiotrackswitch",TRACK:"track",init:function(){var e=this;_.each(z,function(t,n){"values"!==n&&"init"!==n&&(e[n]=t)})}},ae=function(e){function t(n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,U.createUID())||this,i.viewComponent=n,i.performance={init:Date.now(),record:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();return this[e]=t},elapsed:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"init";return this[e]-this[t]}},i.dispatcher=o.create(babelHelpers.assertThisInitialized(i)),i.transformer=ne.create(),i.logger=Y.instance,i.moduleMap={},i.emit=i.dispatch.bind(babelHelpers.assertThisInitialized(i)),i.on=i.addListener=i.addEventListener.bind(babelHelpers.assertThisInitialized(i)),i.off=i.removeListener=i.removeEventListener.bind(babelHelpers.assertThisInitialized(i)),i.config=null,i.oninitialized=null,i.onerror=null,i.parentModule=null,i.ignoreEvents=/(timeupdate|progress|fragmentloaded|fragmentloadstart|timeremaining|adtimeremaining)/,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"initialize",value:function(e,t){this.config=e,this.parentModule=t,this._id=this.config.id||this.multitonKey,this.loadModuleResources().then(this.resourcesLoaded.bind(this)).catch(this.resourcesError.bind(this))}},{key:"loadModuleResources",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config.resources;return!(null!=e?e.length:void 0)>0?Promise.resolve():Tt.addResources(this.evaluatePaths(e))}},{key:"evaluatePaths",value:function(e){var t,n;if(null!=e){var i=this.config.paths||(null!=(t=this.parentModule)&&null!=(n=t.config)?n.paths:void 0);return null!=i&&(e=$.evaluateBindings(e,{paths:i})),e}}},{key:"resourcesError",value:function(e){if(null==this.onerror)throw a.create(e);this.onerror(this)}},{key:"resourcesLoaded",value:function(){this.createFramework(),"function"==typeof this.oninitialized&&this.oninitialized(this)}},{key:"createFramework",value:function(){this.createModel(),this.createController(),this.createView()}},{key:"createModel",value:function(){this.registerProxy(new J(this.config))}},{key:"createView",value:function(){}},{key:"createController",value:function(){this.registerCommand(re.DISPATCH_EVENT,te)}},{key:"getModuleName",value:function(){return this.moduleName}},{key:"getId",value:function(){return this._id}},{key:"id",get:function(){return this.getId()}},{key:"getConfig",value:function(){return this.config}},{key:"hasModule",value:function(e){return null!=this.moduleMap[e]}},{key:"getModules",value:function(){var e={};return _.each(this.moduleMap,function(t,n){return e[n]=t.module}),e}},{key:"registerModule",value:function(e){var t=e.getModuleName();if(null!=e&&null==this.moduleMap[t]){var n=new ee(e);this.moduleMap[t]=n,this.registerMediator(n),e.onRegister()}}},{key:"retrieveModule",value:function(e){return this.moduleMap[e].module}},{key:"removeModule",value:function(e){var t=this.moduleMap[e];if(null!=t){delete this.moduleMap[e],this.removeMediator(e);var n=t.module;return n.onRemove.call(n),n}}},{key:"listNotificationInterests",value:function(){return[]}},{key:"listNotificationPublications",value:function(){return[]}},{key:"getViewComponent",value:function(){return this.viewComponent}},{key:"setViewComponent",value:function(e){return this.viewComponent=e,e}},{key:"onRegister",value:function(){}},{key:"onRemove",value:function(){}},{key:"destroy",value:function(){var e=this.retrieveProxy(J.NAME);null!=e&&"function"==typeof e.destroy&&e.destroy(),puremvc.Facade.removeCore(this.multitonKey),this.dispatcher.destroy(),null!=this.viewComponent&&(this.viewComponent.innerHTML="",this.viewComponent.className="")}},{key:"addEventListener",value:function(e,t){this.dispatcher.addEventListener(e,t)}},{key:"once",value:function(e,t){this.dispatcher.once(e,t)}},{key:"logEvent",value:function(e){if(this.ignoreEvents.test(e.type)!==!0){var t=this.getModuleName().toUpperCase();e.dispatcher&&(t+=" "+e.dispatcher),this.logger.log("[".concat(t," EVENT] ").concat(e.type),e)}}},{key:"dispatchEvent",value:function(e){var t=this;this.transform(ie.EVENT,e).then(function(n){if(null!=n)return t.logEvent(e),t.dispatcher.dispatchEvent(e)})}},{key:"dispatch",value:function(e,t){this.dispatchEvent(s.create(e,t))}},{key:"removeEventListener",value:function(e,t){this.dispatcher.removeEventListener(e,t)}},{key:"addTransform",value:function(e,t){return this.transformer.addTransform(e,t)}},{key:"sortTransforms",value:function(e,t){return this.transformer.sortTransforms(e,t)}},{key:"transform",value:function(e,t){return this.transformer.transform(e,t)}},{key:"removeTransform",value:function(e,t){return this.transformer.removeTransform(e,t)}}]),t}(puremvc.Facade),se={REGISTER_PLUGINS:"registerPlugins",PLUGIN_REGISTERED:"pluginRegistered",PLUGINS_INITIALIZED:"pluginsinitialized"},oe=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"extractContentId",value:function(e,t){var n=document.createElement("a");return n.href=U.arrayToString(e),n.hostname}},{key:"extractServerUrl",value:function(e,t){return t.serverURL||t.serverUrl}},{key:"requestCertificate",value:function(e){var t={url:e.cert,responseType:"arraybuffer",headers:{Pragma:"Cache-Control: no-cache","Cache-Control":"max-age=0"}};return U.request(t).then(function(e){return new Uint8Array(e.response)})}},{key:"concatInitDataIdAndCertificate",value:function(e,t,n){"string"==typeof t&&(t=U.stringToArray(t));var i=0,r=new ArrayBuffer(e.byteLength+4+t.byteLength+4+n.byteLength),a=new DataView(r),s=new Uint8Array(r,i,e.byteLength);s.set(e),i+=e.byteLength,a.setUint32(i,t.byteLength,!0),i+=4;var o=new Uint16Array(r,i,t.length);o.set(t),i+=o.byteLength,a.setUint32(i,n.byteLength,!0),i+=4;var l=new Uint8Array(r,i,n.byteLength);return l.set(n),new Uint8Array(r,0,r.byteLength)}},{key:"requestLicense",value:function(e,t,n,i){var r={url:n,method:"POST",responseType:"text",headers:{"Content-type":"application/x-www-form-urlencoded"},data:"spc=".concat(U.base64EncodeUint8Array(e),"&assetId=").concat(encodeURIComponent(t))};return _.each(i.httpRequestHeaders,function(e,t){return r.headers[t]=e}),"boolean"==typeof i.withCredentials&&(r.withCredentials=i.withCredentials),U.request(r).then(function(e){var t=e.responseText.trim();return"<ckc>"===t.substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6)),U.base64DecodeUint8Array(t)}).catch(function(e){throw"The license request failed."})}}]),e}(),le={NORMAL:"normal",FULL_SCREEN:"full-screen",FULLSCREEN:"full-screen",PICTURE_IN_PICTURE:"picture-in-picture"},ue={READY:"ready",PLAYING:"playing",PAUSED:"paused",ENDED:"ended",LOADING:"loading",WAITING:"waiting",ERROR:"error"},ce={ACTIVE:"active",INACTIVE:"inactive"},he=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this)||this,n.device=U.getDevice(),n.time={currentTime:0,duration:0},n.displayState=le.NORMAL,n.playState=null,n.activeState=null,n.seeking=!1,n.seekrequested=!1,n.waiting=!1,n.busy=!1,n.volume=1,n.playbackTarget="amp",n.hasPostContent=!1,n.locked=!0,n.mediaElement=null,n.hidden=!1,n.ended=!1,n.buffering=!1,n.playbackRate=1,n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getHasPostContent",value:function(){return this.hasPostContent}},{key:"setHasPostContent",value:function(e){this.hasPostContent=e}},{key:"getEnded",value:function(){return this.ended}},{key:"setEnded",value:function(e){this.ended=e,this.ended===!0&&this.seeking===!0&&(this.seeking=!1)}},{key:"getDisplayState",value:function(){return this.displayState}},{key:"setDisplayState",value:function(e){if(e!==this.displayState){var t=this.displayState;this.displayState=e,this.sendNotification(re.DISPLAY_STATE_CHANGE,{previous:t,value:this.displayState})}}},{key:"getPlayState",value:function(){
return this.playState}},{key:"setPlayState",value:function(e){var t=this;if(this.getWaiting()===!0&&this.setWaiting(!1),e!==this.playState){var n=this.playState;this.playState=e,this.facade.transform(ie.PLAY_STATE,this.playState).then(function(i){if(null!=i&&i!==n)switch(t.sendNotification(re.PLAY_STATE_CHANGE,{previous:n,value:t.playState}),e){case ue.PLAYING:return t.sendNotification(re.DISPATCH_EVENT,s.create("playing"))}}).catch(function(e){return t.sendNotification(re.ERROR,e)})}}},{key:"getDevice",value:function(){return this.device}},{key:"getSeeking",value:function(){return this.seeking}},{key:"setSeeking",value:function(e){e!==this.seeking&&(this.seeking=e,this.seeking===!1&&this.playState===ue.PAUSED&&this.setWaiting(!1))}},{key:"getSeekRequested",value:function(){return this.seekrequested}},{key:"setSeekRequested",value:function(e){e!==this.seekrequested&&(this.seekrequested=e)}},{key:"getWaiting",value:function(){return this.waiting}},{key:"setWaiting",value:function(e){var t=this;if(e!==this.waiting){this.waiting=e;var n=this.waiting===!0?re.ADD_APPLICATION_STATE:re.REMOVE_APPLICATION_STATE;if(this.sendNotification(n,ue.WAITING),this.waiting===!0){var i=function(){t.facade.removeEventListener("timeupdate",a),t.facade.removeEventListener("playing",r),t.facade.removeEventListener("canplaythrough",r),t.facade.removeEventListener("ended",r)},r=function(){i(),t.setWaiting(!1)},a=function(e){t.facade.seeking===!1&&r()};this.facade.addEventListener("timeupdate",a),this.facade.addEventListener("playing",r),this.facade.addEventListener("canplaythrough",r),this.facade.addEventListener("ended",r)}}}},{key:"getBusy",value:function(){return this.busy}},{key:"setBusy",value:function(e){e!==this.busy&&(this.busy=e,this.sendNotification(re.DISPATCH_EVENT,s.create("busy",e)))}},{key:"getLocked",value:function(){return this.locked}},{key:"setLocked",value:function(e){this.locked=e}},{key:"getBuffering",value:function(){return this.buffering}},{key:"setBuffering",value:function(e){this.buffering=e}},{key:"getMedium",value:function(){return this.medium}},{key:"setMedium",value:function(e){if(e!==this.medium){var t=null!=this.medium?"medium-"+this.medium:this.medium;this.medium=e,this.sendNotification(re.MEDIUM_CHANGE,{previous:t,value:"medium-".concat(this.medium)})}}},{key:"getVolume",value:function(){return this.volume}},{key:"setVolume",value:function(e){if(e!==this.volume)return this.volume=e}},{key:"getPlaybackTarget",value:function(){return this.playbackTarget}},{key:"setPlaybackTarget",value:function(e){if(e!==this.playbackTarget){var t=this.playbackTarget;this.playbackTarget=e,"amp"!==e?this.getPlayState()!==ue.PAUSED&&this.facade.pause():this.getPlayState()===ue.PLAYING&&this.facade.play(),this.sendNotification(re.PLAYBACK_TARGET_CHANGE,{previous:t,value:this.playbackTarget})}}},{key:"getActiveState",value:function(){return this.activeState}},{key:"setActiveState",value:function(e){if(e!==this.activeState){var t=this.activeState;this.activeState=e,this.sendNotification(re.ACTIVE_STATE_CHANGE,{previous:t,value:this.activeState})}}},{key:"getMediaElement",value:function(){return this.mediaElement}},{key:"setMediaElement",value:function(e){if(e!==this.mediaElement){var t=this.mediaElement;null!=t&&(e.volume=t.volume,e.muted=t.muted),this.mediaElement=e,this.sendNotification(re.MEDIA_ELEMENT_CHANGE,{previous:t,value:this.mediaElement})}}},{key:"getHidden",value:function(){return this.hidden}},{key:"setHidden",value:function(e){if(e!==this.hidden){var t=this.hidden;this.hidden=e,this.sendNotification(re.HIDDEN_CHANGE,{previous:t,value:this.hidden})}}},{key:"getCurrentTime",value:function(){return this.time.currentTime}},{key:"setCurrentTime",value:function(e){var t=this.time.duration,n=e>0?e:Math.abs(e/t)||0;n!==this.time.currentTime&&(this.time.currentTime=n,this.sendNotification(re.TIME_UPDATE,n))}},{key:"getDuration",value:function(){return this.time.duration}},{key:"setDuration",value:function(e){e!==this.time.duration&&(this.time.duration=e,this.sendNotification(re.DURATION_CHANGE,e))}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setPlaybackRate",value:function(e){e!==this.playbackRate&&(this.playbackRate=e,this.sendNotification(re.PLAYBACK_RATE_CHANGE,e))}}],[{key:"NAME",get:function(){return"ApplicationStateProxy"}}]),t}(puremvc.Proxy),de={AUTHENTICATE:"authenticate",AUTHENTICATED:"authenticated",AUTHENTICATION_FAILED:"authenticationfailed",AUTHORIZE:"authorize",AUTHORIZED:"authorized",AUTHORIZATION_FAILED:"authorizationfailed",AUTHORIZATION_EXPIRED:"authorizationexpired",CHOOSE_PROVIDER:"chooseprovider",ASSET_AUTHORIZED:"assetauthorized",ASSET_AUTHORIZATION_FAILED:"assetauthorizationfailed"},fe=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this,t.NAME,{})||this,n._authorized=!0,n._session=null,n.data=null,n.timeout=null,n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"setMedia",value:function(e){this.setSession(null);var t="blocked"!==e.status.state&&0===e.restriction.length;this.setAuthorized(t),this.setAuthorization(e.authorization)}},{key:"authorize",value:function(e){this.setAuthorization(e),this.sendNotification(de.AUTHORIZED,e)}},{key:"getAuthorization",value:function(){return this.data}},{key:"setAuthorization",value:function(e){return null!=(null!=e?e.token:void 0)&&this.setAuthorized(!0),this.data=e||{},null!=this.data.expiration&&this.setExpiration(this.data.expiration),e}},{key:"getKey",value:function(){return this.data.key}},{key:"setKey",value:function(e){return this.data.key=e,e}},{key:"getToken",value:function(){return this.data.token}},{key:"setToken",value:function(e){return this.data.token=e,e}},{key:"getExpiration",value:function(){return this.data.expiration}},{key:"setExpiration",value:function(e){return this.data.expiration=e,this.data.expiration>Date.now()&&this.startTimeout(),e}},{key:"startTimeout",value:function(){var e=this;U.getUTC().then(function(t){var n=function(){e.sendNotification(de.AUTHORIZATION_EXPIRED),e.sendNotification(de.AUTHORIZE,{media:e.facade.getMedia()})};return e.timeout=e.facade.timers.setTimeout(n,e.getExpiration()-t)})}},{key:"stopTimeout",value:function(){clearTimeout(this.timeout)}},{key:"getSecret",value:function(){if(null==this.data||null==this.data.token)return null;var e="";return null!=this.data.token&&(e="".concat(this.data.token)),null!=this.data.key&&(e="".concat(this.data.key,"=").concat(e)),e}},{key:"createURL",value:function(e){var t=this.getSecret();return null!=t&&(e+=/\?/.test(e)?"&":"?",e+=t),e}},{key:"getAuthorized",value:function(){return this._authorized}},{key:"setAuthorized",value:function(e){return this.stopTimeout(),this._authorized=e,e}},{key:"authorized",get:function(){return this.getAuthorized()}},{key:"getSession",value:function(){return this._session}},{key:"setSession",value:function(e){return this._session=e,e}}],[{key:"NAME",get:function(){return"SecurityProxy"}}]),t}(puremvc.Proxy),pe=function(e){function t(n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,n)||this,i.defaults=Q.defaults,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getValueOf",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.facade.getMedia()||{},r=i.metadata||{},a=r.config||{},s=function(){var s=i[e];return null!=s?s:(s=r[e],null!=s?s:(s=a[e],null!=s?s:(s=n[e],null!=s?s:(s=t.data[e],null!=s?s:(s=t.config[e],null!=s?s:void 0)))))};try{return this.facade.evaluateBindings(s())}catch(e){return null}}},{key:"getPID",value:function(){return this.data.pid}},{key:"getPlaysInline",value:function(){return this.data.playsinline}},{key:"getMuted",value:function(){return this.getValueOf("muted")}},{key:"setMuted",value:function(e){return this.data.muted=e,e}},{key:"getWithCredentials",value:function(){return this.getValueOf("withCredentials")}},{key:"setWithCredentials",value:function(e){return this.data.withCredentials=e,e}},{key:"getAutoplay",value:function(){return this.getValueOf("autoplay")}},{key:"setAutoplay",value:function(e){return this.data.autoplay=e,e}},{key:"getAutoplayPolicy",value:function(){return this.getValueOf("autoplayPolicy")}},{key:"setAutoplayPolicy",value:function(e){return this.data.autoplayPolicy=e,e}},{key:"getLoop",value:function(){return this.getValueOf("loop")}},{key:"setLoop",value:function(e){return this.data.loop=e,e}},{key:"getSettings",value:function(){return this.data.settings}},{key:"setSettings",value:function(e){return this.data.settings=e,e}},{key:"getPaths",value:function(){return this.data.paths}},{key:"setPaths",value:function(e){return this.data.paths=e,e}},{key:"getVersion",value:function(){return this.data.version}},{key:"getControls",value:function(){return this.getValueOf("controls")===!0}},{key:"setControls",value:function(e){return this.data.controls=e,e}},{key:"getFullscreen",value:function(){return this.data.fullscreen||{}}},{key:"setFullscreen",value:function(e){return this.data.fullscreen=e,e}},{key:"getLanguage",value:function(){return this.data.language}},{key:"getPreload",value:function(){return this.getValueOf("preload")}},{key:"setPreload",value:function(e){return this.data.preload=e,e}}],[{key:"NAME",get:function(){return J.NAME}}]),t}(J),ye=function(e){function t(){var n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return babelHelpers.classCallCheck(this,t),n=e.call(this)||this,n.data=i,Object.defineProperties(babelHelpers.assertThisInitialized(n),{kind:{get:n.getKind,enumerable:!0,configurable:!1},label:{get:n.getLabel,enumerable:!0,configurable:!1},language:{get:n.getLanguage,enumerable:!0,configurable:!1},id:{get:n.getId,enumerable:!0,configurable:!1},enabled:{get:n.getEnabled,set:n.setEnabled,enumerable:!0,configurable:!1}}),n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getKind",value:function(){return this.data.kind}},{key:"getLabel",value:function(){return this.data.label}},{key:"getLanguage",value:function(){return this.data.language}},{key:"getId",value:function(){return this.data.id}},{key:"setEnabled",value:function(e){e!==this.data.enabled&&(this.data.enabled=e,this.changeEnabled(e),this.dispatchEvent("change"))}},{key:"changeEnabled",value:function(e){}},{key:"getEnabled",value:function(){return this.data.enabled}},{key:"flatten",value:function(){return{kind:this.getKind(),label:this.getLabel(),language:this.getLanguage(),id:this.getId(),enabled:this.getEnabled()}}}]),t}(o),Ae={SHOWING:"showing",HIDDEN:"hidden",DISABLED:"disabled"},ve={VISIBILITY_CHANGE:"captioningvisibilitychange",ENABLED:"captioningenabled",TRACKS_LOADED:"captioningtracksloaded",TRACK_SELECTED:"captioningtrackselected",CHANGE_CUE:"captioningchangecue",CUE_CHANGE:"captioningcuechange",SETTINGS_VISIBILITY_CHANGE:"captioningsettingsvisibility",SETTINGS_CHANGE:"captioningsettingschange",TTML_CUE_CHANGE:"captioningttmlcuechange"},ge=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.startTime,i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};babelHelpers.classCallCheck(this,e),this.startTime=t,this.endTime=n,this.data=i,this.id=r,this.style=a}return babelHelpers.createClass(e,null,[{key:"create",value:function(t,n,i,r,a){return new e(t,n,i,r,a)}}]),e}(),me=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.apply(this,arguments)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"text",get:function(){return this.data.text},set:function(e){this.data.text=e}},{key:"html",get:function(){return this.data.html},set:function(e){this.data.html=e}},{key:"raw",get:function(){return this.data.raw}}],[{key:"create",value:function(e,n,i,r,a){return new t(e,n,i,r,a)}}]),t}(ge),be=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"createTextContent",value:function(e,t){var n=/[\&<>]/.test(t)?e.createCDATASection(t):e.createTextNode(t);return n}},{key:"updateTextContent",value:function(t,n){var i=e.createTextContent(t.ownerDocument,n);return t.removeChild(t.childNodes[0]),t.appendChild(i),t}},{key:"serialize",value:function(e){if(null!=e){if("string"==typeof e)return e;try{var t=new XMLSerializer;return t.serializeToString(e)}catch(e){}}}},{key:"parse",value:function(e){var t=new DOMParser;return t.parseFromString(e,"application/xml")}}]),e}(),ke=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"parse",value:function(e){var t,n,i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_e.create({kind:"captions",type:U.mimeTypes.ttml});return"string"==typeof e&&(e=be.parse(e)),i=Array.prototype.slice.call(e.querySelectorAll("styling style")),i.forEach(function(e,t,n){var i,a,s;s="",a=e.getAttribute("id")||e.getAttribute("xml:id"),i=Array.prototype.slice.call(e.attributes),i.forEach(function(e,t,n){if("tts"===e.prefix)return s+=U.toHyphenated(e.localName)+":"+e.nodeValue+";"}),r.styles[a]=s}),n=Array.prototype.slice.call(e.querySelectorAll("body [style]")),n.forEach(function(e,t,n){var i;i=e.getAttribute("style"),e.setAttribute("style",r.styles[i])}),t=Array.prototype.slice.call(e.querySelectorAll("body p[begin]")),t.forEach(function(e,n,i){var a,s,o,l,u,c,h;u=e.getAttribute("begin"),e.removeAttribute("begin"),null!=e.getAttribute("end")?(o=e.getAttribute("end"),e.removeAttribute("end")):null!=t[n+1]&&(o=t[n+1].getAttribute("begin")),a=e.getAttributeNS("http://www.w3.org/ns/ttml#styling","textAlign"),null!=a&&(c={align:"center"===a?"middle":a},e.removeAttributeNS("http://www.w3.org/ns/ttml#styling","textAlign")),h=be.serialize(e),h=h.replace(/\s*xmlns="[^"]*"/,""),l=h,h=h.replace(/^<p[^>]*>/,""),h=h.replace(/<\/p>$/,""),h=h.replace(/<br\/>/,"\n"),h=h.replace(/<span style="([^"]*)"/,"<c.$1"),h=h.replace(/<\/span>/,"</c>"),s=me.create(U.flattenTimecode(u),U.flattenTimecode(o),{text:h,html:l},"".concat(n),c),r.cues.push(s)}),r}}]),e}(),Ee=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_e.create({kind:"captions",type:U.mimeTypes.srt});e=e.replace(/\r/g,"");var n=e.split("\n\n");return _.each(n,function(e){var n=e.split("\n");try{var i=(n[0],n[1].match(/([0-9:\,]+)\s*-->\s*([0-9:\,]+)/).slice(1)),r=U.flattenTimecode(i[0]),a=U.flattenTimecode(i[1]),s=n.slice(2),o=me.create(r,a,{text:s.join("\n"),html:"<p>"+s.join("<br />")+"</p>"});t.cues.push(o)}catch(e){Y.instance.warn("SRT Parsing Warning")}}),t}}]),e}(),Te=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,[{key:"parseCaption",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.trim().split("\n"),a=/([0-9:\.]+)\s*-->\s*([0-9:\.]+)([^\n]*)/,s=/\s*([A-Za-z]+)\s*:\s*([\w\-\%]+)/g;try{a.test(r[0])||(n=r.shift());var o=r[0].match(a).slice(1),l=o[2],u=U.flattenTimecode(o[0]),c=U.flattenTimecode(o[1]),h=r.slice(1);null!=l&&l.replace(s,function(e,t,n){return i[t]=n,""});var d=e.createHTML(h),f=h.join("\n"),p=me.create(u,c,{text:f,html:d,raw:t},"".concat(n),i);return Object.assign(p,i),p}catch(e){Y.instance.error("WebVTT Parse Error",e)}}},{key:"parse",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_e.create({kind:"captions",type:U.mimeTypes.vtt});e=e.replace(/\r/g,"");var i=e.split("\n\n"),r=0;return i.forEach(function(e){if(!/^WEBVTT/.test(e)&&""!=e&&!/^NOTE/.test(e)&&!/^STYLE/.test(e)){var i=t.parseCaption(e,++r);n.cues.push(i)}}),n}}],[{key:"createHTML",value:function(e){return"string"==typeof e&&(e=e.split(/\n|\r/)),"<p>".concat(e.join("<br />"),"</p>")}}]),e}(),Ce={"application/ttml+xml":new ke,"application/x-subrip":new Ee,"text/vtt":new Te,undefined:new ke},Ne=function(e){function t(n){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return babelHelpers.classCallCheck(this,t),i=e.call(this,n)||this,i.cues=r,Object.defineProperties(babelHelpers.assertThisInitialized(i),{default:{get:i.getDefault,set:i.setDefault,enumerable:!0,configurable:!1}}),i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getDefault",value:function(){return!!this.data.default}},{key:"setDefault",value:function(e){e!==this.data.default&&(this.data.default=!!e)}},{key:"flatten",value:function(){var e=babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"flatten",this).call(this);return Object.assign({},e,{default:this.getDefault()})}},{key:"getCueAt",value:function(e){return this.cues.find(function(t){return t.startTime<=e&&t.endTime>=e})}}],[{key:"create",value:function(e){return new t(e)}}]),t}(ye),_e=function(e){function t(n,i){var r;babelHelpers.classCallCheck(this,t),r=e.call(this,{kind:n.kind,label:n.label,language:n.srclang,default:n.default})||this,r.src=n.src,r.type=n.type,r.cues=n.cues||[],r.styles=n.styles||{},r.activeCues=[],r.isLive=/^live/.test(r.type);var a=i;return r.src&&!r.isLive&&(a=function(){return U.request(r.src).then(function(e){try{Ce[r.type].parse(e.response,babelHelpers.assertThisInitialized(r))}catch(e){return r.dispatch("error","Could not parse caption track: ".concat(r.src)),void Y.instance.error("Could not parse caption track: ".concat(r.src))}"function"==typeof i&&i(babelHelpers.assertThisInitialized(r))}).catch(function(e){r.dispatch("error","Could not load caption track: ".concat(e,", ").concat(r.src)),Y.instance.error("Could not load caption track: ".concat(e,", ").concat(r.src))})}),null!=a&&Promise.resolve(babelHelpers.assertThisInitialized(r)).then(a),r}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,null,[{key:"create",value:function(e,n){return new t(e,n)}}]),t}(Ne),Pe=function(e){function t(n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,n)||this,i.enabled=!0,i.plugin=null,i.appState=null,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"value",get:function(){return this.getValue()}},{key:"getDefaults",value:function(){var e=babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getDefaults",this).call(this);return null==e.debug&&(e.debug=null),e}},{key:"getValue",value:function(e){var t=this.facade.player.evaluateBindings(this.config);return null!=e?t[e]:t}},{key:"initializeNotifier",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"initializeNotifier",this).call(this,e),this.appState=this.facade.player.appState}},{key:"getMediaElement",value:function(){return this.facade.player.getMediaElement()}},{key:"setEnabled",value:function(e){return this.enabled=e,e}},{key:"getEnabled",value:function(){return this.enabled}},{key:"getDebug",value:function(){return null!=this.value.debug?this.value.debug:this.facade.player.getConfig().debug===!0}},{key:"createPlugin",value:function(){}},{key:"initialize",value:function(){this.plugin=this.createPlugin()}},{key:"error",value:function(e){this.facade.logger.error("[AMP ".concat(this.facade.getModuleName().toUpperCase()," Error]"),e)}}],[{key:"NAME",get:function(){return J.NAME}}]),t}(J),Se=function(e){function t(n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this)||this,i.data={default:n.defaults.language,language:n.language,locales:[Q.locales]},i.defaults={},i.locale=null,i.localeId=null,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"initialize",value:function(e){var t=this;return null!=this.facade.config.locales&&this.addLocales(this.facade.config.locales,!1),e.forEach(function(e){null!=t.facade[e].locales&&t.addLocales(t.facade[e].locales,!1)}),this.compileLocale(this.data.default).then(function(e){return t.defaults=e,t.setLanguage(t.data.language)})}},{key:"getLanguage",value:function(){return this.data.language}},{key:"setLanguage",value:function(e){var t=this;return this.compileLocale(e).then(function(n){t.data.language=e,t.localeId=e.toLowerCase(),t.locale=t.facade.l10n=n,t.sendNotification(re.LANGUAGE_CHANGE,e)})}},{key:"compileLocale",value:function(e){var t=this;return new Promise(function(n,i){if(!e)return n({});var r=e.toLowerCase(),a=t.getLocaleIdShort(r),s=function(e){return e[r]||e[a]},o=function(e){return null!=e},l=function(e){return"string"!=typeof e?e:Tt.addResource({src:t.facade.evaluatePaths(e),type:U.mimeTypes.json}).then(function(e){return e.data}).catch(function(e){return{}})},u=_.transform(t.data.locales,_.filter(o),_.map(s),_.filter(o),_.map(l));Promise.all(u).then(function(e){return n(Object.assign.apply(Object,[{}].concat(babelHelpers.toConsumableArray(e))))})})}},{key:"getLocaleId",value:function(){return this.localeId}},{key:"getLocaleIdShort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.localeId;return(e||"").split("-").shift()}},{key:"getLocales",value:function(){return this.data.locales}},{key:"setLocales",value:function(e){return this.data.locales=e,e}},{key:"addLocales",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return null==e?Promise.resolve():(e instanceof Array||(e=[e]),e.forEach(function(e){if("object"===babelHelpers.typeof(e)){var n={};_.each(e,function(e,t){return n[t.toLowerCase()]=e}),t.data.locales.push(n)}}),n===!1?Promise.resolve():this.setLanguage(this.getLanguage()))}},{key:"getString",value:function(e,t){if(null!=e){if(!this.data.language)return e;try{var n=e.replace(/^MSG_/,""),i="MSG_".concat(n),r=this.defaults,a=this.locale||r;if(null==a)return e;var s=a[i]||a[n]||r[i]||r[n]||e;return s=this.facade.evaluateBindings(s,t)}catch(t){return e}}}},{key:"getLanguageString",value:function(e){if("string"!=typeof e||null==e||""===e)return"";var t="MSG_".concat(e.toUpperCase()),n=this.getString(t);return n===t&&(e=this.getLocaleIdShort(e),t="MSG_".concat(e.toUpperCase()),n=this.getString(t)),n}}],[{key:"NAME",get:function(){return"LocalizationProxy"}}]),t}(puremvc.Proxy),He={AUTO:"auto",HTML:"html",NATIVE:"native"},Me=/subtitles|captions|descriptions/i,Le=function(e){function t(n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,n)||this,i.providers={},i.tracks=[],i.rendererMap=[],i.track={},i.defaults={renderer:He.AUTO,crossorigin:null},i.enabled=!1,i.hidden=!0,i.captions=null,i.loaded=!0,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onRegister",value:function(){this.renderer=this.getValue("renderer")||He.AUTO}},{key:"getCrossOrigin",value:function(){return this.getValue("crossorigin")}},{key:"getTracks",value:function(){return this.tracks}},{key:"setTracks",value:function(e){var t=this;if(this.tracks=[],this.track=null,e=this.facade.player.evaluateBindings(e),null!=e){var n,i=function(){return t.tracks},r=0,a=function(){var e=i();r++,r===e.length&&(t.sendNotification(ve.TRACKS_LOADED,e),t.autoSelectTrack())};return e.forEach(function(e){if(Me.test(e.kind)&&e.srclang){var i=_e.create(e,a);i.once("error",function(e){return t.facade.dispatch(z.TRACK_ERROR,e.data)}),t.tracks.push(i),i.default&&(n=i)}}),null==n&&this.tracks.length&&(this.tracks[0].default=!0),e}}},{key:"registerRenderer",value:function(e){null!=e&&(e.proxy=this,this.rendererMap.push(e))}},{key:"retrieveRenderer",value:function(e){return this.rendererMap.find(function(t){return t.getRendererName()===e})}},{key:"removeRenderer",value:function(e){var t=this.retrieveRenderer(e);if(t.proxy=null,null==t)return null;var n=this.rendererMap.indexOf(t);return this.rendererMap.splice(n,1),t}},{key:"getRenderer",value:function(){return this.renderer}},{key:"setRenderer",value:function(e){return e===this.renderer?e:(this.renderer=e,this.selectRenderer(this.facade.player.media),e)}},{key:"getCurrentRenderer",value:function(){var e=this.facade.retrieveMediator(t.TEXT_TRACK_RENDERER);return e&&e.getRendererName()}},{key:"selectRenderer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.track||this.tracks;if(null!=n){var i=this.renderer;if(this.rendererMap.map(function(e){return e.getRendererName()}).includes(i)||(i=He.AUTO),i===He.AUTO&&(i=_.find(this.rendererMap,_.filter(function(e){return n.some(function(t){return e.canUseResource(t)})}),_.map(function(e){return e.getRendererName()}))),this.getCurrentRenderer()!==i){this.facade.removeMediator(t.TEXT_TRACK_RENDERER);var r=this.retrieveRenderer(i);null!=r&&this.facade.registerMediator(r)}}}},{key:"getTrack",value:function(){return this.track}},{key:"setTrack",value:function(e){return this.track=e,this.captions=this.track.cues,this.track.enabled=!0,this.sendNotification(re.CHANGE_SETTINGS,{captions:{track:this.track.flatten()}}),this.sendNotification(ve.TRACK_SELECTED,this.track),e}},{key:"selectTrackByIndex",value:function(e){var t=null;return e>=0&&e<this.tracks.length&&(t=this.tracks[e],this.setTrack(t)),t}},{key:"selectTrackByLanguage",value:function(e){var t=this.tracks.find(function(t){return t.language===e});return null!=t&&this.setTrack(t),t}},{key:"getHidden",value:function(){return this.hidden}},{key:"setHidden",value:function(e){return this.hidden=e,e}},{key:"getEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(e){return this.enabled=e,e}},{key:"autoSelectTrack",value:function(){var e=null,t=this.facade.player.retrieveProxy(Se.NAME).getLanguage();return null!=t&&(t=t.split("-").shift(),e=this.selectTrackByLanguage(t)),null==e&&(e=this.tracks[0],this.setTrack(e)),e}},{key:"getTextTracks",value:function(){return Array.from(this.facade.player.getMediaElement().textTracks)}},{key:"getTextTrack",value:function(){var e=this.getTrack();if(e){var t=e.kind,n=function(e){return Me.test(e.kind)&&(U.compareLanguageTags(e.language,r)||!e.language.length)},i=function(e,n){var i=0;return e.kind===t&&n.kind!==t&&i++,e.kind!==t&&n.kind===t&&i--,U.compareLanguageTags(e.language,r)&&!U.compareLanguageTags(n.language,r)&&i++,!U.compareLanguageTags(e.language,r)&&U.compareLanguageTags(n.language,r)&&i--,e.mode!==Ae.SHOWING&&i--,i},r=e.language;null!=r&&(r=r.split("-").shift());var a=this.getTextTracks().filter(n).sort(i);return a[a.length-1]}}}],[{key:"NAME",get:function(){return J.NAME}},{key:"TEXT_TRACK_RENDERER",get:function(){return"caption-text"}}]),t}(Pe),Ie=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this,t.NAME)||this,n.data={core:null,muted:!1,started:!1,volume:1,currentTime:0,duration:0,src:null,ended:!1,paused:!0,seeking:!1,loading:!1,waiting:!1,keyErrored:!1},n.initialized=!1,"desktop"===U.getDevice()&&(n.initialized=!0),n.handlers={timeupdate:n.ontimeupdate.bind(babelHelpers.assertThisInitialized(n)),durationchange:n.ondurationchange.bind(babelHelpers.assertThisInitialized(n)),play:n.onplay.bind(babelHelpers.assertThisInitialized(n)),playing:n.onplaying.bind(babelHelpers.assertThisInitialized(n)),pause:n.onpause.bind(babelHelpers.assertThisInitialized(n)),loadeddata:n.onloadeddata.bind(babelHelpers.assertThisInitialized(n)),waiting:n.onwaiting.bind(babelHelpers.assertThisInitialized(n)),seeking:n.onseeking.bind(babelHelpers.assertThisInitialized(n)),seeked:n.onseeked.bind(babelHelpers.assertThisInitialized(n)),ended:n.onended.bind(babelHelpers.assertThisInitialized(n)),progress:n.onprogress.bind(babelHelpers.assertThisInitialized(n)),error:n.onerror.bind(babelHelpers.assertThisInitialized(n)),loadstart:n.onloadstart.bind(babelHelpers.assertThisInitialized(n)),canplay:n.oncanplay.bind(babelHelpers.assertThisInitialized(n)),canplaythrough:n.oncanplaythrough.bind(babelHelpers.assertThisInitialized(n)),loadedmetadata:n.onloadedmetadata.bind(babelHelpers.assertThisInitialized(n)),stalled:n.onstalled.bind(babelHelpers.assertThisInitialized(n))},n.resume={event:U.getIEVersion()===-1||11===U.getIEVersion()?"loadedmetadata":"canplaythrough",listener:n.resumestart.bind(babelHelpers.assertThisInitialized(n))},n.textTrackHandlers={addtrack:n.onaddtrack.bind(babelHelpers.assertThisInitialized(n))},n.onneedkey=n.onneedkey.bind(babelHelpers.assertThisInitialized(n)),n.enabled=null,n.playWhenLoaded=!1,n.metadataloaded=!1,n.activeCuesIndex=0,n.id3CueType=null,n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(e){if(e!==this.enabled)return this.enabled=e,this.enabled===!0?this.init():this.applyHandlers(!1),e}},{key:"applyHandlers",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.getMediaElement(),n=e?"addEventListener":"removeEventListener";_.each(this.handlers,function(e,i){t[n](i,e)})}},{key:"resumestart",value:function(e){var t=this;this.getMediaElement(),this.handlers.durationchange(e),this.data.currentTime>0&&this.data.ended!==!0?this.facade.timers.setTimeout(function(){t.seek(t.data.currentTime).then(t.resumecomplete.bind(t))},50):this.resumecomplete()}},{key:"resumecomplete",value:function(){this.data.loading=!1,this.applyHandlers(!0),this.playWhenLoaded===!0&&this.facade.timers.setTimeout(this.play.bind(this),1)}},{key:"onaddtrack",value:function(e){var t=this,n=e.track;null==this.facade.captioning&&Me.test(n.kind)&&(n.mode=Ae.HIDDEN),"metadata"===n.kind&&(n.mode=Ae.HIDDEN,n.addEventListener("cuechange",function(e){_.each(e.target.activeCues,function(e,n,i){i[n-1]!==e&&t.sendNotification(re.TIMED_METADATA,e)})}))}},{key:"ontimeupdate",value:function(e){var t=e.target.currentTime;this.facade.ads.inProgress!==!0&&(this.data.currentTime=t,this.sendNotification(re.TIME_CHANGE,{currentTime:t}))}},{key:"ondurationchange",value:function(e){var t=e.target.duration;t&&(this.data.duration=t,/Android [4-7]/.test(navigator.userAgent)&&this.getMediaElement().src.indexOf(".m3u8")!==-1&&Infinity===t||this.sendNotification(re.CHANGE_DURATION,t))}},{key:"onplay",value:function(e){this.data.paused=!1}},{key:"onplaying",value:function(e){this.data.paused=!1,this.data.seeking=!1,this.data.waiting=!1,this.sendNotification(re.PLAYING)}},{key:"onpause",value:function(e){this.getMediaElement().ended!==!0&&this.facade.playState!==ue.READY&&(this.data.waiting===!0&&"hls"===this.playbackCoreName||(this.data.paused=!0,e.target.readyState>0&&(this.sendNotification(re.PAUSED),this.sendNotification(re.CHANGE_PLAY_STATE,ue.PAUSED))))}},{key:"onloadeddata",value:function(e){this.sendNotification(re.LOADED_DATA)}},{key:"onwaiting",value:function(e){this.data.waiting=!0,this.sendNotification(re.WAITING);var t=this.getMediaElement();t.seeking===!1&&2===t.readyState&&2===t.networkState&&(t.once("playing",this.sendNotification.bind(this,re.BUFFERING_CHANGE,!1)),this.sendNotification(re.BUFFERING_CHANGE,!0))}},{key:"onstalled",value:function(e){this.sendNotification(re.STALLED)}},{key:"onseeking",value:function(e){this.getMediaElement().removeEventListener("timeupdate",this.handlers.timeupdate);var t=e.target.currentTime;this.sendNotification(re.TIME_CHANGE,{currentTime:t}),this.data.seeking=!0,this.sendNotification(re.SEEKING)}},{key:"onseeked",value:function(e){this.data.seeking=!1,this.sendNotification(re.SEEK_COMPLETE,e.target.currentTime),this.getMediaElement().addEventListener("timeupdate",this.handlers.timeupdate)}},{key:"onended",value:function(e){this.data.ended=!0,this.sendNotification(re.ENDED)}},{key:"onprogress",value:function(e){try{var t=this.getMediaElement(),n=t.buffered;this.sendNotification(re.PROGRESS,n.end(n.length-1)/t.duration)}catch(e){}}},{key:"onerror",value:function(e){var t=this.getMediaElement().error;this.sendNotification(re.ERROR,this.facade.createMediaError(t.code,t))}},{key:"onloadstart",value:function(e){this.sendNotification(re.LOAD_START)}},{key:"oncanplay",value:function(e){this.sendNotification(re.CAN_PLAY)}},{key:"oncanplaythrough",value:function(e){this.createTracks(),this.sendNotification(re.CAN_PLAY_THROUGH),this.sendNotification(re.PROGRESS,this.getDuration())}},{key:"onloadedmetadata",value:function(e){this.metadataloaded=!0,this.sendNotification(re.ENABLE_FULL_SCREEN),this.sendNotification(re.LOADED_METADATA);
}},{key:"applyTextTrackHandlers",value:function(e){var t=e===!0?"addEventListener":"removeEventListener",n=this.getMediaElement().textTracks;null!=n&&n[t]("addtrack",this.textTrackHandlers.addtrack)}},{key:"createTracks",value:function(){function e(e){var t=this.facade.tracks.getAudioTracks();t.some(function(t){t.data.enabled=t.id==e.id})}var t=this,n=this.getMediaElement().audioTracks,i=this.facade.tracks.getAudioTracks();if(null!=n){var r=n.length||0;_.each(n,function(n,a){if(U.fieldIsUnique(i,"id",n.id)!==!1){var s=new ye(n);s.changeEnabled=e.bind(t,s),i.add(s,a+1===r)}})}}},{key:"reset",value:function(){this.data.currentTime=0,this.data.duration=0,this.data.src=null,this.data.ended=!1,this.data.paused=!1,this.data.seeking=!1,this.data.started=!1,this.data.loading=!1,this.applyTextTrackHandlers(!1)}},{key:"getStarted",value:function(){return this.data.started}},{key:"getMediaElement",value:function(){return this.facade.getMediaElement()}},{key:"canPlayMedium",value:function(e){return"video"===e}},{key:"canPlayTemporalType",value:function(e){return"dvr"!==e}},{key:"canPlayType",value:function(e){var t=document.createElement("video").canPlayType(e)||"";return(/Android (4\.[1-9]|[5-6])/.test(navigator.userAgent)||/Silk\/3/.test(navigator.userAgent))&&e===U.mimeTypes.m3u8&&(t="maybe"),"probably"===t&&/video\/f4m|x-flv/.test(e)&&/UCBrowser/.test(navigator.userAgent)&&(t=""),t}},{key:"getPaused",value:function(){return this.data.paused}},{key:"getSeeking",value:function(){return this.data.seeking}},{key:"getCurrentTime",value:function(){return this.data.currentTime}},{key:"setCurrentTime",value:function(e){if(e!==this.data.currentTime)return this.data.currentTime=e,this.getStarted()&&this.seek(e),e}},{key:"getCurrentTimeUTC",value:function(){var e=this.facade.retrieveProxy(pe.NAME),t=e.getValueOf("startDate"),n=0;return null!=t&&(n=Math.round(t+1e3*this.getCurrentTime())),n}},{key:"toUTC",value:function(e){if(!isFinite(e))return e;var t=this.getCurrentTimeUTC();if(0===t)return e;var n=this.getCurrentTime(),i=Math.round(1e3*(e-n));return t+i}},{key:"fromUTC",value:function(e){if(!isFinite(e))return e;var t=this.getCurrentTimeUTC();if(0===t)return e;var n=this.getCurrentTime(),i=(e-t)/1e3;return n+i}},{key:"seek",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.data.currentTime;return new Promise(function(n,i){try{var r=e.getMediaElement(),a=function(){e.facade.timers.setTimeout(n,10,t)};r.once("seeked",a),r.currentTime=t;var s=navigator.userAgent;if(/Android.*Chrome/.test(s))var o=e.facade.timers.setInterval(function(){Math.round(r.currentTime)===Math.round(t)&&(e.facade.timers.clearInterval(o),r.dispatchEvent(new CustomEvent("seeked")))},10)}catch(e){i(e)}})}},{key:"goLive",value:function(){var e=this.getMediaElement(),t=Infinity===e.duration?e.seekable.end(0):e.duration;e.currentTime=t}},{key:"getVolume",value:function(){var e=this.getMediaElement();return e.muted===!0?0:e.volume}},{key:"setVolume",value:function(e,t){return this.getMuted()&&e>0?this.setMuted(!1,!1):this.getMuted()||0!==e||this.setMuted(!0,!1),this.sendNotification(re.VOLUME_CHANGE,this.getMediaElement().volume=e,t),e}},{key:"getMuted",value:function(){return this.data.muted}},{key:"setMuted",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;if(this.data.muted!==e){this.data.muted=e;var i=this.data.volume;return this.data.muted===!0&&(this.data.volume=this.getVolume(),i=0),this.getMediaElement().muted=e,t===!0&&(this.sendNotification(re.CHANGE_VOLUME,i),this.sendNotification(re.VOLUME_CHANGE,i,n)),this.sendNotification(re.MUTE_CHANGE,this.data.muted),e}}},{key:"getDuration",value:function(){return this.data.duration}},{key:"play",value:function(){var e=this;if(this.sendNotification(re.WAITING),this.data.started!==!0){if(this.data.started=!0,this.setEnabled(!0),this.playWhenLoaded=!0,this.metadataloaded===!1)return}else if(this.data.loading===!0)return void(this.playWhenLoaded=!0);this.getPaused()&&this.sendNotification(re.RESUME),Promise.resolve(this.getMediaElement().play()).catch(function(t){return F.value(!0).then(function(t){return e.sendNotification(re.REMOVE_APPLICATION_STATE,ue.WAITING),e.sendNotification(re.AUTOPLAY_BLOCKED,{threshold:t,policy:e.facade.autoplayPolicy})})})}},{key:"pause",value:function(){this.data.paused=!0,this.getMediaElement().pause()}},{key:"getSrc",value:function(){return this.facade.mediaProxy.getSrc()}},{key:"init",value:function(){this.data.loading=!0,this.playWhenLoaded=!1,this.metadataloaded=!1;var e=this.getMediaElement();this.resume.id=e.once(this.resume.event,this.resume.listener),e.addEventListener("loadedmetadata",this.handlers.loadedmetadata),e.addEventListener("durationchange",this.handlers.durationchange),e.addEventListener("canplaythrough",this.handlers.canplaythrough),e.addEventListener("webkitneedkey",this.onneedkey),e.addEventListener("error",this.handlers.error),this.applyTextTrackHandlers(!0),this.applySrc()}},{key:"preload",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.facade.getPreload();if(e!==W.NONE){var t=this.getMediaElement();t.preload=e,this.setEnabled(!0)}}},{key:"load",value:function(){var e=this.getMediaElement(),t=U.getIOSversion()||[];U.isIPad()&&t[0]<8?this.facade.timers.setTimeout(e.load.bind(e),100):e.load()}},{key:"unload",value:function(){}},{key:"applySrc",value:function(){var e=this.getSrc();if(null==e||""===e)return void this.sendNotification(re.ERROR,"The value of src is not supported: "+value);var t=this.getMediaElement();t.src=e;var n=t.muted;n===!0&&(this.data.muted=!0),this.load()}},{key:"setQuality",value:function(e){}},{key:"getQuality",value:function(){}},{key:"getQualityLevels",value:function(){return[]}},{key:"getQualityMode",value:function(){}},{key:"setQualityMode",value:function(e){}},{key:"setMaxQualityLevel",value:function(e){}},{key:"getMaxQualityLevel",value:function(){}},{key:"destroy",value:function(){this.applyHandlers(!1);var e=this.getMediaElement();e.removeEventListener(this.resume.event,e[this.resume.id]),e.removeEventListener("webkitneedkey",this.onneedkey),null!=e.textTracks&&e.textTracks.removeEventListener("addtrack",this.textTrackHandlers.addtrack)}},{key:"onneedkey",value:function(e){var t=this,n=e.target,i=U.getKeySystem(),r=this.facade.mediaProxy.getKeys()[H.FAIRPLAY],a=this.facade.fps,s=a.allowKeyErrorRetries===!1;if(null!=r&&i.indexOf(H.FAIRPLAY)!==-1){if(this.keyErrored&&s)return void this.getMediaElement().removeEventListener("webkitneedkey",this.onneedkey);var o=e.initData,l=a.extractContentId(o,r),u=a.extractServerUrl(o,r);a.requestCertificate(r).then(function(e){return a.concatInitDataIdAndCertificate(o,l,e)}).then(function(e){if(!WebKitMediaKeys.isTypeSupported(H.FAIRPLAY,"video/mp4"))throw"Key System not supported";if(null==n.webkitKeys&&n.webkitSetMediaKeys(new WebKitMediaKeys(H.FAIRPLAY)),null==n.webkitKeys)throw"Could not create MediaKeys";var s=n.webkitKeys.createSession("video/mp4",e);if(null==s)throw"Could not create key session";s.addEventListener("webkitkeymessage",function(e){a.requestLicense(e.message,l,u,r).then(function(e){s.update(e)}).catch(function(e){s.close(),t.keyErrored=!0,t.facade.logger.error("[AMP DRM] A key request error was encountered.",e)})}),s.addEventListener("webkitkeyadded",function(e){t.facade.logger.log("[AMP DRM] Decryption key was added to session.")}),s.addEventListener("webkitkeyerror",function(e){t.sendNotification(re.ERROR,{message:"A decryption key error was encountered for key system "+babelHelpers.toConsumableArray(i),detail:e}),s.close(),t.keyErrored=!0,t.facade.logger.log("[AMP DRM] A decryption key error was encountered.",e)})}).catch(function(e){t.facade.logger.error(e)})}}}],[{key:"NAME",get:function(){return"PlaybackProxy"}}]),t}(puremvc.Proxy),Re=function(e){function t(){var n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return babelHelpers.classCallCheck(this,t),n=e.call(this)||this,n.playbackCoreName="default",n.config=i,n.plugin=r,n.supportedTypes=null,null!=n.config.types&&(n.supportedTypes=n.config.types),n.temporalTypes=["vod","live","ondemand"],n.decryptionTypes=[H.FAIRPLAY,H.CLEARKEY],null==t._customLoaders&&(t._customLoaders=[]),n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"customLoaders",get:function(){return t.getCustomLoaders()}},{key:"renderer",value:function(){var e=this,t=this.playbackCoreName,n=function(t){return e.canPlayMedium(t.medium)===!0&&e.canPlayTemporalType(t.temporalType)===!0&&""!==e.canPlayType(t.type)&&""!==e.canPlayDRM(t.keys)},i=function(t){return Promise.resolve(e)};return{id:t,canPlay:n,factory:i}}},{key:"onRegister",value:function(){this.mediaProxy=this.facade.retrieveProxy(Be.NAME)}},{key:"getPlaybackCoreName",value:function(){return this.playbackCoreName}},{key:"getSupportedTypes",value:function(){return this.supportedTypes||[]}},{key:"setSupportedTypes",value:function(e){return this.supportedTypes=e,e}},{key:"getTemporalTypes",value:function(){return this.temporalTypes||[]}},{key:"getDecryptionTypes",value:function(){return this.decryptionTypes||[]}},{key:"setTemporalTypes",value:function(e){return this.temporalTypes=e,e}},{key:"canPlayTemporalType",value:function(e){return this.getTemporalTypes().indexOf(e)!==-1}},{key:"canPlayType",value:function(e){return null!=this.supportedTypes?this.getSupportedTypes().indexOf(e)!==-1?"maybe":"":babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"canPlayType",this).call(this,e)}},{key:"canPlayDRM",value:function(e){var t=this.getDecryptionTypes(),n=U.getKeySystem()||[],i=function(e){return 0===_.transform(Object.keys(e),_.filter(function(t){return e.hasOwnProperty(t)})).length};return null==e||i(e)?"maybe":_.find(Object.keys(e),_.filter(function(e){return t.indexOf(e)!==-1}),_.filter(function(e){return n.indexOf(e)!==-1}),_.map(function(e){return e?"maybe":""}))||""}},{key:"registerCustomLoader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.playbackCoreName,n=arguments.length>2?arguments[2]:void 0;return this.customLoaders.push({loader:e,name:t,type:n})}},{key:"getActiveLoaders",value:function(){var e=this;return _.transform(this.customLoaders,_.filter(function(t){return t.name===e.playbackCoreName}))}},{key:"removeCustomLoader",value:function(e){if(e>-1)return this.customLoaders.splice(e,1)}}],[{key:"getCustomLoaders",value:function(){return t._customLoaders}}]),t}(Ie),Oe=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this)||this,n.playbackCoreName="dvr",n.interval=null,n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"ondurationchange",value:function(e){this.updateDuration()}},{key:"ontimeupdate",value:function(e){this.updateCurrentTime()}},{key:"onplay",value:function(e){this.stopTimer(),babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onplay",this).call(this,e)}},{key:"onplaying",value:function(e){this.stopTimer(),babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onplaying",this).call(this,e)}},{key:"onpause",value:function(e){this.startTimer(),babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onpause",this).call(this,e)}},{key:"canPlayTemporalType",value:function(e){return"dvr"===e}},{key:"getDuration",value:function(){var e=this.getMediaElement();return Infinity===e.duration&&this.updateDuration(),this.data.duration}},{key:"getStartTime",value:function(){return this.getMediaElement().seekable.start(0)}},{key:"getFragmentDuration",value:function(){var e=this.facade.retrieveProxy(pe.NAME),t=e.getValueOf("fragmentDuration");return t||10}},{key:"getLiveTime",value:function(){return this.getDuration()-this.getFragmentDuration()}},{key:"isLive",value:function(){return this.getStartTime()+this.getCurrentTime()>=this.getLiveTime()}},{key:"seek",value:function(e){var n=this;return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"seek",this).call(this,e+this.getStartTime()).then(function(e){n.sendNotification(re.IS_LIVE,n.isLive())})}},{key:"updateCurrentTime",value:function(){var e=this.getMediaElement().seekable;if(0!==e.length){var t=this.getMediaElement().currentTime;this.data.currentTime=t-e.start(0),this.sendNotification(re.TIME_CHANGE,{currentTime:this.data.currentTime}),this.mediaProxy.setIsLive(this.isLive())}}},{key:"updateDuration",value:function(){var e=this.getMediaElement().seekable;0!==e.length&&(this.data.duration=e.end(0)-e.start(0),this.sendNotification(re.CHANGE_DURATION,this.data.duration))}},{key:"startTimer",value:function(){this.interval=this.facade.timers.setInterval(this.updateCurrentTime.bind(this),1e3)}},{key:"stopTimer",value:function(){null!=this.interval&&(this.facade.timers.clearInterval(this.interval),this.interval=null,this.updateCurrentTime())}}]),t}(Re),De=function(){function e(t){babelHelpers.classCallCheck(this,e),this.element=t,this.prefix="amp-"}return babelHelpers.createClass(e,[{key:"contains",value:function(e){return this.constructor.contains(e,this.element,this.prefix)}},{key:"add",value:function(e){this.constructor.add(e,this.element,this.prefix)}},{key:"remove",value:function(e){this.constructor.remove(e,this.element,this.prefix)}},{key:"toggle",value:function(e){return this.constructor.contains(e,this.element,this.prefix)}}],[{key:"contains",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t.classList.contains(n+e)}},{key:"add",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";t.classList.add(n+e)}},{key:"remove",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";t.classList.remove(n+e)}},{key:"toggle",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";t.classList.toggle(n+e)}}]),e}(),we=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"create",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"div",i=arguments.length>3?arguments[3]:void 0;"string"==typeof n&&(n=document.createElement(n));var r=new De(n);if(null!=e&&("string"==typeof e&&(e=[e]),e.forEach(function(e){return r.add(e)})),n._classList=r,null!=i&&(n.textContent=i),null!=t){var a;null!=t.getViewComponent&&(a=t.getViewComponent()),null!=a&&(t=a),t.appendChild(n)}return n}},{key:"createElement",value:function(t,n,i){t&&"object"==babelHelpers.typeof(t)&&(n=t,i=t.children,t=t.type),t||(t="div"),n||(n={}),i||(i=[]);var r=document.createElement(t),a=["innerHTML","className"],s=["type","children"];return _.each(n,function(e,t){if(!s.includes(t)){if(a.includes(t))return r[t]=e;"style"===t&&e&&"object"===babelHelpers.typeof(e)&&(e=V.toCSS(e)),r.setAttribute(t,e)}}),i.forEach(function(t){var n=babelHelpers.typeof(t);if(null!=t){if("string"===n)t=document.createTextNode(t);else{if("object"!==n)return;if(t instanceof Array)return;t=e.createElement(t)}r.appendChild(t)}}),r}},{key:"bindEvents",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["onRemove","onRegister"];_.each(t,function(i,r){!n.includes(r)&&/^on/.test(r)&&i&&i.bind&&(e[r]=i.bind(t))})}}]),e}(),xe=function(e){function t(n,i){var r;return babelHelpers.classCallCheck(this,t),r=e.call(this,n,i)||this,r.mediatorName=n,r.config=null,r.classList=null,r}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"initializeNotifier",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"initializeNotifier",this).call(this,e);var n=this.facade.player||this.facade;this.config=n.retrieveProxy(J.NAME),this.classList=new De(this.viewComponent)}}]),t}(puremvc.Mediator),Ge=function(e){function t(n,i){var r;return babelHelpers.classCallCheck(this,t),r=e.call(this,n,i)||this,r.localizationManager=null,r}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"initializeNotifier",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"initializeNotifier",this).call(this,e);var n=this.facade.player||this.facade;this.localizationManager=n.retrieveProxy(Se.NAME)}}]),t}(xe),Ue=function(e){function t(n,i,r,a){var s;return babelHelpers.classCallCheck(this,t),s=e.call(this,n||U.createUID())||this,s.componentType=i,s.parent=r,s.element=a,s.componentName=null,null!=n&&(s.componentName=n),null==s.mediatorName&&(s.mediatorName=s.createMediatorName()),s.classList=null,s.state=null,s.disabled=!1,s}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onRegister",value:function(){null==this.viewComponent&&(this.viewComponent=this.createViewComponent(this.parent,this.element),this.classList=this.viewComponent._classList,we.bindEvents(this.viewComponent,this))}},{key:"createViewComponent",value:function(e,t){var n=this.getTypeList();return we.create(n,e,t)}},{key:"createMediatorName",value:function(){var e=this.getTypeList();return e.push("mediator"),e.push(U.createUID()),e.join("-")}},{key:"getTypeList",value:function(){var e=[];return null!=this.componentName&&e.push(this.componentName),null!=this.componentType&&(e=e.concat(this.componentType)),e}},{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return t===!1&&(t=null),we.create(e,t,n,i)}},{key:"createText",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,i=arguments.length>3?arguments[3]:void 0;return we.create(e,n,i,t)}},{key:"setState",value:function(e){if(e!==this.state)return null!=this.state&&this.classList.remove(this.state),this.state=e,null!=this.state&&this.classList.add(this.state),e}},{key:"getState",value:function(){return this.state}},{key:"setDisabled",value:function(e){if(e!==this.disabled)return this.disabled=e,this.disabled?this.classList.add("disabled"):this.classList.remove("disabled"),e}},{key:"getDisabled",value:function(){return this.disabled}}]),t}(Ge),Ve=function(e){function t(n,i){var r;return babelHelpers.classCallCheck(this,t),r=e.call(this,n,"media-element",null,i)||this,r.mediatorName="".concat(r.componentType,"-mediator"),r.created=!1,r}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onRegister",value:function(){this.created!==!0&&(this.created=!0,babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onRegister",this).call(this))}}]),t}(Ue),Ye=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this)||this,n.playbackCoreName="audio",n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onRegister",value:function(){var e=new Ve("html5","audio");this.sendNotification(re.PLAYBACK_CORE_CHANGE,e),babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onRegister",this).call(this)}},{key:"onRemove",value:function(){this.facade.createMediaElement()}},{key:"canPlayMedium",value:function(e){return"audio"===e}},{key:"canPlayType",value:function(e){return/audio/.test(e)?"maybe":/mpegURL/.test(e)&&(U.isIOS()||U.getSafariVersion()!==-1)?"maybe":""}}]),t}(Re),ze=function(e){function t(n,i){var r;if(babelHelpers.classCallCheck(this,t),r=e.call(this)||this,r.defaultPlaybackCore=n,r.activePlaybackCore=null,r.renderers=[],null==r.getPlaybackOrder){var a=function(e){var t=i.playbackOrder||[];return t.length>0?t:/Edge|Android/.test(navigator.userAgent)?["audio","hls","dash","dvr","default"]:void 0};r.getPlaybackOrder=i.getPlaybackOrder||a}return r.canPlay=r.canPlay.bind(babelHelpers.assertThisInitialized(r)),r}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onRegister",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onRegister",this).call(this),this.registerPlaybackCore(new Oe),this.registerPlaybackCore(this.defaultPlaybackCore),this.registerPlaybackCore(new Ye),this.activePlaybackCore=this.defaultPlaybackCore}},{key:"ready",value:function(){if("function"==typeof this.getPlaybackOrder){var e=this.getPlaybackOrder(this.renderers.map(function(e){return e.id}));null!=e&&(this.renderers=this.renderers.sort(function(t,n){return t=e.indexOf(t.id),n=e.indexOf(n.id),t===n?0:t===-1&&n!==-1?1:t!==-1&&n===-1?-1:t-n}))}}},{key:"getActivePlaybackCore",value:function(){return this.activePlaybackCore}},{key:"registerPlaybackCore",value:function(e){this.registerRenderer(e.renderer())}},{key:"registerRenderer",value:function(e){var t=e.id;null==this.renderers[t]&&(this.renderers.push(e),this.renderers[t]=e)}},{key:"retrieveRenderer",value:function(e){return this.renderers[e]}},{key:"retrieveRendererFor",value:function(e){var t=this,n=_.transform(this.renderers,_.filter(function(t){return t.canPlay(e)}),_.map(function(e){return e.factory}));return U.first(n,this.facade).then(function(e){return e===t.facade?null:e})}},{key:"removeRenderer",value:function(e){if(null!=this.renderers[e]){var t=this.renderers[e],n=this.renderers.indexOf(t);return this.renderers.splice(n,1),delete this.renderers[e],t}}},{key:"setPlaybackCore",value:function(e){var t=this;return this.retrieveRendererFor(e).then(function(e){if(null==e)throw t.facade.createMediaError(MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED);var n=t.facade.retrieveProxy(Ie.NAME);return n!==e?("function"==typeof n.destroy&&n.destroy(),t.facade.removeProxy(Ie.NAME),t.facade.registerProxy(e),e.setData(n.getData())):"function"==typeof n.unload&&n.unload(),t.activePlaybackCore=e,e})}},{key:"canPlay",value:function(e){return this.renderers.some(function(t){return t.canPlay(e)})}}],[{key:"NAME",get:function(){return"PlayerProxy"}}]),t}(puremvc.Proxy),Be=function(e){function t(n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this)||this,i.data={metadata:{}},i.applyDefaults=i.applyDefaults.bind(babelHelpers.assertThisInitialized(i)),i.started=!1,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getData",value:function(){var e=U.clone(babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getData",this).call(this));return null==e.authorization&&(e.authorization=U.clone(this.facade.security.data)),e}},{key:"setData",value:function(e){return null!=this.data&&this.facade.getCurrentTime()<this.facade.getDuration()&&this.sendNotification(re.MEDIA_SEQUENCE_ABORTED),this.started=!1,this.setAutoplay(e.autoplay),this.setType(e.type),this.setIsLive(e.isLive),this.setTemporalType(e.temporalType),null!=e.source&&this.setSource(e.source),null!=e.src&&this.setSrc(e.src),this.setTitle(e.title),this.setDuration(e.duration),this.setPoster(e.poster),this.setGUID(e.guid),this.setLink(e.link),this.setEmbed(e.embed),this.setWidth(e.width),this.setHeight(e.height),this.setCategory(e.category),this.setStartTime(e.startTime),this.setDescription(e.description),this.setStatus(e.status),this.setCategory(e.category),this.setMetadata(e.metadata),this.setAuthorization(e.authorization),this.setMedium(e.medium),this.setPubDate(e.pubDate),this.setTrack(e.track),this.setScenes(e.scenes),this.setKeys(e.keys),this.setCues(e.cues),this.setRestriction(e.restriction),this.data}},{key:"applyDefaults",value:function(e){null==e.medium&&(e.medium=/audio/.test(e.type)?"audio":"video"),null==e.temporalType&&(e.temporalType="vod"),e.isLive="live"===e.temporalType||"dvr"===e.temporalType;var t=e.source;if(null==e.src&&t){var n=this.facade.retrieveProxy(ze.NAME);if(null!=n){var i=U.selectSource(e,n.canPlay);i&&i.src&&(e.src=i.src,e.type=i.type)}}null==e.type&&(e.type=U.getMimeType(e.src));var r=e.scenes;return null!=r&&r.forEach(function(e,t){var n;e.start=isNaN(n=U.flattenTimecode(e.sceneStartTime))?0:n,e.end=isNaN(n=U.flattenTimecode(e.sceneEndTime))?0:n,e.title=e.sceneTitle||"",e.description=e.sceneDescription||"",e.position=t+1}),null==e.startTime&&(e.startTime=0),null==e.status&&(e.status={}),null==e.restriction&&(e.restriction=[]),null==e.track&&(e.track=[]),null==e.metadata&&(e.metadata={}),e.originalSrc=e.src,e}},{key:"updateData",value:function(e){var t=this;_.each(e,function(e,n){n in t.data&&(t.data[n]=e)})}},{key:"getGUID",value:function(){return this.data.guid}},{key:"setGUID",value:function(e){return this.data.guid=e}},{key:"getLink",value:function(){return this.data.link}},{key:"setLink",value:function(e){return this.data.link=e}},{key:"getStartTime",value:function(){return this.data.startTime}},{key:"setStartTime",value:function(e){return this.data.startTime=e}},{key:"getEmbed",value:function(){return this.data.embed}},{key:"setEmbed",value:function(e){return this.data.embed=e}},{key:"getAutoplay",value:function(){return this.data.autoplay}},{key:"setAutoplay",value:function(e){return this.data.autoplay=e}},{key:"getPubDate",value:function(){return this.data.pubDate}},{key:"setPubDate",value:function(e){return this.data.pubDate=e}},{key:"getCategory",value:function(){return this.data.category}},{key:"setCategory",value:function(e){return this.data.category=e}},{key:"getStatus",value:function(){return this.data.status}},{key:"setStatus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.data.status=e}},{key:"getSrc",value:function(){return this.facade.security.createURL(this.data.src)}},{key:"setSrc",value:function(e){return this.data.src=e}},{key:"getType",value:function(){return this.data.type}},{key:"setType",value:function(e){return this.data.type=e}},{key:"getMedium",value:function(){return this.data.medium}},{key:"setMedium",value:function(e){if(e!==this.data.medium)return this.data.medium=e,this.facade.retrieveProxy(he.NAME).setMedium(e)}},{key:"getMetadata",value:function(){return this.data.metadata}},{key:"setMetadata",value:function(e){return this.data.metadata=e}},{key:"getSource",value:function(){return this.data.source}},{key:"setSource",value:function(e){return this.data.source=e}},{key:"getTrack",value:function(){return this.data.track}},{key:"setTrack",value:function(e){return this.data.track=e}},{key:"getTitle",value:function(){return this.data.title}},{key:"setTitle",value:function(e){return this.data.title=e}},{key:"getWidth",value:function(){return this.data.width}},{key:"setWidth",value:function(e){return this.data.width=e}},{key:"getHeight",value:function(){return this.data.height}},{key:"setHeight",value:function(e){return this.data.height=e}},{key:"getDescription",value:function(){return this.data.description}},{key:"setDescription",value:function(e){return this.data.description=e}},{key:"getDuration",value:function(e){return this.data.duration}},{key:"setDuration",value:function(e){if(e&&"live"!==this.data.temporalType){var t=navigator.userAgent;if(1!==e||!/Android/.test(t)||/Android.*Chrome/.test(t))return e!==this.data.duration&&(this.data.duration=e,this.sendNotification(re.TIME_CHANGE,{duration:e})),Infinity===e&&"dvr"!==this.data.temporalType&&this.setTemporalType("live"),e}}},{key:"getPoster",value:function(e){return this.data.poster}},{key:"setPoster",value:function(e){this.data.poster=e}},{key:"getIsLive",value:function(){return this.data.isLive}},{key:"setIsLive",value:function(e){if(e!==this.data.isLive)return this.data.isLive=e,this.sendNotification(re.IS_LIVE,e),e}},{key:"getTemporalType",value:function(){return this.data.temporalType||"vod"}},{key:"setTemporalType",value:function(e){if(e!==this.data.temporalType){var t=this.data.temporalType;this.data.temporalType=e,this.sendNotification(re.TEMPORAL_TYPE_CHANGE,{previous:t,value:e})}}},{key:"getScenes",value:function(){return this.data.scenes}},{key:"setScenes",value:function(e){return this.data.scenes=e}},{key:"getCues",value:function(){return this.data.cues}},{key:"setCues",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(this.data.cues!==e)return this.data.cues=e,this.sendNotification(re.CUES_CHANGE,e),e}},{key:"getScene",value:function(e){var t=this.data.scenes;if(null!=t)return t.find(function(t){return t.start<=e&&e<t.end})}},{key:"getKeys",value:function(){return this.data.keys}},{key:"setKeys",value:function(e){this.data.keys=e}},{key:"getAuthorization",value:function(){return this.data.authorization}},{key:"setAuthorization",value:function(e){this.data.authorization=e}},{key:"getRestriction",value:function(){return this.data.restriction}},{key:"setRestriction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.data.restriction=e}}],[{key:"NAME",get:function(){return"MediaProxy"}}]),t}(puremvc.Proxy),Fe=function(e){function t(){var n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return babelHelpers.classCallCheck(this,t),n=e.call(this)||this,n.list=i,n.onchange=null,n.handlers={change:n.changeHandler.bind(babelHelpers.assertThisInitialized(n))},n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"changeHandler",value:function(e){this.dispatchEvent(e)}},{key:"add",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.list.push(e),e.addEventListener("change",this.handlers.change),t===!0&&this.dispatch("addtrack",e)}},{key:"remove",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.list.indexOf(e);if(n!==-1)return this.list.splice(n,1),e.removeEventListener("change",this.handlers.change),t===!0&&this.dispatch("removetrack",e),e}},{key:"clear",value:function(){var e=this;0!==this.list.length&&(_.each(this.list,function(){e.remove(e.list[e.list.length-1],!1)}),this.dispatch("removetrack"))}},{key:"getTrackById",value:function(e){return this.list.find(function(t){return t.id===e})}},{key:"some",value:function(e){return this.list.some(e)}}]),t}(o),je=function(e){function t(n){return babelHelpers.classCallCheck(this,t),e.call(this,n)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"selectTrackByIndex",value:function(e){if(e>=0&&e<this.list.length)for(var t=0;t<this.list.length;t++)this.list[t].enabled=t==e}},{key:"selectTrackByLanguage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.list.filter(function(t){return t.language.toLowerCase()===e.toLowerCase()})[0],n=this.list.indexOf(t);this.selectTrackByIndex(n)}}]),t}(Fe),Ke=function(e){function t(n,i){var r;babelHelpers.classCallCheck(this,t);var a=Tt.getResourceManager(),s=function(){var e=document.createElement("a");e.href=r.src;var t=e.protocol+"//"+e.hostname,n=t+e.pathname.split("/").slice(0,-1).join("/")+"/";r.cues.forEach(function(e){var i=e.text.split("#"),r=babelHelpers.slicedToArray(i,2),s=r[0],o=r[1],l=s;/^(https?:)?\/\//.test(l)||(l=/^\//.test(l)?t+l:n+l);var u=o.split("="),c=u[0],h=u[1].split(","),d={background:"url("+l+") 0px 0px no-repeat"};return _.each(c,function(e,t){var n=h[t];switch(e){case"w":d.width=n+"px";break;case"h":d.height=n+"px";break;case"x":d.background=d.background.replace(") 0px",") -"+n+"px");break;case"y":d.background=d.background.replace("0px n","-"+n+"px n")}}),e.style=d,a.add({src:l,type:"image"})}),"function"==typeof i&&i(babelHelpers.assertThisInitialized(r))};return r=e.call(this,n,s)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,null,[{key:"create",value:function(e){return new Promise(function(n,i){var r;try{return new t(e,function(e){return n(e)})}catch(e){return r=e,i(r)}})}}]),t}(_e),We=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this,null,{})||this,n.data.audioTracks=new je,n.data.videoTracks=new Fe,n.data.textTracks=new Fe,n.data.previewTracks=new Fe,n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"clear",value:function(){this.data.audioTracks.clear(),this.data.videoTracks.clear(),this.data.textTracks.clear(),this.data.previewTracks.clear()}},{key:"setMedia",value:function(e){var t=this,n=e.track||[];n.forEach(function(e){"preview"!==e.kind&&"thumbnail"!==e.kind||t.getPreviewTracks().add(new Ke(e))})}},{key:"getAudioTracks",value:function(){return this.data.audioTracks}},{key:"getVideoTracks",value:function(){return this.data.videoTracks}},{key:"getTextTracks",
value:function(){return this.data.textTracks}},{key:"getPreviewTracks",value:function(){return this.data.previewTracks}}],[{key:"NAME",get:function(){return"TracksProxy"}}]),t}(puremvc.Proxy),qe=function(e){function t(n,i){var r;return babelHelpers.classCallCheck(this,t),r=e.call(this,n,"player",null,i)||this,r.layers=[],r.core=null,r.medium=null,r.ready=!1,r}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onRegister",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onRegister",this).call(this);var e=U.getDevice();null!=e&&this.classList.add(e),U.isTouchDevice()&&this.classList.add("touch")}},{key:"listNotificationInterests",value:function(){return[re.DISPLAY_STATE_CHANGE,re.ACTIVE_STATE_CHANGE,re.PLAY_STATE_CHANGE,re.ADD_APPLICATION_STATE,re.REMOVE_APPLICATION_STATE,re.MEDIUM_CHANGE,re.DURATION_CHANGE,re.TEMPORAL_TYPE_CHANGE,re.IS_LIVE,re.ADD_LAYER,re.REMOVE_LAYER,re.STARTUP]}},{key:"handleNotification",value:function(e){var t=e.getName(),n=e.getBody();switch(t){case re.ACTIVE_STATE_CHANGE:case re.PLAY_STATE_CHANGE:case re.DISPLAY_STATE_CHANGE:case re.MEDIUM_CHANGE:var i=n,r=i.value,a=i.previous;null!=a&&this.classList.contains(a)&&this.classList.remove(a),null!=r&&this.classList.add(r);break;case re.ADD_APPLICATION_STATE:if(null==n)return;this.classList.add(n);break;case re.REMOVE_APPLICATION_STATE:this.classList.remove(n);break;case re.TEMPORAL_TYPE_CHANGE:n.previous&&this.sendNotification(re.REMOVE_APPLICATION_STATE,n.previous),n.value&&this.sendNotification(re.ADD_APPLICATION_STATE,n.value);break;case re.IS_LIVE:n===!0?this.sendNotification(re.ADD_APPLICATION_STATE,"is-live"):this.sendNotification(re.REMOVE_APPLICATION_STATE,"is-live");break;case re.DURATION_CHANGE:n>3600?this.sendNotification(re.ADD_APPLICATION_STATE,"long-form"):this.sendNotification(re.REMOVE_APPLICATION_STATE,"long-form");break;case re.ADD_LAYER:this.addLayer(n);break;case re.REMOVE_LAYER:this.removeLayer(n);break;case re.STARTUP:this.initialize(),this.viewCreated()}}},{key:"initialize",value:function(){var e=this;this.ready=!0,this.layers.forEach(function(t){e.viewComponent.contains(t)||e.viewComponent.appendChild(t)})}},{key:"viewCreated",value:function(){this.sendNotification(re.VIEW_CREATED)}},{key:"addLayer",value:function(e){this.layers.push(e),this.ready&&this.viewComponent.appendChild(e)}},{key:"removeLayer",value:function(e){this.viewComponent.contains(e)&&this.viewComponent.removeChild(e);var t=this.layers.indexOf(e);t>=0&&this.layers.splice(t,1)}}]),t}(Ue),Qe=function(e){function t(n){return babelHelpers.classCallCheck(this,t),e.call(this,n,"layer")||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onRegister",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onRegister",this).call(this),this.registerLayer()}},{key:"onRemove",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onRemove",this).call(this),this.removeLayer()}},{key:"registerLayer",value:function(){this.sendNotification(re.ADD_LAYER,this.viewComponent)}},{key:"removeLayer",value:function(){this.sendNotification(re.REMOVE_LAYER,this.viewComponent)}}]),t}(Ue),Ze=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this,"overlays")||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"listNotificationInterests",value:function(){return[re.ADD_OVERLAY,re.REMOVE_OVERLAY]}},{key:"handleNotification",value:function(e){var t=e.getName(),n=e.getBody();switch(t){case re.ADD_OVERLAY:this.viewComponent.appendChild(n);break;case re.REMOVE_OVERLAY:this.viewComponent.removeChild(n)}}}]),t}(Qe),Xe=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this,"video")||this,n.mediator=null,n.mediaElement=null,n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"listNotificationInterests",value:function(){return[re.PLAYBACK_CORE_CHANGE]}},{key:"handleNotification",value:function(e){var t=e.getName(),n=e.getBody();switch(t){case re.PLAYBACK_CORE_CHANGE:null!=this.mediaElement&&this.viewComponent.removeChild(this.mediaElement),null!=this.mediator&&this.facade.removeMediator(this.mediator.getMediatorName());var i=n&&n.getViewComponent;i?(this.facade.registerMediator(n),this.mediator=n,this.mediaElement=this.mediator.getViewComponent()):(this.mediator=null,this.mediaElement=n),null!=this.mediaElement&&(this.facade.setMediaElement(this.mediaElement),this.viewComponent.appendChild(this.mediaElement))}}}]),t}(Qe),$e={BREAK_START:"adsbreakstart",BREAK_END:"adsbreakend",BREAK_SKIPPED:"adsbreakskipped",AD_CONTAINER_CREATED:"adscontainercreated",AD_LOADED:"adsloaded",AD_MANAGER_LOADED:"adsmanagerloaded",AD_STARTED:"adsstarted",AD_TIME_UPDATE:"adstimeupdate",AD_TIME_REMAINING:"adstimeremaining",AD_DURATION_CHANGE:"adsdurationchange",AD_ENDED:"adsended",AD_ERROR:"adserror",AD_PLAY:"adsplay",AD_PLAYING:"adsplaying",AD_PAUSE:"adspause",AD_PAUSED:"adspaused",AD_RESUME:"adsresume",AD_CLICKED:"adclicked",AD_COMPANION:"adscompanion",FIRST_QUARTILE:"adsfirstquartile",MIDPOINT:"adsmidpoint",THIRD_QUARTILE:"adsthirdquartile",COMPLETE:"adscomplete",CONCRETE:"adsconcrete",LOG:"adslog",REQUEST:"adsrequest",REQUEST_START:"adsrequeststart",REQUEST_COMPLETE:"adsrequestcomplete",RESPONSE:"adsresponse",SKIPPED:"adsskipped",IMPRESSION:"adsimpression"},Je=function(e){function t(n){return babelHelpers.classCallCheck(this,t),e.call(this,n,"overlay")||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onRegister",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onRegister",this).call(this),this.registerOverlay()}},{key:"onRemove",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onRemove",this).call(this),this.removeOverlay()}},{key:"registerOverlay",value:function(){this.sendNotification(re.ADD_OVERLAY,this.viewComponent)}},{key:"removeOverlay",value:function(){this.sendNotification(re.REMOVE_OVERLAY,this.viewComponent)}}]),t}(Ue),et=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this,"ads")||this,n._hidden=!0,n._container=null,n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onRegister",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onRegister",this).call(this),this.setContainer(this.viewComponent),this.sendNotification($e.AD_CONTAINER_CREATED,this.viewComponent)}},{key:"listNotificationInterests",value:function(){return[$e.BREAK_START,$e.BREAK_END]}},{key:"getHidden",value:function(){return this._hidden}},{key:"setHidden",value:function(e){return this._hidden=e,this._container&&(this._container.hidden=e),e}},{key:"getContainer",value:function(){return this._container}},{key:"setContainer",value:function(e){return this._container=e,this._container&&(this._container.hidden=this._hidden),e}},{key:"handleNotification",value:function(e){var t=e.body||{};switch(e.getName()){case $e.BREAK_START:this.setHidden(!1);break;case $e.BREAK_END:this.setHidden("overlay"!==t.type)}}}]),t}(Je),tt=function(e){function t(n,i){return babelHelpers.classCallCheck(this,t),e.call(this,n,i)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"playback",get:function(){return this.playerCore.getActivePlaybackCore()}},{key:"doAfter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.facade.player||this.facade;return new Promise(function(i,r){var a=function(){try{e(),i()}catch(e){n.logger.error(e),r(e)}};return n.timers.setTimeout(a,t)})}},{key:"initializeNotifier",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"initializeNotifier",this).call(this,e);var n=this.facade.player||this.facade;this.applicationState=n.appState,this.media=n.mediaProxy,this.config=n.configuration,this.logger=n.logger,this.bindings=n.bindings,this.params=n.params,this.playerCore=n.playerCore,this.security=n.security,this.tracks=n.tracks,this.localization=n.localization,this.player=n}},{key:"handleNotification",value:function(e){var t=e.getName();"function"==typeof this[t]&&this[t](e.getBody(),e)}}]),t}(puremvc.Mediator),nt=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this,t.NAME)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"listNotificationInterests",value:function(){return[re.START,re.PLAY,re.PAUSE,re.ENDED,re.TOGGLE_PLAY_PAUSE,re.CHANGE_DURATION]}},{key:"play",value:function(e){this.applicationState.getLocked()!==!0&&(e&&this.playback.initialized!==!0&&this.sendNotification(re.INITIALIZED),this.playback.initialized===!0&&(this.media.getSrc()||this.media.getSource())&&(this.playback.getStarted()||this.sendNotification(re.START),this.playback.play()))}},{key:"pause",value:function(){this.playback.pause(),this.sendNotification(re.CHANGE_ACTIVE_STATE,ce.ACTIVE)}},{key:"ended",value:function(){var e=this;this.applicationState.getEnded()||(this.applicationState.setEnded(!0),this.doAfter(function(){e.config.getLoop()===!0?e.sendNotification(re.REPLAY):e.applicationState.getHasPostContent()===!1&&e.sendNotification(re.MEDIA_SEQUENCE_ENDED)}))}},{key:"start",value:function(e){this.sendNotification(re.REQUEST_PLAY),this.sendNotification(re.STARTED,e)}},{key:"toggleplaypause",value:function(){var e;if(!this.applicationState.getSeeking()){switch(this.applicationState.getPlayState()){case ue.ENDED:e=re.REPLAY;break;case ue.PAUSED:case ue.READY:e=re.PLAY;break;case ue.PLAYING:e=re.PAUSE}this.applicationState.getWaiting()&&this.facade.getMediaElement().paused===!0&&(e=re.PLAY),this.sendNotification(e,!0)}}},{key:"changeduration",value:function(e){this.media.getDuration()!==e&&this.media.setDuration(e)}}],[{key:"NAME",get:function(){return"CoreController"}}]),t}(tt),it=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"track",value:function(e,t,n){var i=U.semver(n.version),r={url:"//amp.akamaized.net/amp.gif",query:{prod:i.build?i.build:"standard",prodver:i.version,platform:"web",os:bowser.osname,osver:bowser.osversion,browser:bowser.name,browserver:bowser.version,url:location.href,event:e,data:t,lic:n.pid}};return U.request(r).catch(function(e){return Y.instance.log(e)})}}]),e}(),rt=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this,t.NAME)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"listNotificationInterests",value:function(){return[re.STARTUP,re.ERROR,re.TRACK,re.DESTROY]}},{key:"startup",value:function(){var e=this;this.localization.initialize(this.facade.plugins).then(function(){var t=e.facade.config.volume;null!=t&&e.sendNotification(re.CHANGE_VOLUME,t),e.playerCore.ready(),e.facade.config.autoplay===!0&&e.sendNotification(re.ADD_APPLICATION_STATE,"autoplay"),e.sendNotification(re.CHANGE_DISPLAY_STATE,le.NORMAL),e.sendNotification(re.CHANGE_PLAY_STATE,ue.READY),e.sendNotification(re.CHANGE_ACTIVE_STATE,ce.ACTIVE),F.value().then(function(){e.facade.performance.ready=Date.now(),e.sendNotification(re.TRACK,s.create("create")),e.sendNotification(re.READY,e.facade),e.doAfter(function(){var t=e.facade.config.media;null!=t&&e.sendNotification(re.SET_MEDIA,t)},2)})}).catch(function(e){throw a.create(e)})}},{key:"error",value:function(e){var t=this,n=function(e){t.facade._error=e,t.playback.destroy();var n=t.playback.getMediaElement();Promise.resolve(n.pause()).catch(function(e){return e}),t.sendNotification(re.CHANGE_PLAY_STATE,ue.ERROR),t.facade.dispatch(z.ERROR,e),t.logger.error("[AMP ERROR]",e)};this.facade.transform(ie.ERROR,a.create(e)).then(function(e){null!=e&&n(e)}).catch(function(e){n(e)})}},{key:"track",value:function(e){it.track(e.type,e.data,this.facade)}},{key:"destroy",value:function(){var e=this,t=Object.keys(this.facade.getModules()),n=this.facade.plugins;n.forEach(function(n){if(!t.includes(n))try{var i=e.facade[n]||{};"function"==typeof i.destroy&&i.destroy()}catch(t){e.facade.logger.error(t)}})}}],[{key:"NAME",get:function(){return"PlayerController"}}]),t}(tt),at=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this,t.NAME)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"listNotificationInterests",value:function(){return[re.PLAYING,re.REQUEST_PLAY,re.PLAYBACK_TARGET_CHANGE,re.REGISTER_PLAYBACK_CORE,re.REPLAY,re.END,re.HAS_POST_CONTENT,re.LOCK,re.MEDIA_SEQUENCE_ENDED]}},{key:"requestplay",value:function(){this.media.started!==!0&&(this.media.started=!0,this.sendNotification(re.PLAY_REQUEST),this.sendNotification(re.WAITING),this.sendNotification(re.MEDIA_SEQUENCE_STARTED),this.sendNotification(re.TRACK,s.create("start")))}},{key:"end",value:function(){var e=this;if(!this.applicationState.getEnded()){if(this.facade.ads.getInProgress()){var t={player:this.player,transform:function(n){if(n>-1)return e.player.sendNotification(re.END),e.player.removeTransform(t),n}};return this.player.addTransform(ie.TIME,t),void this.facade.ads.terminateAllAds()}this.playback.setEnabled(!1),this.playback.pause(),this.playback.seek(this.playback.getDuration()).then(this.sendNotification.bind(this,re.ENDED))}}},{key:"replay",value:function(){if("function"==typeof this.playback.replay)return void this.playback.replay();var e=this.media.getData();e.metadata=Object.assign({},e.metadata,{config:{autoplay:!0}}),this.sendNotification(re.SET_MEDIA,e)}},{key:"registerplaybackcore",value:function(e){this.playerCore.registerPlaybackCore(e)}},{key:"playbacktargetchange",value:function(e){var t=e.value,n="amp"===t?re.REMOVE_APPLICATION_STATE:re.ADD_APPLICATION_STATE;this.sendNotification(n,"remote-playback")}},{key:"playing",value:function(){0===this.facade.getMediaElement().currentTime&&this.media.started===!1&&this.applicationState.getSeeking()===!1&&(this.media.started=!0,this.sendNotification(re.MEDIA_SEQUENCE_STARTED)),this.applicationState.getPlayState()!==ue.PLAYING&&this.sendNotification(re.CHANGE_PLAY_STATE,ue.PLAYING)}},{key:"haspostcontent",value:function(e){this.applicationState.setHasPostContent(e)}},{key:"lock",value:function(e){var t=e?re.ADD_APPLICATION_STATE:re.REMOVE_APPLICATION_STATE;this.sendNotification(t,"locked"),this.applicationState.setLocked(e)}},{key:"mediasequenceended",value:function(){this.config.getLoop()===!0?this.doAfter(this.sendNotification.bind(this,re.REPLAY)):(this.sendNotification(re.CHANGE_PLAY_STATE,ue.ENDED),this.sendNotification(re.CHANGE_ACTIVE_STATE,ce.ACTIVE))}}],[{key:"NAME",get:function(){return"PlaybackController"}}]),t}(tt),st={EXTERNAL:"external"},ot=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this,t.NAME)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"listNotificationInterests",value:function(){return[re.BUFFERING_CHANGE,re.WAITING,re.CHANGE_PLAY_STATE,re.TOGGLE_FULL_SCREEN,re.CHANGE_DISPLAY_STATE,re.CHANGE_ACTIVE_STATE,re.INITIALIZED]}},{key:"core",get:function(){return this.facade.getMediaElement()}},{key:"view",get:function(){return this.facade.getViewComponent()}},{key:"fullScreen",get:function(){return this.getFullScreen()}},{key:"getFullScreen",value:function(){return U.getFullScreenApi(this.view,this.core)}},{key:"pictureInPicture",get:function(){return this.getPictureInPicture()}},{key:"getPictureInPicture",value:function(){return U.getPictureInPictureApi(this.core)}},{key:"bufferingchange",value:function(e){this.applicationState.getBuffering()!==e&&this.applicationState.setBuffering(e)}},{key:"waiting",value:function(){this.applicationState.getWaiting()||this.applicationState.setWaiting(!0)}},{key:"changeplaystate",value:function(e){this.applicationState.setPlayState(e)}},{key:"changeactivestate",value:function(e){this.applicationState.setActiveState(e)}},{key:"initialized",value:function(){this.playback.initialized=!0}},{key:"changedisplaystate",value:function(e){var t=this,n=this.applicationState.getDisplayState();if(e!==n){var i=function(e){t.sendNotification(re.FULL_SCREEN_CHANGE,e===le.FULL_SCREEN)};if(this.applicationState.setDisplayState(e),this.config.getFullscreen().mode===st.EXTERNAL)return void i(e);switch(e){case le.PICTURE_IN_PICTURE:n===le.FULL_SCREEN&&this.exitFullScreen(),this.enterPictureInPicture();break;case le.FULL_SCREEN:n===le.PICTURE_IN_PICTURE&&this.exitPictureInPicture(),this.enterFullScreen();break;case le.NORMAL:n===le.PICTURE_IN_PICTURE&&this.exitPictureInPicture(),n===le.FULL_SCREEN&&this.exitFullScreen()}i(e)}}},{key:"togglefullscreen",value:function(){var e=this.applicationState.getDisplayState()===le.FULL_SCREEN?le.NORMAL:le.FULL_SCREEN;return this.sendNotification(re.CHANGE_DISPLAY_STATE,e)}},{key:"enterFullScreen",value:function(){var e=this,t=this.core,n=this.view,i=this.fullScreen,r=function(){var t=e.applicationState.getDisplayState();return t!==le.FULL_SCREEN?t:le.NORMAL};if(null!=i.event)null!=n.mozRequestfullScreen?document[i.event]=function(t){if(!document.mozFullScreen)return e.sendNotification(re.CHANGE_DISPLAY_STATE,r())}:document[i.event]=function(t){if(null==document[i.element])return e.sendNotification(re.CHANGE_DISPLAY_STATE,r())};else{var a=function(){return t.webkitDisplayingFullscreen!==!0?0!==t.readyState?void 0:e.sendNotification(re.CHANGE_DISPLAY_STATE,le.NORMAL):(e.facade.timers.clearInterval(e.interval),void(e.interval=e.facade.timers.setInterval(s,100)))},s=function(){t.webkitDisplayingFullscreen!==!0&&e.sendNotification(re.CHANGE_DISPLAY_STATE,r())};this.facade.timers.clearInterval(this.interval),this.interval=this.facade.timers.setInterval(a,100)}null!=i.error&&document.addEventListener(i.error,this.facade.logger.error.bind(this.facade.logger)),i.enter()}},{key:"exitFullScreen",value:function(){var e=this.core,t=this.fullScreen,n=t.element;null==t||null!=n&&null==document[n]||("function"==typeof t.exit&&t.exit(),e[t.event]=null,this.facade.timers.clearInterval(this.interval))}},{key:"enterPictureInPicture",value:function(){var e=this,t=this.core,n=this.pictureInPicture,i=function(){if(null==document[n.element]){var t=e.applicationState.getDisplayState(),i=t!==le.PICTURE_IN_PICTURE?t:le.NORMAL;return e.sendNotification(re.CHANGE_DISPLAY_STATE,i)}};0!==t.readyState&&U.isPictureInPictureSupported(t)&&(null!=t[n.event]?t[n.event]=i:t.once(n.eventName,i),n.enter())}},{key:"exitPictureInPicture",value:function(){var e=this.pictureInPicture;null!=document[e.element]&&e.exit()}}],[{key:"NAME",get:function(){return"StateController"}}]),t}(tt),lt=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this)||this,n.player=null,n.proxy=null,n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"initialize",value:function(e,n){this.player=n,this.logger=this.player.logger,babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"initialize",this).call(this,e,n)}},{key:"isAvailable",value:function(){return!0}},{key:"loadModuleResources",value:function(){return this.isAvailable()?babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"loadModuleResources",this).call(this):Promise.resolve()}},{key:"resourcesLoaded",value:function(){"function"==typeof this.oninitialized&&this.oninitialized(this)}},{key:"onRegister",value:function(){if(this.isAvailable()){this.createFramework();var e=this.retrieveProxy(Pe.NAME);e&&"function"==typeof e.initialize&&e.initialize()}this.performance.record("ready"),this.sendNotification(se.PLUGIN_REGISTERED,this)}},{key:"logEvent",value:function(e){if(this.ignoreEvents.test(e.type)!==!0){var t=this.player.getModuleName().toUpperCase()+" "+this.getModuleName().toUpperCase();null!=e.dispatcher&&(t+=" "+e.dispatcher),this.logger.log("[".concat(t," EVENT] ").concat(e.type),e)}}},{key:"listNotificationPublications",value:function(){var e=[re.ADD_LAYER,re.REMOVE_LAYER,re.ADD_OVERLAY,re.REMOVE_OVERLAY,re.ADD_APPLICATION_STATE,re.REMOVE_APPLICATION_STATE,re.PLAYBACK_CORE_CHANGE];return e.concat(Object.values(se))}}]),t}(ae),ut=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this,t.NAME)||this,n.plugins=[],n.registered=0,n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"listNotificationInterests",value:function(){return[se.REGISTER_PLUGINS,se.PLUGIN_REGISTERED,se.PLUGINS_INITIALIZED,re.DESTROY]}},{key:"handleNotification",value:function(e){var t=this,n=e.getName(),i=e.getBody();switch(n){case se.REGISTER_PLUGINS:var r=i;this.facade.plugins=[],_.each(Tt.plugins,function(e,n){if(n in r){var i=r[n];if(null!=i&&i.enabled!==!1){if(null==e)return void t.facade.logger.debug("[AMP] Plugin could not be found: ".concat(n));try{var a=new e;a.oninitialized=t.onplugininitialized.bind(t,n),a.onerror=t.onpluginerror.bind(t,n),t.plugins.push(a.initialize.bind(a,i,t.facade))}catch(e){return void t.facade.logger.error("[AMP] Plugin could not be created: ".concat(n,". ").concat(e))}}}}),r.plugins||{},_.each(r.plugins||{},function(e,n){if(null!=e&&e.enabled!==!1){var i=function(e,n,i,r,a){return t.facade.loadResources(n.resources).then(function(){var t=Tt.plugins[i];return null==t&&a("[AMP] Plugin could not be found: ".concat(i)),t(e,n,i)}).then(r).catch(a)};t.plugins.push(i.bind(null,t.facade,e,n,t.onpluginregistered.bind(t,n),t.onpluginerror.bind(t,n)))}}),this.plugins.forEach(function(e){return e()});break;case se.PLUGIN_REGISTERED:this.onpluginregistered(i.getModuleName(),i);break;case se.PLUGINS_INITIALIZED:this.sendNotification(re.STARTUP,this.facade.config);break;case re.DESTROY:_.each(this.facade.plugins,function(e){if(e.destroy)try{e.destroy()}catch(e){t.facade.logger.error(e)}})}}},{key:"initializedCheck",value:function(){this.registered===this.plugins.length&&this.sendNotification(se.PLUGINS_INITIALIZED,this.plugins)}},{key:"onplugininitialized",value:function(e,t){t.oninitialized=null,t.onerror=null,this.facade.registerModule(t)}},{key:"onpluginerror",value:function(e,t){this.registered++,this.facade.logger.error("[AMP] Plugin could not be registered: ".concat(e)),this.facade.logger.error(t),this.initializedCheck()}},{key:"onpluginregistered",value:function(e,t){if(null==this.facade[e]){this.registered++,this.facade.logger.debug("[AMP] Plugin registered: ".concat(e)),this.facade[e]=t,this.facade.plugins.push(e);var n=t.feature;null!=n&&(this.facade[n]=t),this.initializedCheck()}}}],[{key:"NAME",get:function(){return"PluginsController"}}]),t}(puremvc.Mediator),ct=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this,t.NAME)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"listNotificationInterests",value:function(){return[re.SET_MEDIA,re.CHANGE_MEDIA,re.MEDIA_VALIDATED,de.AUTHORIZED,re.RECORD_CONTENT_CHANGE]}},{key:"setmedia",value:function(e){var t=this;this.sendNotification(re.LOCK,!0),this.facade.busy=!0,this.applicationState.setBuffering(!1),this.applicationState.setEnded(!1),this.playback.setEnabled(!1),this.playback.pause(),null!=this.tracks&&this.tracks.clear(),this.sendNotification(re.HAS_POST_CONTENT,!1),this.sendNotification(re.CHANGE_PLAY_STATE,ue.READY),this.sendNotification(re.CHANGE_ACTIVE_STATE,ce.ACTIVE),e=this.media.applyDefaults(e),this.security.setMedia(e),this.facade.transform(ie.MEDIA,e).then(function(e){null!=e&&(e=t.media.applyDefaults(e),t.sendNotification(re.CHANGE_MEDIA,e))}).catch(function(e){t.sendNotification(re.ERROR,e)})}},{key:"changemedia",value:function(e){try{e=this.media.setData(e)}catch(e){return void this.sendNotification(re.ERROR,e.message)}e=this.media.getData(),null!=e.authorization&&this.security.setAuthorization(e.authorization),this.security.getAuthorized()?this.sendNotification(de.AUTHORIZED,this.security.getAuthorization()):this.sendNotification(de.AUTHORIZE,{media:e})}},{key:"mediavalidated",value:function(e){var t=this,n=this.facade.getMediaElement();this.sendNotification(re.MEDIA_CHANGE,e),this.playerCore.setPlaybackCore(e).then(function(i){if(t.sendNotification(re.LOCK,!1),t.facade.busy=!1,null==i&&(i=t.player.playback),i.reset(),i.setCurrentTime(e.startTime||0),"amp"!==t.applicationState.getPlaybackTarget())return void t.sendNotification(re.MEDIA_SEQUENCE_INITIALIZED,{media:e});t.tracks.setMedia(e);var r=t.facade.getAutoplay()&&t.applicationState.getLocked()===!1,a=t.config.getMuted(),s=t.config.getPlaysInline();if(t.applicationState.calculateAutoplay!==!1&&(t.applicationState.calculateAutoplay=!1,r===!0)){var o=t.facade.autoplayThreshold,l=t.facade.autoplayPolicy;if(o!==F.ALLOWED&&l!==B.NONE){var u=a===!0,c=s===!0,h=l.includes(B.MUTED),d=o===F.MUTED,f=o===F.MUTED_INLINE&&c,p=a!==!1,y=d||f;r=u&&y||h&&y&&p,r===!0?a=!0:t.sendNotification(re.AUTOPLAY_BLOCKED,{threshold:o,policy:l})}}if(null!=s&&(n.playsInline=s),null!=a&&t.playback.setMuted(a,!0,re.INTERNAL),t.sendNotification(re.MEDIA_SEQUENCE_INITIALIZED,{media:e,autoplay:r,muted:a===!0,playsinline:s===!0}),r===!0)t.doAfter(t.sendNotification.bind(t,re.PLAY,!0));else{var A=t.facade.getPreload()||W.NONE;A!==W.NONE&&t.playback.preload(A)}}).catch(function(e){t.sendNotification(re.ERROR,e)})}},{key:"authorized",value:function(){null==this.security.getSession()&&(this.security.setSession(U.createUID()),this.sendNotification(re.MEDIA_VALIDATED,this.media.getData()))}},{key:"recordcontentchange",value:function(e){this.media.updateData(e)}}],[{key:"NAME",get:function(){return"MediaController"}}]),t}(tt),ht=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this,t.NAME)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"listNotificationInterests",value:function(){return[re.TIMED_METADATA,re.TIME_CHANGE,re.SEEK,re.SEEKING,re.SEEK_COMPLETE,re.GO_LIVE]}},{key:"timedmetadata",value:function(e,t){var n={startTime:e.startTime,endTime:e.endTime,type:e.type,track:e.track,value:{key:e.value.key,data:e.value.data,info:e.value.info}},i=n.value;try{null==i.info&&("string"==typeof i.data?i.info=i.data:i.data instanceof ArrayBuffer&&(i.info=U.arrayBufferToString(i.data)))}catch(e){this.facade.logger.log("[AMP ERROR]: Could not parse timed metadata")}t.body=n}},{key:"timechange",value:function(e){var t=this;null!=e.currentTime&&this.facade.transform(ie.TIME,e.currentTime).then(function(e){return t.applicationState.setCurrentTime(e)}),null!=e.duration&&this.facade.transform(ie.TIME,e.duration).then(function(e){return t.applicationState.setDuration(e)})}},{key:"seek",value:function(e){var t=this;this.facade.transform(ie.SEEK,e).then(function(e){null!=e&&e!==t.playback.getCurrentTime()&&t.playback.metadataloaded!==!1&&(0===e&&t.media.getType()===U.mimeTypes.m3u8&&(e=.25),t.playback.getStarted()===!0&&t.sendNotification(re.WAITING),t.facade.getMediaElement(),t.playback.setCurrentTime(e),t.playback.getStarted()!==!0&&t.sendNotification(re.TIME_CHANGE,e))})}},{key:"seeking",value:function(){return this.applicationState.getSeeking()===!0?void this.applicationState.setSeekRequested(!0):(this.applicationState.getEnded()&&this.applicationState.setEnded(!1),0===this.facade.getMediaElement().currentTime&&(this.media.started=!1),void this.applicationState.setSeeking(!0))}},{key:"seekcomplete",value:function(e,t){var n=this;this.facade.timers.setTimeout(function(){if(n.applicationState.setSeeking(!1),n.applicationState.setSeekRequested(!1),n.sendNotification(re.SEEKED,e),n.applicationState.getPlayState()!==ue.READY&&"full-screen"===n.applicationState.displayState&&"ipad"===n.applicationState.device&&n.facade.retrieveProxy(Ie.NAME).getPaused()!==n.facade.getMediaElement().paused){var t=n.facade.getMediaElement().paused===!0?ue.PAUSED:ue.PLAYING;n.sendNotification(re.CHANGE_PLAY_STATE,t)}},1)}},{key:"golive",value:function(){"function"==typeof this.playback.goLive&&this.playback.goLive()}}],[{key:"NAME",get:function(){return"TimeController"}}]),t}(tt),dt=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this,t.NAME)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"listNotificationInterests",value:function(){return[re.VOLUME_CHANGE,re.CHANGE_VOLUME,re.CHANGE_MUTED,re.TOGGLE_MUTED]}},{key:"changevolume",value:function(e){e=U.clamp(e,0,1),this.playback.getVolume()!==e&&(this.playback.setVolume(e),0===e?this.sendNotification(re.ADD_APPLICATION_STATE,"muted"):this.sendNotification(re.REMOVE_APPLICATION_STATE,"muted"))}},{key:"volumechange",value:function(e){this.applicationState.setVolume(e)}},{key:"changemuted",value:function(e){this.playback.setMuted(e)}},{key:"togglemuted",value:function(){this.playback.setMuted(!this.playback.getMuted())}}],[{key:"NAME",get:function(){return"VolumeController"}}]),t}(tt),ft=function(){function e(t){babelHelpers.classCallCheck(this,e);var n=Object.assign({},e.defaults);n=U.override(n,t,!1),U.override(this,n,!1)}return babelHelpers.createClass(e,null,[{key:"create",value:function(t){return new e(t)}}]),e}();ft.defaults={version:"1.0.1",volume:1,captions:{presets:{fontFamily:{monospacedSerif:"'Courier New', Courier, 'Nimbus Mono L', 'Cutive Mono', monospace",proportionalSerif:"'Times New Roman', Times, Georgia, Cambria, 'PT Serif Caption', serif",monospacedSansSerif:"'Deja Vu Sans Mono', 'Lucida Console', Monaco, Consolas, 'PT Mono', monospace",proportionalSansSerif:"Roboto, 'Arial Unicode Ms', Arial, Helvetica, Verdana, 'PT Sans Caption', sans-serif",casual:"'Comic Sans MS', Impact, Handlee, fantasy",cursive:"'Monotype Corsiva', 'URW Chancery L', 'Apple Chancery', 'Dancing Script', cursive",smallCapitals:"'Arial Unicode Ms', Arial, Helvetica, Verdana, 'Marcellus SC', sans-serif; font-variant: small-caps"},fontSize:{smallest:"x-small",small:"small",medium:"medium",large:"large",largest:"x-large"},iosFontSize:{smallest:"62.5%",small:"83.333%",medium:"100%",large:"112.5%",largest:"150%"},edgeType:{none:"0px 0px 0px",depressed:"0px 1px 0px",leftShadow:"-3px 3px 2px",raised:"0px 1px 1px",rightShadow:"3px 3px 2px",uniform:"0px 0px 4px"},color:{white:"rgb(255, 255, 255)",yellow:"rgb(255, 255, 0)",green:"rgb(0, 128, 0)",cyan:"rgb(0, 255, 255)",blue:"rgb(0, 0, 255)",magenta:"rgb(255, 0, 255)",red:"rgb(255, 0, 0)",black:"rgb(0, 0, 0)"}},visible:!1,fontFamily:"monospacedSerif",fontSize:"medium",scroll:"popout",fontColor:"white",fontOpacity:"100%",edgeType:"rightShadow",edgeColor:"black",edgeOpacity:"75%",backgroundColor:"black",backgroundOpacity:"0%",windowColor:"black",windowOpacity:"50%",styles:{window:{backgroundColor:"rgba(0,0,0,0.5)"},text:{fontFamily:"Courier New, Courier, Nimbus Mono L, Cutive Mono, monospace",fontSize:"100%",color:"rgba(255,255,255,1)",textShadow:"2px 2px 3px rgba(0,0,0,0.75)",backgroundColor:"rgba(0,0,0,0)"}}}};var pt="akamai_amp",yt=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this,t.NAME)||this,n.namespace=t.NAMESPACE,n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onRegister",value:function(){var e=this.config.getSettings()||{};null!=e.namespace&&(this.namespace=pt=e.namespace),this.settings=ft.create(e.defaults);var t=Object.assign({},e);delete t.defaults,delete t.namespace;try{var n,i=localStorage.getItem(this.namespace);null!=i&&(n=U.override(JSON.parse(i),t)),this.save(n)}catch(e){}}},{key:"listNotificationInterests",value:function(){return[re.READY,re.VOLUME_CHANGE,re.CHANGE_SETTINGS,re.CHANGE_AUTOPLAY,re.CHANGE_LOOP,re.CHANGE_PRELOAD,re.CHANGE_CONTROLS,re.MEDIA_CHANGE]}},{key:"changesettings",value:function(e){this.change(e)}},{key:"changeautoplay",value:function(e){this.config.setAutoplay(e)}},{key:"changeloop",value:function(e){this.config.setLoop(e)}},{key:"changepreload",value:function(e){this.config.setPreload(e)}},{key:"changecontrols",value:function(e){this.config.setControls(e),this.updateControls()}},{key:"updateControls",value:function(){this.player.mediaElement.controls=this.config.getControls()}},{key:"mediachange",value:function(e){this.updateControls()}},{key:"ready",value:function(){var e=this.settings.volume;null!=e&&this.sendNotification(re.CHANGE_VOLUME,e)}},{key:"volumechange",value:function(e,t){this.settings.volume!==e&&"internal"!=t.getType()&&this.change({volume:e})}},{key:"computeStyles",value:function(e,t){
function n(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e[n];return t[n][i]||i}function i(t){var i=V.toColor(n("color",e[t+"Color"])),r=e[t+"Opacity"];return null!=r&&(i.a=V.fromPercent(r)),V.fromColor(i)}function r(){var t=n("fontSize");return U.isIOS()&&(t=V.toPercent(n("iosFontSize",e.fontSize))),t}return e=U.override(this.settings.captions,e),null==t&&(t=e.presets),{window:{backgroundColor:i("window")},text:{fontFamily:n("fontFamily"),fontSize:r(),color:i("font"),textShadow:n("edgeType")+" "+i("edge"),backgroundColor:i("background")}}}},{key:"change",value:function(e){if(!(null==e||"object"!==babelHelpers.typeof(e)||e instanceof Array)){var t=U.diff(this.settings,e);if(null!=t){var n=t.captions;null!=n&&(n.styles=U.override(this.computeStyles(n),n.styles)),this.save(t),this.sendNotification(re.SETTINGS_CHANGE,t)}}}},{key:"getSettings",value:function(){return Object.freeze(Object.assign({change:this.change.bind(this)},this.settings))}},{key:"save",value:function(e){this.settings=U.override(this.settings,e);try{localStorage.setItem(this.namespace,JSON.stringify(this.settings))}catch(e){}}}],[{key:"NAMESPACE",get:function(){return pt}},{key:"GET",value:function(){var e=localStorage.getItem(t.NAMESPACE);try{e=JSON.parse(e)}catch(t){e={}}return e||{}}},{key:"NAME",get:function(){return"SettingsController"}}]),t}(tt),At=function(e){function t(n,i){return babelHelpers.classCallCheck(this,t),e.call(this,t.NAME,i)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"dispatchEvent",value:function(e,t){this.facade.dispatch(e,t)}},{key:"listNotificationInterests",value:function(){return Object.values(z).concat(Object.values(de)).concat([re.ENABLE_VIDEO_EVENTS,re.DISABLE_VIDEO_EVENTS])}},{key:"handleNotification",value:function(e){var n=e.getName();null!=this[n]?babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"handleNotification",this).call(this,e):this.dispatchEvent(n,e.getBody())}},{key:"error",value:function(){}},{key:"enablevideoevents",value:function(e){var t=this,n=this.facade.getMediaElement();e.forEach(function(e){return n.addEventListener(e,t.playback.handlers[e])})}},{key:"disablevideoevents",value:function(e){var t=this,n=this.facade.getMediaElement();e.forEach(function(e){return n.removeEventListener(e,t.playback.handlers[e])})}}],[{key:"NAME",get:function(){return"EventController"}}]),t}(tt),vt=function(e){function t(n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,n)||this,i.ads=o.create(),i.ads.enabled=!1,i.ads.getEnabled=function(){return!1},i.ads.inprogress=!1,i.ads.getInProgress=function(){return!1},i.loadResources=i.loadModuleResources.bind(babelHelpers.assertThisInitialized(i)),i.presentationModeChanged=i.presentationModeChanged.bind(babelHelpers.assertThisInitialized(i)),i.moduleName="amp",i.l10n=null,i.appState=null,i.mediaProxy=null,i.bindings=null,i.configuration=null,i.security=null,i.playerCore=null,i.tracks=null,i.mediator=null,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"createModel",value:function(){this.appState=new he,this.registerProxy(this.appState),this.security=new fe,this.registerProxy(this.security),this.mediaProxy=new Be(this.config),this.registerProxy(this.mediaProxy),this.configuration=new pe(this.config),this.registerProxy(this.configuration),this.localization=new Se(this.config),this.registerProxy(this.localization);var e=new Re;this.registerProxy(e),this.playerCore=new ze(e,this.config),this.registerProxy(this.playerCore),this.tracks=new We,this.registerProxy(this.tracks),this.fps=U.override(oe,this.config.fps)}},{key:"createView",value:function(){this.mediator=new qe("html5",this.getViewComponent()),this.registerMediator(this.mediator),this.registerMediator(new Xe),this.registerMediator(new Ze),this.adMediator=new et,this.registerMediator(this.adMediator)}},{key:"createController",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"createController",this).call(this),this.registerMediator(new nt),this.registerMediator(new rt),this.registerMediator(new ot),this.registerMediator(new ut),this.registerMediator(new ct),this.registerMediator(new at),this.registerMediator(new ht),this.registerMediator(new dt),this.registerMediator(new At),this._settings=new yt,this.registerMediator(this._settings)}},{key:"dispatchEvent",value:function(e){e.player=this,babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"dispatchEvent",this).call(this,e)}},{key:"setViewComponent",value:function(e){return e.amp=this,babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"setViewComponent",this).call(this,e)}},{key:"getPlayer",value:function(){return this._player}},{key:"setPlayer",value:function(e){this._player=e}},{key:"player",get:function(){return this.getPlayer()},set:function(e){this.setPlayer(e)}},{key:"now",get:function(){return Date.now()}},{key:"paths",get:function(){return this.configuration.getPaths()}},{key:"timers",get:function(){return U.timerGroup(this.multitonKey)}},{key:"autoplayPolicy",get:function(){return this.configuration.getAutoplayPolicy()}},{key:"autoplayThreshold",get:function(){return F.threshold}},{key:"temporalType",get:function(){return this.mediaProxy.getTemporalType()}},{key:"isLive",get:function(){return this.mediaProxy.getIsLive()}},{key:"textTracks",get:function(){return this.getMediaElement().textTracks}},{key:"defaultMediaTransform",get:function(){return this.mediaProxy.applyDefaults}},{key:"getPID",value:function(){return Tt.LICENSE||this.config.pid}},{key:"pid",get:function(){return this.getPID()}},{key:"getVersion",value:function(){return Tt.getVersion()}},{key:"version",get:function(){return this.getVersion()}},{key:"getDebug",value:function(){return this.config.debug}},{key:"debug",get:function(){return this.getDebug()}},{key:"createPlugins",value:function(){this.sendNotification(se.REGISTER_PLUGINS,this.config)}},{key:"createMediaElement",value:function(){var e=this.getViewComponent()||{},t=("function"==typeof e.querySelector?e.querySelector("video"):null)||"video";this.mediator=new Ve("html5",t),this.sendNotification(re.PLAYBACK_CORE_CHANGE,this.mediator);var n=this.mediator.getViewComponent();return null==n.dataset&&(n.dataset={}),n}},{key:"createFramework",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"createFramework",this).call(this),this.setMediaElement(this.createMediaElement()),this.createPlugins()}},{key:"getLanguage",value:function(){return this.localization.getLanguage()}},{key:"language",get:function(){return this.getLanguage()},set:function(e){return this.setLanguage(e)}},{key:"setLanguage",value:function(e){return this.localization.setLanguage(e),e}},{key:"getLocalizedString",value:function(e,t){try{return this.localization.getString(e,t)}catch(t){return e}}},{key:"getMediaElement",value:function(){return this.appState.getMediaElement()}},{key:"mediaElement",get:function(){return this.getMediaElement()}},{key:"setMediaElement",value:function(e){var t=this.getMediaElement();return null!=t&&t.removeEventListener("webkitpresentationmodechanged",this.presentationModeChanged),e.addEventListener("webkitpresentationmodechanged",this.presentationModeChanged),this.appState.setMediaElement(e),null==e.once&&(e.once=function(e,t){var n=U.createUID(),i=function(e,t,n,i){this.removeEventListener(t,this[e]),delete this[e],n(i)};return this[n]=i.bind(this,n,e,t),this.addEventListener(e,this[n]),n},e.once=e.once.bind(e)),e.amp=this,e}},{key:"presentationModeChanged",value:function(e){"inline"===e.target.webkitPresentationMode&&(e.target.controls=this.getControls())}},{key:"setControls",value:function(e){return this.sendNotification(re.CHANGE_CONTROLS,e)}},{key:"controls",get:function(){return this.getControls()},set:function(e){return this.setControls(e)}},{key:"getControls",value:function(){return this.configuration.getControls()}},{key:"getContainer",value:function(){return this.getViewComponent()}},{key:"container",get:function(){return this.getContainer()}},{key:"getAdContainer",value:function(){return this.adMediator.getContainer()}},{key:"adContainer",get:function(){return this.getAdContainer()},set:function(e){return this.setAdContainer(e)}},{key:"setAdContainer",value:function(e){this.adMediator.setContainer(e)}},{key:"getPreviewTracks",value:function(){return this.tracks.getPreviewTracks()}},{key:"previewTracks",get:function(){return this.getPreviewTracks()}},{key:"getAudioTracks",value:function(){return this.tracks.getAudioTracks()}},{key:"audioTracks",get:function(){return this.getAudioTracks()}},{key:"evaluateBindings",value:function(e,t){return t=null!=t?Object.assign({},this,t):this,$.evaluateBindings(e,t)}},{key:"canPlayType",value:function(e){return this.retrieveProxy(Ie.NAME).canPlayType(e)}},{key:"load",value:function(){this.sendNotification(re.LOAD)}},{key:"play",value:function(){var e=this;return new Promise(function(t,n){var i=function(){e.removeEventListener(z.PLAYING,r),e.removeEventListener(z.AUTOPLAY_BLOCKED,a),e.removeEventListener(z.ERROR,a)},r=function(){i(),t()},a=function(){i(),n()};e.addEventListener(z.PLAYING,r),e.addEventListener(z.AUTOPLAY_BLOCKED,a),e.addEventListener(z.ERROR,a),e.sendNotification(re.PLAY,!0)})}},{key:"replay",value:function(){this.sendNotification(re.REPLAY)}},{key:"pause",value:function(){var e=this;return new Promise(function(t,n){return e.once(z.PAUSED,t),e.sendNotification(re.PAUSE)})}},{key:"seek",value:function(e){var t=this;return new Promise(function(n,i){return t.once(z.SEEKED,n),t.setCurrentTime(e)})}},{key:"end",value:function(){var e=this;return new Promise(function(t){return e.once(z.ENDED,t),e.sendNotification(re.END)})}},{key:"setAutoplay",value:function(e){return this.sendNotification(re.CHANGE_AUTOPLAY,e),e}},{key:"autoplay",get:function(){return this.getAutoplay()},set:function(e){return this.setAutoplay(e)}},{key:"getAutoplay",value:function(){return this.configuration.getAutoplay()}},{key:"setPreload",value:function(e){return this.sendNotification(re.CHANGE_PRELOAD,e),e}},{key:"preload",get:function(){return this.getPreload()},set:function(e){return this.setPreload(e)}},{key:"getPreload",value:function(){return this.configuration.getPreload()}},{key:"setLoop",value:function(e){return this.sendNotification(re.CHANGE_LOOP,e),e}},{key:"loop",get:function(){return this.getLoop()},set:function(e){return this.setLoop(e)}},{key:"getLoop",value:function(){return this.configuration.getLoop()}},{key:"setMuted",value:function(e){return this.sendNotification(re.CHANGE_MUTED,e),e}},{key:"muted",get:function(){return this.getMuted()},set:function(e){return this.setMuted(e)}},{key:"getMuted",value:function(){return this.retrieveProxy(Ie.NAME).getMuted()}},{key:"mute",value:function(){return this.setMuted(!0)}},{key:"unmute",value:function(){return this.setMuted(!1)}},{key:"setMedia",value:function(e){return this.sendNotification(re.SET_MEDIA,e),e}},{key:"media",get:function(){return this.getMedia()},set:function(e){return this.setMedia(e)}},{key:"getMedia",value:function(){return this.mediaProxy.getData()}},{key:"setCurrentTime",value:function(e){return this.sendNotification(re.SEEK,e),e}},{key:"currentTime",get:function(){return this.getCurrentTime()},set:function(e){return this.setCurrentTime(e)}},{key:"getCurrentTime",value:function(){return this.appState.getCurrentTime()}},{key:"setAbsoluteCurrentTime",value:function(e){return this.sendNotification(re.SEEK,e),e}},{key:"absoluteCurrentTime",get:function(){return this.getAbsoluteCurrentTime()},set:function(e){return this.setAbsoluteCurrentTime(e)}},{key:"getAbsoluteCurrentTime",value:function(){return this.retrieveProxy(Ie.NAME).getCurrentTime()}},{key:"toUTC",value:function(e){return this.retrieveProxy(Ie.NAME).toUTC(e)}},{key:"fromUTC",value:function(e){return this.retrieveProxy(Ie.NAME).fromUTC(e)}},{key:"getDuration",value:function(){return this.appState.getDuration()}},{key:"duration",get:function(){return this.getDuration()}},{key:"getAbsoluteDuration",value:function(){return this.mediaProxy.getDuration()}},{key:"absoluteDuration",get:function(){return this.getAbsoluteDuration()}},{key:"setSrc",value:function(e){return this.sendNotification(re.SET_MEDIA,{src:e}),e}},{key:"src",get:function(){return this.getSrc()},set:function(e){return this.setSrc(e)}},{key:"getSrc",value:function(){return this.mediaProxy.getSrc()}},{key:"setSource",value:function(e){return this.sendNotification(re.SET_MEDIA,{source:e}),e}},{key:"getSource",value:function(){return this.mediaProxy.getSource()}},{key:"setVolume",value:function(e){return this.sendNotification(re.CHANGE_VOLUME,e),e}},{key:"volume",get:function(){return this.getVolume()},set:function(e){return this.setVolume(e)}},{key:"getVolume",value:function(){return this.retrieveProxy(Ie.NAME).getVolume()}},{key:"getSeeking",value:function(){return this.retrieveProxy(Ie.NAME).getSeeking()}},{key:"seeking",get:function(){return this.getSeeking()}},{key:"getPaused",value:function(){return this.retrieveProxy(Ie.NAME).getPaused()}},{key:"paused",get:function(){return this.getPaused()}},{key:"getEnded",value:function(){return this.appState.getEnded()}},{key:"ended",get:function(){return this.getEnded()}},{key:"getBuffering",value:function(){return this.appState.getBuffering()}},{key:"buffering",get:function(){return this.getBuffering()}},{key:"setDisplayState",value:function(e){this.sendNotification(re.CHANGE_DISPLAY_STATE,e)}},{key:"displayState",get:function(){return this.getDisplayState()},set:function(e){return this.setDisplayState(e)}},{key:"getDisplayState",value:function(e){return this.appState.getDisplayState()}},{key:"getWaiting",value:function(){return this.appState.getWaiting()}},{key:"waiting",get:function(){return this.getWaiting()},set:function(e){return this.setWaiting(e)}},{key:"setWaiting",value:function(e){return this.appState.setWaiting(e)}},{key:"getBusy",value:function(){return this.appState.getBusy()}},{key:"busy",get:function(){return this.getBusy()},set:function(e){return this.setBusy(e)}},{key:"setBusy",value:function(e){return this.appState.setBusy(e)}},{key:"getError",value:function(){return this._error||this.getMediaElement().error}},{key:"error",get:function(){return this.getError()}},{key:"enterFullScreen",value:function(){this.sendNotification(re.CHANGE_DISPLAY_STATE,le.FULL_SCREEN)}},{key:"exitFullScreen",value:function(){this.sendNotification(re.CHANGE_DISPLAY_STATE,le.NORMAL)}},{key:"enterPictureInPicture",value:function(){this.sendNotification(re.CHANGE_DISPLAY_STATE,le.PICTURE_IN_PICTURE)}},{key:"exitPictureInPicture",value:function(){this.sendNotification(re.CHANGE_DISPLAY_STATE,le.NORMAL)}},{key:"setHidden",value:function(e){if(e!==this.appState.getHidden()){this.appState.setHidden(e);var t=this.viewComponent.style;e===!0?(this.hiddenData={width:t.width,height:t.height,paused:this.getPaused()},t.width=t.height="0px",this.hiddenData.paused===!1&&this.pause()):(t.width=this.hiddenData.width,t.height=this.hiddenData.height,this.hiddenData.paused===!1&&this.play(),this.hiddenData=null)}}},{key:"hidden",get:function(){return this.getHidden()},set:function(e){return this.setHidden(e)}},{key:"getHidden",value:function(){return this.appState.getHidden()}},{key:"getWidth",value:function(){var e=this.getViewComponent()||{};return e.offsetWidth}},{key:"width",get:function(){return this.getWidth()}},{key:"getHeight",value:function(){var e=this.getViewComponent()||{};return e.offsetHeight}},{key:"height",get:function(){return this.getHeight()}},{key:"getVideoWidth",value:function(){var e=this.getMediaElement()||{};return e.videoWidth}},{key:"videoWidth",get:function(){return this.getVideoWidth()}},{key:"getVideoHeight",value:function(){var e=this.getMediaElement()||{};return e.videoHeight}},{key:"videoHeight",get:function(){return this.getVideoHeight()}},{key:"getLeft",value:function(){var e=this.getViewComponent()||{};return e.offsetLeft}},{key:"left",get:function(){return this.getLeft()}},{key:"getRight",value:function(){return this.getLeft()+this.getWidth()}},{key:"right",get:function(){return this.getRight()}},{key:"getTop",value:function(){var e=this.getViewComponent()||{};return e.offsetTop}},{key:"top",get:function(){return this.getTop()}},{key:"getBottom",value:function(){return this.getTop()+this.getHeight()}},{key:"bottom",get:function(){return this.getBottom()}},{key:"getMouseX",value:function(){return U.clientX-this.getLeft()}},{key:"mouseX",get:function(){return this.getMouseX()}},{key:"getMouseY",value:function(){return U.clientY-this.getTop()}},{key:"mouseY",get:function(){return this.getMouseY()}},{key:"getMouseOver",value:function(){var e=this.getMouseX(),t=this.getMouseY(),n=e>=0&&e<=this.right&&e>=this.left,i=t>=0&&t<=this.top&&t>=this.bottom;return U.isMouseOverDocument()&&n&&i}},{key:"mouseOver",get:function(){return this.getMouseOver()}},{key:"recordContentChange",value:function(e){this.sendNotification(re.RECORD_CONTENT_CHANGE,e)}},{key:"setPlaybackRate",value:function(e){this.ads.inProgress!==!0&&e!==this.getMediaElement().playbackRate&&(this.appState.setPlaybackRate(e),this.getMediaElement().playbackRate=e)}},{key:"playbackRate",get:function(){return this.getPlaybackRate()},set:function(e){return this.setPlaybackRate(e)}},{key:"getPlaybackRate",value:function(){return this.getMediaElement().playbackRate}},{key:"setCues",value:function(e){return this.mediaProxy.setCues(e),e}},{key:"cues",get:function(){return this.getCues()},set:function(e){return this.setCues(e)}},{key:"getCues",value:function(){return this.mediaProxy.getCues()}},{key:"setQuality",value:function(e){return this.retrieveProxy(Ie.NAME).setQuality(e)}},{key:"quality",get:function(){return this.getQuality()},set:function(e){return this.setQuality(e)}},{key:"getQuality",value:function(){return this.retrieveProxy(Ie.NAME).getQuality()}},{key:"getQualityLevels",value:function(){return this.retrieveProxy(Ie.NAME).getQualityLevels()}},{key:"qualityLevels",get:function(){return this.getQualityLevels()}},{key:"getQualityMode",value:function(){return this.retrieveProxy(Ie.NAME).getQualityMode()}},{key:"qualityMode",get:function(){return this.getQualityMode()},set:function(e){return this.setQualityMode(e)}},{key:"setQualityMode",value:function(e){return this.retrieveProxy(Ie.NAME).setQualityMode(e)}},{key:"setMaxQualityLevel",value:function(e){return this.retrieveProxy(Ie.NAME).setMaxQualityLevel(e)}},{key:"maxQualityLevel",get:function(){return this.getMaxQualityLevel()},set:function(e){return this.setMaxQualityLevel(e)}},{key:"getMaxQualityLevel",value:function(){return this.retrieveProxy(Ie.NAME).getMaxQualityLevel()}},{key:"getPlayState",value:function(){return this.appState.getPlayState()}},{key:"playState",get:function(){return this.getPlayState()}},{key:"getPlaybackTarget",value:function(){return this.appState.getPlaybackTarget()}},{key:"playbackTarget",get:function(){return this.getPlaybackTarget()},set:function(e){this.setPlaybackTarget(e)}},{key:"setPlaybackTarget",value:function(e){this.appState.setPlaybackTarget(e)}},{key:"getMediaTransforms",value:function(){return this.mediaProxy.getTransforms()}},{key:"authorize",value:function(e){this.security.authorize(e)}},{key:"goLive",value:function(){return this.retrieveProxy(Ie.NAME).goLive()}},{key:"appendChild",value:function(e){this.mediator.addLayer(e)}},{key:"removeChild",value:function(e){this.mediator.removeLayer(e)}},{key:"getSettings",value:function(){return this._settings&&this._settings.getSettings()||{change:function(){}}}},{key:"settings",get:function(){return this.getSettings()}},{key:"createMediaError",value:function(e,t){var n=null;switch(e){case MediaError.MEDIA_ERR_ABORTED:n=this.l10n.MSG_ERROR_ABORTED;break;case MediaError.MEDIA_ERR_DECODE:n=this.l10n.MSG_ERROR_DECODE;break;case MediaError.MEDIA_ERR_NETWORK:n=this.l10n.MSG_ERROR_NETWORK;break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:n=this.l10n.MSG_ERROR_SRC;break;default:n=this.l10n.MSG_ERROR_DEFAULT}return a.create(n,e,t)}},{key:"destroy",value:function(){var e=this,n=this.retrieveProxy(ze.NAME);if(null!=n){var i=n.activePlaybackCore;null!=i&&"function"==typeof i.destroy&&i.destroy()}this.sendNotification(re.DESTROY,this),setTimeout(function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"destroy",e).call(e),U.timerGroup(e.multitonKey,!0)},1)}}],[{key:"create",value:function(e,n){return new Promise(function(i,r){try{var a=new t(e);e.amp=a,a.onready=function(e){this.player=e.player,i(e)},a.initialize(n)}catch(e){r(e)}})}}]),t}(ae),gt=function(){function e(){babelHelpers.classCallCheck(this,e),this.map={}}return babelHelpers.createClass(e,[{key:"add",value:function(e,t){this.map[e]=t}},{key:"item",value:function(e){return this.map[e]}},{key:"remove",value:function(e){var t=this.map[e];return null!=t&&(this.map[e]=null,delete this.map[e]),t}}]),e}(),mt=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"js",value:function(e,t){return U.loadScript(e,document.body)}},{key:"css",value:function(e,t){return new Promise(function(n,i){try{U.loadStyleSheet(e)}catch(e){i()}n(t)})}},{key:"json",value:function(e,t){return U.requestJson(t.src).then(function(e){return t.data=e,t})}},{key:"img",value:function(e,t){return U.loadImage(e)}},{key:"require",value:function(e){var t=this.item(e);return null==t?"string"==typeof e?this.add({src:e}):null!=e.src?this.add(e):Promise.resolve(e):"function"==typeof t?(gt.prototype.add.call(this,e,null),Promise.resolve().then(function(){return t()})):"function"==typeof t.then?t:Promise.resolve(t)}},{key:"add",value:function(e){var n=this;if(e.enabled===!1)return Promise.resolve();var i=Y.instance.enabled&&null!=e.debug?e.debug:e.src,r=e.id||e.src||i;if(e.defer===!0)return e.defer=!1,babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"add",this).call(this,r,this.add.bind(this,e)),Promise.resolve();var a=this.item(r);if(null!=a){if("function"==typeof a.then)return a;if("function"!=typeof a)return Promise.resolve(a)}var s,o=e.type||U.getMimeType(i);return o===U.mimeTypes.js||/javascript/.test(o)?s=this.js(i,e):o===U.mimeTypes.css?s=this.css(i,e):o===U.mimeTypes.json||/json/.test(o)?s=this.json(i,e):o!==U.mimeTypes.swf?s=U.request(i):/image/.test(o)&&(s=this.img(i,e)),null==s?Promise.resolve():(s=s.then(function(e){return gt.prototype.add.call(n,r,e),e}),babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"add",this).call(this,r,s),s)}},{key:"addResources",value:function(e){var t=this;if(!e||0==e.length)return Promise.resolve();var n=[],i=[];e.forEach(function(e){e instanceof Array?n.push(t.addResources.bind(t,e)):e.async===!0?i.push(t.add(e)):n.push(t.add.bind(t,e))});var r=i.length>0?Promise.all(i):Promise.resolve();return r.then(function(){return U.chain(n)})}}]),t}(gt),bt={},kt=new mt,Et=[],Tt=function(){function e(){babelHelpers.classCallCheck(this,e)}return babelHelpers.createClass(e,null,[{key:"VERSION",get:function(){return"AMP v9.1.11"}},{key:"plugins",get:function(){return bt}},{key:"instances",get:function(){return Et}},{key:"resourceManager",get:function(){return kt}},{key:"create",value:function(e,t,n){var i=this,r=Date.now();null!=e.container&&(t=e,e=e.container,delete t.container);var s=U.select(e);if(null==s)return Promise.reject(a.create("Invalid container. Could not find DOM element: ".concat(e)));t=t instanceof Q?t:Q.create(t),Y.instance=new Y(t.debug);var o=this.getVersion();return null==s.dataset&&(s.dataset={}),s.dataset["amp.version"]=o,Y.instance.log("[AMP] ".concat(o)),Promise.all([F.init(t),vt.create(s,t),H.init(t)]).then(function(e){var t=e[1],a=t.player;return a.initTime=r,a.performance.record("init",r),a.request=i.request.bind(i),a.require=i.require.bind(i),a.once(z.DESTROY,function(e){return Ct.dispatchEvent(e)}),Ct.dispatch(z.CREATE,a),"function"==typeof n&&n(t),a}).catch(function(e){throw a.create(e)})}},{key:"getVersion",value:function(){return this.VERSION}},{key:"registerPlugin",value:function(e,t,n){"function"==typeof t&&(n=t),this.plugins[e]=n}},{key:"getResourceManager",value:function(){return kt}},{key:"addResource",value:function(e){return this.getResourceManager().add(e)}},{key:"addResources",value:function(e){return this.getResourceManager().addResources(e)}},{key:"request",value:function(e){return U.request(e)}},{key:"requestJson",value:function(e){return U.requestJson(e)}},{key:"require",value:function(e){return this.resourceManager.require(e)}},{key:"getResource",value:function(e){return this.getResourceManager().item(e)}},{key:"removeResource",value:function(e){return this.getResourceManager().remove(e)}},{key:"evaluateBindings",value:function(e,t){return $.evaluateBindings(e,t)}},{key:"defaults",value:function(e){return U.override(Q.defaults,e,!1)}},{key:"embed",value:function(t){function n(e,t){return s[e]||s[e[0]]||t}function i(e){var t=n(e);return null==t?Promise.resolve():Promise.resolve().then(function(){return/^\{[\s\S]*\}$/.test(t)?t:U.requestText(t).catch(function(n){throw a.create('Could not load resource "'.concat(e,'" at "').concat(t,'"'))})}).then(function(n){try{return JSON.parse(n)}catch(n){throw a.create('Could not parse resource "'.concat(e,'". "').concat(t,'"'))}})}function r(e){function i(e,t,n,i){if(null!=n)return U.set(e,t,null!=i?i(n):n)}return i(e,["media","src"],n("src")),i(e,["media","poster"],n("poster")),i(e,["media","startTime"],n("time"),parseFloat),i(e,["autoplay"],n("autoplay"),function(e){return/true|false/.test(e)?"true"==e:e}),i(e,["container"],"SCRIPT"!==t.nodeName?t:t.parentNode.insertBefore(document.createElement("div"),t.nextSibling)),i(e,["container","style","width"],n("width"),V.toSize),i(e,["container","style","height"],n("height"),V.toSize),e}if(null==t)return Promise.reject(a.create("Invalid DOM element"));var s=t.dataset;s.embedded=!0;var o=n("id",t.id||U.createUID());return s.id!==o&&(s.id=o),null!=e.instances[o]?Promise.reject(a.create('Player with id "'.concat(o,'" already exists.'))):(e.instances[o]=!0,Promise.all([i("defaults"),i("config"),i("media")]).then(function(n){var i=n[0];if(null==i||(e.defaults(i),"script"!=t.nodeName.toLowerCase()||1!==n.filter(function(e){return null!=e}).length)){null!=n[2]&&(n[2]={media:n[2]}),n.push(r({id:o,dataset:U.clone(s)}));var a=U.merge(n);return e.create(a)}}))}}]),e}(),Ct=o.create(Tt);U.mixin(Tt,Ct),Tt.addEventListener(z.CREATE,function(e){var t=e.detail;Et.push(e.detail),null!=t.id&&(Et[t.id]=t)}),Tt.addEventListener(z.DESTROY,function(e){var t=e.detail,n=Et.indexOf(t);Et.splice(n,1),null!=t.id&&delete Et[t.id]});var Nt=function(){function e(t,n,i,r){babelHelpers.classCallCheck(this,e),this.id=t,this.name=n,this.logo=i,this.metadata=r}return babelHelpers.createClass(e,null,[{key:"create",value:function(t,n,i,r){return new e(t,n,i,r)}}]),e}(),_t=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3?arguments[3]:void 0;babelHelpers.classCallCheck(this,e),this.list=[],this.featured=i,this.footprints=r,this.metadata=a,t.forEach(function(e){return n.add(e)})}return babelHelpers.createClass(e,[{key:"length",get:function(){return this.list.length}},{key:"add",value:function(e){return this.list.push(e),this[e.id]=e,e}},{key:"slice",value:function(e,t){return this.list.forEach(e,t)}},{key:"splice",value:function(e,t){for(var n,i=arguments.length,r=new Array(i>2?i-2:0),a=2;a<i;a++)r[a-2]=arguments[a];return(n=this.list).splice.apply(n,[e,t].concat(r))}},{key:"forEach",value:function(e){return this.list.forEach(e)}},{key:"some",value:function(e){return this.list.some(e)}},{key:"filter",value:function(e){return this.list.filter(e)}},{key:"map",value:function(e){return this.list.map(e)}},{key:"reduce",value:function(e,t){return this.list.reduce(e,t)}},{key:"includes",value:function(e){return this.list.includes(e)}},{key:"indexOf",value:function(e){return this.list.indexOf(e)}},{key:"item",value:function(e){return this.list[e]}}],[{key:"create",value:function(t,n,i,r){return new e(t,n,i,r)}}]),e}(),Pt={VIDEO:"video",AUDIO:"audio"},St={AUTO:"auto",MANUAL:"manual"},Ht=function e(t,n,i){babelHelpers.classCallCheck(this,e),this.key=t,this.token=n,this.expiration=i},Mt=function e(){babelHelpers.classCallCheck(this,e),this.src=null,this.debug=null,this.type=null,this.metadata={}},Lt=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this)||this,n.source=null,n.title=null,n.description=null,n.link=null,n.guid=null,n.pubDate=null,n.poster=null,n.thumbnail=null,n.embed=null,n.category=null,n.medium=null,n.duration=null,n.track=null,n.scenes=null,n.startTime=null,n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,null,[{key:"DEFAULT",get:function(){return{src:U.blankVideo(),type:U.mimeTypes.mp4,temporalType:"vod",medium:"video"}}}]),t}(Mt),It=function(e){function t(n,i,r){var a;return babelHelpers.classCallCheck(this,t),a=e.call(this)||this,a.player=n,a.config=i||{},a.key=r,a.logger=new Y(a.debug),Object.values(z).forEach(function(e){var t=a["on".concat(e)];null!=t&&"function"==typeof t&&(t=a["on".concat(e)]=t.bind(babelHelpers.assertThisInitialized(a)),a.player.addEventListener(e,t))}),a}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"debug",get:function(){return null!=this.config.debug?this.config.debug:this.player.config.debug}},{key:"data",get:function(){return this.player.evaluateBindings(this.config)}},{key:"destroy",value:function(){var e=this;Object.values(z).forEach(function(t){var n=e["on".concat(t)];null!=n&&"function"==typeof n&&e.player.removeEventListener(t,n)}),babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"destroy",this).call(this),this.player=null,this.config=null,this.key=null}},{key:"bindHandlers",value:function(e){var t=this;e instanceof Array==0&&(e=[e]),e.forEach(function(e){t[e]=t[e].bind(t)})}}],[{key:"createFactory",value:function(e){return function(e,t,n){var i=this;return new Promise(function(r,a){try{var s=new i(e,t,n);r(s)}catch(e){a(e)}})}.bind(e)}},{key:"createPureMVCFactory",value:function(e){return function(t,n,i){return new Promise(function(i,r){try{var a=new e;a.parentModule=t,a.player=t,a.config=n,t.registerModule(a),i(a)}catch(e){r(e)}})}}}]),t}(o),Rt=function(e){function t(n,i){var r;return babelHelpers.classCallCheck(this,t),r=e.call(this,n,i)||this,r.feature="ads",r}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"dispatchEvent",value:function(e){var n=e.type;"timeupdate"!=n&&"timeremaining"!=n&&this.player.logger.log("[AMP AD EVENT] ".concat(n),e),"function"==typeof this.player.sendNotification&&this.player.sendNotification("ads".concat(n),e.detail),babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"dispatchEvent",this).call(this,e),this.player.dispatch("ad".concat(n),e.detail)}}]),t}(It),Ot=function(e){function t(n,i){var r;return babelHelpers.classCallCheck(this,t),r=e.call(this,n,i)||this,r.feature="auth",r.provider=null,r.providers=null,r}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"dispatchEvent",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"dispatchEvent",this).call(this,e),Object.values(de).includes(e.type)&&this.player.dispatchEvent(e)}}]),t}(It),Dt=function(){function e(t,n,i,r,a,s,o,l,u,c,h,d,f){babelHelpers.classCallCheck(this,e),this.id=t,this.title=n,this.duration=i,this.position=r,this.type=a,this.partner=s,this.advertiser=o,this.companions=l,this.request=u,this.metadata=c,this.totalAds=h,this.time=d,this.clickThrough=f}return babelHelpers.createClass(e,null,[{key:"create",value:function(t,n,i,r,a,s,o,l,u,c,h,d,f){return new e(t,n,i,r,a,s,o,l,u,c,h,d,f)}}]),e}(),wt=function(e){function t(n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,n)||this,i.plugin=null,i.proxy=null,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"initializeNotifier",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"initializeNotifier",this).call(this,e),
this.proxy=this.facade.retrieveProxy(J.NAME),this.plugin=this.facade}},{key:"dispatchEvent",value:function(e,t){"string"!=typeof e&&(t=e.getBody(),null==t&&(t={}),e=e.getName()),this.player.sendNotification(re.DISPATCH_EVENT,s.create(e,t));var n=this.plugin.feature;null!=n&&"auth"!==n&&(e=e.replace(new RegExp("^("+n+")"),"")),n=this.plugin.getModuleName(),e=e.replace(new RegExp("^("+n+")"),"");var i=s.create(e,t);return this.sendNotification(re.DISPATCH_EVENT,i),i}}]),t}(tt),xt=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this,t.NAME)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"listNotificationInterests",value:function(){return[re.STARTED,re.ENDED]}},{key:"started",value:function(){this.proxy.contentStarted()}},{key:"ended",value:function(){this.proxy.contentEnded()}}],[{key:"NAME",get:function(){return"AdContentController"}}]),t}(wt),Gt=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this,t.NAME)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"listNotificationInterests",value:function(){return[re.START,re.PLAY,re.PAUSE,re.TOGGLE_PLAY_PAUSE,re.VOLUME_CHANGE,re.PLAY_STATE_CHANGE]}},{key:"start",value:function(){this.sendNotification(re.REQUEST_PLAY),this.playback.initialized===!1&&this.player.sendNotification(re.INITIALIZED),this.proxy.start()}},{key:"play",value:function(){if(this.applicationState.getLocked()!==!0){if(this.sendNotification(re.REQUEST_PLAY),this.proxy.getStarted()===!1)return void this.sendNotification(re.START,!0);this.proxy.play(),this.player.sendNotification(re.CHANGE_PLAY_STATE,ue.PLAYING)}}},{key:"pause",value:function(){var e=this,t=this.proxy.adVO.time,n=this.proxy.adVO.duration;if("undefined"==typeof t||t===n){var i={transform:function(t){if(t===re.PLAYING)return e.player.timers.setTimeout(function(){return e.player.removeTransform(ie.PLAY_STATE,i),e.player.sendNotification(re.PAUSE)},300),t},priority:2};return void this.player.addTransform(ie.PLAY_STATE,i)}this.proxy.pause(),this.player.sendNotification(re.CHANGE_PLAY_STATE,ue.PAUSED)}},{key:"toggleplaypause",value:function(){var e=this.proxy.getPaused()||this.proxy.getStarted()===!1?re.PLAY:re.PAUSE;this.sendNotification(e,!0)}},{key:"volumechange",value:function(e){this.proxy.setVolume(e)}},{key:"playstatechange",value:function(e){"playing"===e.value&&this.sendNotification($e.AD_PLAYING,this.proxy.adVO)}}],[{key:"NAME",get:function(){return"AdCoreController"}}]),t}(wt),Ut=function(e){function t(n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,n)||this,i.pods=[],i.content=new xt,i.ads=new Gt,i.processAdBreak=i.processAdBreak.bind(babelHelpers.assertThisInitialized(i)),i.processAdRequest=i.processAdRequest.bind(babelHelpers.assertThisInitialized(i)),i.inProgress=!1,i.paused=!1,i.started=!1,i.adVO=null,i.contextName="ad",i.container=null,i.partner=null,i.pods=null,i.mediaChanging=!1,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"createDefaultAdVO",value:function(){return new Dt(null,null,null,null,null,this.partner,null,null,null,null,null)}},{key:"getContainer",value:function(){return this.facade.player.adContainer||this.facade.player.container}},{key:"setCompanions",value:function(e){return this.adVO.companions=e,this.sendNotification($e.AD_COMPANION,this.adVO),e}},{key:"getCompanions",value:function(){var e;return null!=(e=this.adVO)?e.companions:void 0}},{key:"getInProgress",value:function(){return this.inProgress}},{key:"setInProgress",value:function(e){return this.inProgress=e,e}},{key:"getStarted",value:function(){return this.started}},{key:"setStarted",value:function(e){return this.started=e,e}},{key:"getPaused",value:function(){return this.paused}},{key:"setPaused",value:function(e){return this.paused=e,e}},{key:"setCues",value:function(e){var t=_.transform(e,_.map(function(e){return{startTime:e,endTime:e}}));return this.facade.player.mediaProxy.setCues(t),e}},{key:"play",value:function(){this.setPaused(!1),this.sendNotification($e.AD_PLAY,this.adVO)}},{key:"pause",value:function(){this.setPaused(!0),this.sendNotification($e.AD_PAUSE,this.adVO)}},{key:"breakStart",value:function(){this.setInProgress(!0)}},{key:"breakEnd",value:function(){this.setInProgress(!1),this.reset()}},{key:"error",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=("function"==typeof e.getMessage?e.getMessage():void 0)||e.message;this.facade.logger.error("[AMP AD ERROR]","".concat(n," Skipping ad content."),e),null==this.adVO&&(this.adVO={}),this.adVO.error=e,this.sendNotification($e.AD_ERROR,this.adVO),t===!0&&this.endBreak()}},{key:"engage",value:function(e){this.getEnabled()!==!1&&(this.setStarted(!1),this.getInProgress()&&(this.reset(),this.facade.player.sendNotification(re.REMOVE_APPLICATION_STATE,"ad-mode")),this.engageAds())}},{key:"engageAds",value:function(){this.engaged!==!0&&(this.engaged=!0,this.core=this.facade.player.removeMediator(nt.NAME),this.facade.removeMediator(xt.NAME),this.facade.registerMediator(this.ads))}},{key:"reset",value:function(){this.engaged=!1,this.facade.removeMediator(Gt.NAME),this.facade.player.registerMediator(this.core),this.facade.registerMediator(this.content)}},{key:"processAdRequest",value:function(e){var t=this;return this.facade.player.transform(ie.AD_REQUEST,e).then(function(e){return t.sendNotification($e.REQUEST,e),t.facade.transform(ie.AD_REQUEST,e)})}},{key:"processAdBreak",value:function(e){var t=this;return this.facade.player.transform(ie.AD_BREAK,e).then(function(e){return t.facade.transform(ie.AD_BREAK,e)})}},{key:"requestAd",value:function(){this.sendNotification($e.REQUEST_START,this.adVO)}},{key:"getPodById",value:function(e){return this.pods.find(function(t){return t.id===e})}},{key:"setPodLocks",value:function(e){var t=this;e.forEach(function(e){var n=t.getPodById(e.id);null!=n&&(n.locked=e.locked)})}},{key:"resize",value:function(e){}},{key:"startBreak",value:function(e){return null!=e&&(this.adVO=e),this.setStarted(!0),this.sendNotification($e.BREAK_START,this.adVO),this.getEnabled()!==!1||(this.endBreak(),!1)}},{key:"endBreak",value:function(){this.sendNotification($e.BREAK_END,this.adVO)}},{key:"start",value:function(){this.mediaChanging=!1,this.startBreak()}},{key:"contentPlay",value:function(){this.facade.player.sendNotification(re.PLAY,!0)}},{key:"contentPause",value:function(){var e=this.facade.player.mediaElement;e.seeking===!0?e.once("seeked",function(){e.pause()}):e.pause()}},{key:"contentStarted",value:function(){}},{key:"contentSeek",value:function(e){}},{key:"contentEnded",value:function(){}},{key:"setVolume",value:function(e){}},{key:"getVolume",value:function(){}},{key:"terminateAd",value:function(){}},{key:"terminateAllAds",value:function(){}}],[{key:"NAME",get:function(){return Pe.NAME}}]),t}(Pe),Vt=function(){function e(t,n,i,r){var a=this;babelHelpers.classCallCheck(this,e),this.request=t,this.partner=n,this.config=i,_.each(r,function(e,t){return a[t]=e})}return babelHelpers.createClass(e,null,[{key:"create",value:function(t,n,i,r){return new e(t,n,i,r)}}]),e}(),Yt=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this,t.NAME)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"listNotificationInterests",value:function(){return[re.MEDIA_CHANGE,$e.BREAK_START,$e.BREAK_END,re.SEEKED,$e.AD_CONTAINER_CREATED,re.REPLAY,re.DESTROY]}},{key:"mediachange",value:function(e){this.proxy.getEnabled()!==!1&&(this.proxy.mediaChanging=!0,this.proxy.engage(e))}},{key:"seeked",value:function(e){this.proxy.contentSeek(e)}},{key:"replay",value:function(){"function"==typeof this.proxy.replay&&this.player.getAutoplay()===!1&&this.proxy.replay()}},{key:"destroy",value:function(){"function"==typeof this.proxy.destroy&&this.proxy.destroy()}},{key:"adscontainercreated",value:function(e){this.proxy.container=e}},{key:"adsbreakstart",value:function(){this.proxy.breakStart()}},{key:"adsbreakend",value:function(e){var t,n=this;this.proxy.breakEnd(),"ima"===(null!=e?e.partner:void 0)&&(t=this.applicationState.getPlaybackRate(),this.facade.player.setPlaybackRate(t)),this.doAfter(function(){n.applicationState.getEnded()&&n.applicationState.getHasPostContent()===!0&&n.sendNotification(re.MEDIA_SEQUENCE_ENDED)})}}],[{key:"NAME",get:function(){return"AdController"}}]),t}(wt),zt=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this,t.NAME)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"listNotificationInterests",value:function(){return Object.values($e)}},{key:"handleNotification",value:function(e){this.dispatchEvent(e.getName(),e.getBody())}},{key:"dispatchEvent",value:function(e,t){e=e.replace(/^(ads)/,""),this.sendNotification(re.DISPATCH_EVENT,s.create(e,t)),this.facade.player.sendNotification(re.DISPATCH_EVENT,s.create("ad".concat(e),t))}}],[{key:"NAME",get:function(){return"AdEventController"}}]),t}(wt),Bt=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this)||this,n.feature="ads",n.container=null,Object.defineProperties(babelHelpers.assertThisInitialized(n),{enabled:{get:n.getEnabled,set:n.setEnabled,enumerable:!0,configurable:!1},inProgress:{get:n.getInProgress,enumerable:!0,configurable:!1},started:{get:n.getStarted,enumerable:!0,configurable:!1},paused:{get:n.getPaused,enumerable:!0,configurable:!1},companions:{get:n.getCompanions,enumerable:!0,configurable:!1},currentAd:{get:n.getCurrentAd,enumerable:!0,configurable:!1}}),n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"createModel",value:function(){this.proxy=this.isFullscreenDevice()?this.createFullscreenProxy():this.createProxy(),this.registerProxy(this.proxy)}},{key:"createController",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"createController",this).call(this),this.registerMediator(new Yt),this.registerMediator(new zt)}},{key:"isFullscreenDevice",value:function(){return U.isFullscreenDevice()}},{key:"createProxy",value:function(){}},{key:"createFullscreenProxy",value:function(){}},{key:"listNotificationInterests",value:function(){return[re.MEDIA_CHANGE,re.REPLAY,re.PLAY,re.PAUSE,re.PAUSED,re.START,re.STARTED,re.ENDED,re.READY,re.VOLUME_CHANGE,re.FULL_SCREEN_CHANGE,re.CHANGE_ACTIVE_STATE,re.PLAY_STATE_CHANGE,re.SEEKED,re.TOGGLE_PLAY_PAUSE,re.DESTROY]}},{key:"listNotificationPublications",value:function(){return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"listNotificationPublications",this).call(this).concat(Object.values($e)).concat([re.REQUEST_PLAY,re.DISPLAY_TIME,re.DISABLE_FULL_SCREEN,re.ENABLE_VIDEO_EVENTS,re.DISABLE_VIDEO_EVENTS,re.HAS_POST_CONTENT,re.MEDIA_SEQUENCE_ENDED,re.CHANGE_PLAY_STATE,re.AUTOPLAY_BLOCKED])}},{key:"setEnabled",value:function(e){this.proxy.setEnabled(e)}},{key:"getEnabled",value:function(){return this.proxy.getEnabled()}},{key:"getInProgress",value:function(){return this.proxy.getInProgress()}},{key:"getStarted",value:function(){return this.proxy.getStarted()}},{key:"getPaused",value:function(){return this.proxy.getPaused()}},{key:"getCompanions",value:function(){return this.proxy.getCompanions()}},{key:"getCurrentAd",value:function(){return this.proxy.adVO}},{key:"setPodLocks",value:function(e){this.proxy.setPodLocks(e)}},{key:"resize",value:function(e){this.proxy.resize(e)}},{key:"terminateAd",value:function(){this.proxy.terminateAd()}},{key:"terminateAllAds",value:function(){this.proxy.terminateAllAds()}},{key:"requestAd",value:function(){this.proxy.start(!1)}}],[{key:"NAME",get:function(){return"AdPlugin"}}]),t}(lt),Ft=function(e){function t(n){return babelHelpers.classCallCheck(this,t),e.call(this,n)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"initializeNotifier",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"initializeNotifier",this).call(this,e),this.plugin=this.facade.retrieveProxy(J.NAME),this.media=this.facade.player.retrieveProxy(Be.NAME)}},{key:"onRegister",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onRegister",this).call(this),this.facade.viewComponent=this.viewComponent}}]),t}(Je),jt=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this,"captioning")||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onRegister",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onRegister",this).call(this),this.captioningStyle=this.create(null,this.viewComponent,"style"),this.captioningStyle.type="text/css",this.applyStyles()}},{key:"listNotificationInterests",value:function(){return[ve.VISIBILITY_CHANGE,ve.ENABLED,ve.TRACK_SELECTED,re.SETTINGS_CHANGE]}},{key:"onRemove",value:function(){this.captioningStyle&&this.viewComponent.removeChild(this.captioningStyle)}},{key:"handleNotification",value:function(e){var t,n=e.getBody(),i=n?re.ADD_APPLICATION_STATE:re.REMOVE_APPLICATION_STATE;switch(e.getName()){case ve.TRACK_SELECTED:t="cc-embedded",i="embedded"===n.type?re.ADD_APPLICATION_STATE:re.REMOVE_APPLICATION_STATE;break;case ve.VISIBILITY_CHANGE:t="cc-active";break;case ve.ENABLED:i=n?re.ADD_CONTROL_STATE:re.REMOVE_CONTROL_STATE,t="cc-enabled",n||this.sendNotification(re.REMOVE_APPLICATION_STATE,"cc-active");break;case re.SETTINGS_CHANGE:null!=n.captions&&this.applyStyles()}null!=t&&this.sendNotification(i,t)}},{key:"applyStyles",value:function(){var e=this.facade.settings,t=this.facade.settings.styles,n=V.toCSS(t.window,!0,"\n"),i=V.toCSS(t.text,!0,"\n"),r="#"+this.facade.player.viewComponent.id;null!=e.visible&&(this.facade.hidden=!e.visible);var a="".concat(r," .amp-caption {").concat(n,"}\n")+"".concat(r," .amp-caption p, ").concat(r," .amp-caption span {").concat(i,"}\n");a+=U.isChrome()?"".concat(r," video::cue {").concat(i).concat(n,"}\n"):"".concat(r," video::-webkit-media-text-track-display-backdrop {").concat(n,"}\n")+"".concat(r," video::cue {").concat(i,"}\n")+"".concat(r," video::-webkit-media-text-track-display span {").concat(i,"}"),this.captioningStyle.innerHTML=a}}]),t}(Ft),Kt=function(e){function t(n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,t.NAME,null,n)||this,i.proxy=null,i.handleInline=i.handleInline.bind(babelHelpers.assertThisInitialized(i)),i.inlineTypes=[U.mimeTypes.vtt,U.mimeTypes.cea608,U.mimeTypes.cea708,U.mimeTypes.ttml],i.current=[],i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getRendererName",value:function(){return"html"}},{key:"onRegister",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onRegister",this).call(this),this.proxy=this.facade.retrieveProxy(Le.NAME);var e=this.proxy.getTrack();if(null!=e){var n=e.activeCues;n.length>0&&this.render(n),this.initInline()}}},{key:"onRemove",value:function(){this.clear()}},{key:"canUseResource",value:function(e){if(null==e)return!1;var t=[U.mimeTypes.srt,U.mimeTypes.ttml].concat(this.inlineTypes);return t.includes(e.type)}},{key:"initInline",value:function(){var e=this,t=this.proxy.facade.player,n=this.proxy.getTextTrack(),i=this.proxy.track,r=function(e){return!!e.src};if(i&&n&&this.inlineTypes.includes(i.type)){i.enabled=!0;var a=function(e){return n.language!==e.language||n.kind!==e.kind},s=function(t){t.removeEventListener("cuechange",e.handleInline,!0),t.mode=Ae.DISABLED},o=function(n){n.addEventListener("cuechange",e.handleInline,!0),n.mode=Ae.SHOWING,t.timers.setTimeout(function(){return n.mode=Ae.HIDDEN},10)};this.proxy.getHidden()||r(i)?s(n):o(n),_.transform(this.proxy.getTextTracks(),_.filter(a),_.map(s)),this.handleInline({target:n})}}},{key:"handleInline",value:function(e){var t=e.target;if(t.mode=Ae.HIDDEN,null!=t.activeCues){var n=this.convertCues(t.activeCues);this.sendNotification(ve.CHANGE_CUE,n)}}},{key:"convertCues",value:function(e){return Array.from(e,function(e){var t=e.text;if(!/^\{\".*}$/.test(t))return e.html=Te.createHTML(t),e}).filter(function(e){return!!e})}},{key:"computeStyles",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return e=parseInt(e),isNaN(e)?t:e},r=function(e){return"".concat(e,"%")},a={position:"absolute",overflow:"visible",minWidth:"min-content"},s=e.align||"middle",o=i(e.position,"auto"),l=i(e.size),u=i(e.line,"auto"),c="auto"==o;switch(s){case"left":case"start":a.textAlign="start",c&&(o=0);break;case"middle":case"center":a.textAlign="center",c&&(o=(100-l)/2);break;case"right":case"end":a.textAlign="end",c&&(o=100)}return a.left=r(o),c||100!==l||(l-=o),a.width=r(l),u<0||u>100?u=100:"auto"===u&&(u=100-t),e.snapToLines===!0?a.top="".concat(u*(n.height+1),"px"):a.top=r(u),e.visible===!1&&(a.visibility="hidden"),a}},{key:"adjustCaptions",value:function(){var e=this,t=this.viewComponent.getBoundingClientRect();this.elements.forEach(function(n){return e.adjustCaption(n,t)})}},{key:"adjustCaption",value:function(e,t){var n=e.getBoundingClientRect(),i=e.style;n.bottom>t.bottom&&(i.top="auto",i.bottom="0%"),n.right>t.right&&(i.left="auto",i.right="0%")}},{key:"listNotificationInterests",value:function(){return[ve.CUE_CHANGE,ve.TRACK_SELECTED,ve.VISIBILITY_CHANGE,re.CHANGE_MEDIA,re.LOADED_METADATA,re.CAN_PLAY_THROUGH]}},{key:"handleNotification",value:function(e){var t=e.getName(),n=e.getBody();switch(this.viewComponent,t){case re.CHANGE_MEDIA:this.clear();break;case ve.CUE_CHANGE:this.render(n);break;case ve.VISIBILITY_CHANGE:case ve.TRACK_SELECTED:case re.LOADED_METADATA:case re.CAN_PLAY_THROUGH:this.initInline()}}},{key:"clear",value:function(){this.viewComponent.innerHTML="",this.elements=null}},{key:"createCaption",value:function(e,t,n){return this.viewComponent.appendChild(we.createElement({class:"amp-caption-area",style:this.computeStyles(e,t,n),children:[{class:"amp-caption",innerHTML:e.html}]}))}},{key:"getLineBounds",value:function(){var e=this.createCaption({html:"CUE",visible:!1},0),t=e.getBoundingClientRect();return this.viewComponent.removeChild(e),t}},{key:"processCues",value:function(e){for(var t=e.slice(),n=e.length,i=0,r="";i<n;){var a=t[i],s=a.line;("auto"==s||s>=100||s<0)&&(s=100),100==s?(t.splice(i,1),n--,r+=a.text+"\n"):++i}return r.length>0&&t.push({text:r,html:Te.createHTML(r),line:100}),t}},{key:"render",value:function(e){var t=this,n=this.facade.player.settings.captions||{};switch(n.scroll=n.scroll.toLowerCase().replace("-",""),n.scroll){case"rollon":this.classList.add("captioning-roll"),this.classList.remove("captioning-typed");case"painton":var i=function(e){return t.current==e},r=e.filter(i).length>0,a=e.length-1;if(r)return;if(a<0)return this.clear();if(this.current=e[a],"painton"!==n.scroll)break;this.classList.add("captioning-typed"),this.classList.remove("captioning-roll");break;default:this.classList.remove("captioning-roll"),this.classList.remove("captioning-typed")}this.clear();var s=this.getLineBounds(),o=e.length-1;this.elements=_.transform(this.processCues(e),_.map(function(e){return t.createCaption(e,o--,s)})),this.adjustCaptions()}}],[{key:"NAME",get:function(){return Le.TEXT_TRACK_RENDERER}}]),t}(Ue),Wt=function(e){function t(n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,t.NAME,n)||this,i.proxy=null,i.track=null,i.handleInline=i.handleInline.bind(babelHelpers.assertThisInitialized(i)),i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getRendererName",value:function(){return"native"}},{key:"canUseResource",value:function(e){if(null==e)return!1;var t=null!=document.createElement("video").textTracks;if(!t)return!1;var n=[U.mimeTypes.vtt,U.mimeTypes.cea608,U.mimeTypes.cea708],i=/iphone|ipad/.test(U.getDevice());return!!i&&n.indexOf(e.type)!==-1}},{key:"onRegister",value:function(){this.proxy=this.facade.retrieveProxy(Le.NAME),this.loadTracks(),this.updateTrack()}},{key:"onRemove",value:function(){this.unloadTracks()}},{key:"listNotificationInterests",value:function(){return[ve.VISIBILITY_CHANGE,ve.TRACK_SELECTED,re.LOADED_METADATA,re.CAN_PLAY_THROUGH]}},{key:"handleNotification",value:function(e){switch(e.getBody(),e.getName()){case ve.TRACK_SELECTED:case ve.VISIBILITY_CHANGE:case re.CAN_PLAY_THROUGH:this.updateTrack();break;case re.LOADED_METADATA:this.loadTracks()}}},{key:"unloadTracks",value:function(){this.proxy.getTextTracks().forEach(function(e){return e.mode=Ae.HIDDEN});var e=this.facade.player.getMediaElement(),t=Array.from(e.children);t.forEach(function(t){return e.removeChild(t)})}},{key:"loadTracks",value:function(){this.unloadTracks();var e=this.proxy.getTracks();if(null!=e){var t=this.facade.player.getMediaElement(),n=this.proxy.getCrossOrigin();null!=n&&t.setAttribute("crossorigin",n),e.forEach(function(e){if(e.type===U.mimeTypes.vtt){var n=document.createElement("track");n.src=e.src,null!=e.kind&&(n.kind=e.kind),null!=e.language&&(n.srclang=e.language),null!=e.label&&(n.label=e.label),n.default=e.default,t.appendChild(n)}})}}},{key:"updateTrack",value:function(){null!=this.track&&(this.track.mode=Ae.HIDDEN),this.proxy.getTextTracks().forEach(function(e){return e.mode=Ae.HIDDEN});var e=this.proxy.getTextTrack();e&&(this.track=e,this.proxy.getHidden()?(this.track.removeEventListener("cuechange",this.handleInline,!0),this.track.mode=Ae.HIDDEN):(this.track.addEventListener("cuechange",this.handleInline,!0),this.track.mode=Ae.SHOWING))}},{key:"handleInline",value:function(e){this.sendNotification(ve.CHANGE_CUE,Array.from(e.target.activeCues))}}],[{key:"NAME",get:function(){return Le.TEXT_TRACK_RENDERER}}]),t}(Ge),qt=function(e){function t(){var n;babelHelpers.classCallCheck(this,t),n=e.call(this,t.NAME)||this,n.captions=[],n.head=document.getElementsByTagName("head")[0];var i=window.com||{};return i.akamai=i.akamai||{},i.akamai.amp=i.akamai.amp||{},i.akamai.amp.plugins=i.akamai.amp.plugins||{},i.akamai.amp.plugins.subply=i.akamai.amp.plugins.subply||{},i.akamai.amp.plugins.subply.response=function(e){n.parse(e),n.poll()},null==window.com&&(window.com=i),n.data={base:"http://test.plymedia.com.s3.amazonaws.com/online/Akamai_",interval:1e3},n.caption=null,n.head=null,n.script=null,n.timeout=null,n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getURL",value:function(){return this.data.url}},{key:"setURL",value:function(e){return this.data.url=e,e}},{key:"start",value:function(){this.send()}},{key:"poll",value:function(){var e=this;this.facade.player.timers.setTimeout(function(){e.send()},this.data.interval||1e3)}},{key:"send",value:function(){var e=this;null!=this.script&&this.head.removeChild(this.script),this.script=U.loadScript(this.data.base+this.data.url+".js?nocache="+Date.now()).then(function(t){return e.script=t}).catch(function(t){return e.facade.logger.error("[AMP CAPTIONING ERROR]",t)})}},{key:"stop",value:function(){clearTimeout(timeout)}},{key:"parse",value:function(e){if(e.Stream===this.data.url&&!(null!=this.caption&&this.caption.id>=e.Ticks))return this.caption=new me(U.flattenTimecode(e.From),U.flattenTimecode(e.To),e.Ticks),this.caption.text=e.Text,html="",_.each(e.Text.split("\n"),function(e){""!==html&&(html+="<br />"),html+="<span>"+e+"</span>"}),this.caption.html="<p>"+html+"</p>",this.sendNotification(ve.CUE_CHANGE,[this.caption]),this.caption}}]),t}(puremvc.Proxy);qt.NAME="LiveCaptionProxy";var Qt=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this,t.NAME)||this,n.parser=new ke,n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"create",value:function(e,t){var n=e.data,i=this.facade.getTrack();_.each(this.parseToCues(n),function(e,t){this.cues.push(e)}.bind(i))}},{key:"parseToCues",value:function(e){var t,n=!1;try{if(t=this.parser.parse(e),null==t.cues||!t.cues instanceof Array)throw"property 'cues' is undefined"}catch(e){this.dispatch("error","Could not parse ttml caption track",e),Y.instance.error("Could not parse ttml caption track",e),n=!0}return n?new Array:t.cues}}]),t}(puremvc.Proxy);Qt.NAME="TTMLCaptionProxy";var Zt=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this,t.NAME)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"listNotificationInterests",value:function(){return[re.CHANGE_MEDIA,re.STARTED,re.TIME_UPDATE,re.LOADED_DATA,ve.VISIBILITY_CHANGE,ve.ENABLED,ve.CHANGE_CUE,ve.TRACK_SELECTED,ve.TRACKS_LOADED,ve.CUE_CHANGE,ve.TTML_CUE_CHANGE]}},{key:"changemedia",value:function(e){this.proxy.setTracks(e.track),this.proxy.selectRenderer(e),this.sendNotification(ve.ENABLED,!0)}},{key:"started",value:function(){var e=this,t=this.proxy.getTracks(),n=this.proxy,i=n.getTrack();null==i&&t.length>0&&(i=n.autoSelectTrack()),null!=i&&(i.isLive===!0&&(n=this.facade.retrieveProxy(qt.NAME),null==n&&(n=new qt,this.facade.registerProxy(n)),n.setURL(i.src),n.start()),_.find(t,_.filter(function(e){return e.type===U.mimeTypes.ttml}),_.map(function(){n=e.facade.retrieveProxy(Qt.NAME),n=new Qt,e.facade.registerProxy(n)})))}},{key:"timeupdate",value:function(e){var t=this.proxy.getTrack();if(null!=t&&t.isLive!==!0){var n=t.activeCues,i=!1;t.cues.forEach(function(t){if(null!=t){var r=n.indexOf(t);i=!0,e>=t.startTime&&e<t.endTime?r===-1&&n.push(t):r!==-1&&n.splice(r,1)}}),i===!0&&this.sendNotification(ve.CHANGE_CUE,n)}}},{key:"loadeddata",value:function(){var e=this.facade.player.textTracks,t=void 0===e?[]:e;if(0===this.proxy.getTracks().length&&0!==t.length){var n=function(e){return{srclang:e.language,type:e.isEmbedded?U.mimeTypes.cea608:U.mimeTypes.vtt,kind:e.kind,label:e.label}},i=[];_.each(t,function(e){i.some(function(t){return t.srclang===e.language})||i.push(n(e))}),this.proxy.setTracks(i),this.proxy.selectRenderer()}}},{key:"captioningvisibilitychange",value:function(e,t){var n=!e;n!==this.proxy.getHidden()&&(this.proxy.setHidden(n),this.dispatchEvent(t))}},{key:"captioningenabled",value:function(e,t){this.proxy.setEnabled(e),this.dispatchEvent(t)}},{key:"captioningchangecue",value:function(e){var t=this;this.player.transform(ie.CUE_CHANGE,e).then(function(e){null!=e&&t.sendNotification(ve.CUE_CHANGE,e)}).catch(function(n){t.sendNotification(ve.CUE_CHANGE,e)})}},{key:"captioningtrackselected",value:function(e,t){this.dispatchEvent(t)}},{key:"captioningtracksloaded",value:function(e,t){this.dispatchEvent(t)}},{key:"captioningcuechange",value:function(e,t){this.dispatchEvent(t)}},{key:"captioningttmlcuechange",value:function(e,t){var n=this.facade.retrieveProxy(Qt.NAME),i=this.proxy.getTrack();null!=n&&i.type===U.mimeTypes.ttml&&n.create(e,t)}}],[{key:"NAME",get:function(){return"CaptioningController"}}]),t}(wt),Xt=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this)||this,n.applicationState=null,n.media=null,n.player=null,n.playback=null,n.config=null,n.logger=null,n.bindings=null,n.params=null,n.playerCore=null,n.security=null,n.tracks=null,n.plugin=null,n.proxy=null,n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"initializeNotifier",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"initializeNotifier",this).call(this,e),this.player=this.facade.player||this.facade,this.applicationState=this.player.appState,this.media=this.player.mediaProxy,this.config=this.player.configuration,this.logger=this.player.logger,this.bindings=this.player.bindings,this.params=this.player.params,this.playerCore=this.player.playerCore,this.security=this.player.security,this.tracks=this.player.tracks,this.playback=this.player.playerCore.getActivePlaybackCore()||this.player.playback,this.localization=this.player.localization,this.proxy=this.facade.retrieveProxy(J.NAME),this.plugin=this.facade}},{key:"doAfter",value:function(e){var t=this;return new Promise(function(n,i){var r=function(){try{e(),n()}catch(e){t.facade.logger.error(e),i(e)}};return t.player.timers.setImmediate(r)})}}]),t}(puremvc.SimpleCommand),$t=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this)||this,n.feature="captioning",n.moduleName="captioning",n.mediatorname="",n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"createController",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"createController",this).call(this),this.registerMediator(new Zt)}},{key:"createModel",value:function(){this.proxy=new Le(this.config),this.registerProxy(this.proxy)}},{key:"createView",value:function(){var e=new jt;this.registerMediator(e),this.mediatorname=e.getMediatorName();var t=e.viewComponent;this.proxy.registerRenderer(new Wt(t)),this.proxy.registerRenderer(new Kt(t))}},{key:"destroy",value:function(){for(;this.proxy.rendererMap.length>=1;){var e=this.proxy.rendererMap[0],t=e.getMediatorName();this.removeMediator(t),this.proxy.removeRenderer(e.getRendererName())}this.removeMediator(this.mediatorname)}},{key:"listNotificationInterests",value:function(){return[re.LOADED_DATA,re.CAN_PLAY_THROUGH,re.CHANGE_MEDIA,re.STARTED,re.TIME_UPDATE,re.SETTINGS_CHANGE,ve.TRACK_SELECTED,ve.TTML_CUE_CHANGE]}},{key:"listNotificationPublications",value:function(){return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"listNotificationPublications",this).call(this).concat([ve.CUE_CHANGE,re.ADD_CONTROL_STATE,re.REMOVE_CONTROL_STATE,re.CHANGE_SETTINGS,ve.VISIBILITY_CHANGE,ve.SETTINGS_CHANGE])}},{key:"getEnabled",value:function(){return this.proxy.getEnabled()}},{key:"enabled",get:function(){return this.getEnabled()},set:function(e){return this.setEnabled(e)}},{key:"setEnabled",value:function(e){return this.sendNotification(ve.ENABLED,e),e}},{key:"getHidden",value:function(){return this.proxy.getHidden()}},{key:"hidden",get:function(){return this.getHidden()},set:function(e){return this.setHidden(e)}},{key:"setHidden",value:function(e){return this.setVisible(!e),e}},{key:"getVisible",value:function(){return!this.proxy.getHidden()}},{key:"visible",get:function(){return this.getVisible()},set:function(e){return this.setVisible(e)}},{key:"setVisible",value:function(e){return this.sendNotification(re.CHANGE_SETTINGS,{captions:{visible:e}}),this.sendNotification(ve.VISIBILITY_CHANGE,e),e}},{key:"getTracks",value:function(){return this.proxy.getTracks()}},{key:"tracks",get:function(){return this.getTracks()}},{key:"getTrack",value:function(){return this.proxy.getTrack()}},{key:"track",get:function(){return this.getTrack()},set:function(e){return this.setTrack(e)}},{key:"setTrack",value:function(e){return this.proxy.setTrack(e),e}},{key:"selectTrackByIndex",value:function(e){return this.proxy.selectTrackByIndex(e)}},{key:"selectTrackByLanguage",value:function(e){return this.proxy.selectTrackByLanguage(e)}},{key:"changeSettings",value:function(e){return this.sendNotification(re.CHANGE_SETTINGS,{captions:e}),this.sendNotification(ve.SETTINGS_CHANGE,e),e}},{key:"getSettings",value:function(){return this.player.settings.captions}},{key:"settings",get:function(){return this.getSettings()}},{key:"getRenderer",value:function(){return this.proxy.getRenderer()}},{key:"renderer",get:function(){return this.getRenderer()},set:function(e){return this.setRenderer(e)}},{key:"setRenderer",value:function(e){return this.proxy.setRenderer(e)}},{key:"getCurrentRenderer",value:function(){return this.proxy.getCurrentRenderer()}},{key:"currentRenderer",get:function(){return this.getCurrentRenderer()}}]),t}(lt),Jt=function(e){function t(n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,n)||this,Object.defineProperties(babelHelpers.assertThisInitialized(i),{instance:{get:i.getInstance,enumerable:!0,configurable:!1}}),i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"getPlaybackProxy",value:function(){return this.proxy.playbackProxy}},{key:"getInstance",value:function(){return this.getPlaybackProxy().player}}]),t}(lt),en=function(e){function t(n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,n)||this,i.playbackProxy=null,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"createPlaybackProxy",
value:function(){}},{key:"renderer",value:function e(){var t=this,e=this.playbackProxy.renderer(),n=e.id,i=function(t){return null!=(window.MediaSource||window.WebKitMediaSource)&&e.canPlay(t)},r=function(n){var i=_.transform(t.config.resources,_.map(function(e){return Tt.resourceManager.item(n.evaluatePaths(e.src))}),_.filter(function(e){return"function"==typeof e}),_.map(function(e){return e()}));return Promise.all(i).then(function(t){return e.factory(n)})};return{id:n,canPlay:i,factory:r}}},{key:"initialize",value:function(){if(this.playbackProxy=this.createPlaybackProxy(),null!=this.playbackProxy){var e=this.facade.player.retrieveProxy(ze.NAME);e.registerRenderer(this.renderer())}this.sendNotification(re.INITIALIZED)}},{key:"destroy",value:function(){null!=this.playbackProxy&&this.playbackProxy.destroy()}}],[{key:"NAME",get:function(){return J.NAME}}]),t}(Pe),tn=function(e){function t(n,i){var r;return babelHelpers.classCallCheck(this,t),r=e.call(this,n,i)||this,r.decryptionTypes=[H.WIDEVINE],r.temporalTypes=["vod","live","dvr"],r.playbackCoreName="hls",r.player=null,r.hlsConfig=null,r.fragErrorTime=0,r.timedMedatadata=null,r.currentMedatadata=null,r.id3Track=null,r.manifestParsed=!1,r.details=null,r.quality=-1,r.qualityMode="auto",r.userSwitched=!1,r}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"canPlayMedium",value:function(e){return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"canPlayMedium",this).call(this,e)||"audio"===e}},{key:"getConfig",value:function(){var e=this,t=U.merge({},this.config.settings,this.config.data),n=this.facade.configuration.getValueOf("withCredentials",this.config);if(n===!0){var i="function"==typeof t.xhrSetup?t.xhrSetup:function(){};t.xhrSetup=function(e,t){e.withCredentials=!0,i(e,t)}}t.debug=this.plugin.proxy.getDebug();var r=this.facade.getPreload();r!==W.NONE&&null==t.autoStartLoad&&(t.autoStartLoad=!0),r===W.AUTO&&null==t.startFragPrefetch&&(t.startFragPrefetch=!0);var a=this.facade.configuration.getValueOf("cmcd",this.config);null!=a&&a.enabled!==!1&&(t.cmcd=a);var s=this.facade.getMedia().keys;_.find(U.getKeySystem(),_.filter(function(e){return s&&!!s[e]}),_.filter(function(t){return e.decryptionTypes.indexOf(t)!==-1}),_.map(function(e){t.emeEnabled=!0,t.widevineLicenseUrl=s[e].serverURL}));var o=this.getActiveLoaders();return _.find(o,_.filter(function(e){return!!e.type}),_.map(function(e){return t[e.type]=e.loader})),t}},{key:"init",value:function(){var e=this;this.destroy(),this.manifestParsed=!1,this.userSwitched=!1,this.quality=-1;var n=this.getConfig(),i=new Hls(n);i.attachMedia(this.getMediaElement()),i.on(Hls.Events.MANIFEST_PARSED,this.onManifestParsed.bind(this)),i.on(Hls.Events.ERROR,this.onError.bind(this)),i.on(Hls.Events.LEVEL_LOADED,this.onLevelLoaded.bind(this)),i.on(Hls.Events.LEVEL_SWITCHING,this.onLevelSwitching.bind(this)),i.on(Hls.Events.LEVEL_SWITCHED,this.onLevelSwitched.bind(this)),i.on(Hls.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitch.bind(this)),i.on(Hls.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitch.bind(this)),i.on(Hls.Events.FRAG_LOADING,this.onFragmentLoadStart.bind(this)),i.on(Hls.Events.FRAG_LOADED,this.onFragmentLoaded.bind(this)),i.on(Hls.Events.FRAG_CHANGED,this.onFragmentChanged.bind(this)),_.each(Hls.Events,function(t){i.on(t,function(t,n){e.plugin.sendNotification(re.DISPATCH_EVENT,s.create(t,n))})});try{_.each(this.config.quality,function(e,t){return i[t]=e})}catch(e){}this.player=i,this.details=null,babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"init",this).call(this)}},{key:"unload",value:function(){this.destroy()}},{key:"applySrc",value:function(){this.currentMedatadata=null,this.player.loadSource(this.getSrc()),this.load()}},{key:"onManifestParsed",value:function(e,t){this.manifestParsed=!0,this.sendNotification(re.QUALITY_LEVELS_LOADED,t.levels),this.player.loadLevel=-1}},{key:"onLevelLoaded",value:function(e,t){this.player.levels[t.level].level=t.level,this.sendNotification(re.QUALITY_CHANGE,this.player.levels[t.level]),this.details=t.details;var n=this.details.totalduration;null!=n&&(this.data.duration=n,this.sendNotification(re.CHANGE_DURATION,this.data.duration)),this.details.live===!0&&"dvr"!==this.facade.mediaProxy.getTemporalType()&&this.facade.mediaProxy.setTemporalType("live")}},{key:"onLevelSwitching",value:function(e,t){this.getQualityMode()===St.MANUAL&&(this.userSwitched=!0),this.sendNotification(re.QUALITY_CHANGING,this.player.levels[t.level])}},{key:"onLevelSwitched",value:function(e,t){this.sendNotification(re.QUALITY_SWITCHED,this.player.levels[t.level])}},{key:"onAudioTrackSwitch",value:function(e,t){var n=e===Hls.Events.AUDIO_TRACK_SWITCHED;this.sendNotification(re.AUDIO_TRACK_SWITCH,{switched:n})}},{key:"onseeking",value:function(e){this.getQualityMode()===St.MANUAL&&this.userSwitched||babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onseeking",this).call(this,e)}},{key:"onseeked",value:function(e){return this.getQualityMode()===St.MANUAL&&this.userSwitched?void(this.userSwitched=!1):void babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onseeked",this).call(this,e)}},{key:"onFragmentLoadStart",value:function(e,t){try{var n=this.player.levels[t.frag.level].bitrate;this.sendNotification(re.FRAGMENT_LOAD_START,n)}catch(e){return}}},{key:"onFragmentLoaded",value:function(e,t){try{var n=this.player.levels[t.frag.level].bitrate;this.sendNotification(re.FRAGMENT_LOADED,n)}catch(e){return}}},{key:"onFragmentChanged",value:function(e,t){this.fragment=t.frag}},{key:"ontimeupdate",value:function(e){this.facade.ads.inProgress!==!0&&(this.data.currentTime=this.getCurrentTime(),this.sendNotification(re.TIME_CHANGE,{currentTime:this.data.currentTime}))}},{key:"ondurationchange",value:function(e){var t=this.getDetails().totalduration;t===this.data.duration||0===t||isNaN(t)||(this.data.duration=t,this.sendNotification(re.CHANGE_DURATION,t))}},{key:"oncanplaythrough",value:function(e){this.createTracks(),this.sendNotification(re.CAN_PLAY_THROUGH),this.sendNotification(re.PROGRESS,this.getDuration()),this.qualityMode===St.MANUAL&&this.player.currentLevel!==this.quality&&this.setQuality(this.quality)}},{key:"getStartTime",value:function(){return this.getMediaElement().duration-this.getDuration()}},{key:"getCurrentTime",value:function(){return this.getMediaElement().currentTime-this.getStartTime()}},{key:"getDetails",value:function(){return this.details||{}}},{key:"getFragmentDuration",value:function(){return this.getDetails().targetduration||0}},{key:"getCurrentTimeUTC",value:function(){var e,t;try{e=1e3*(this.getMediaElement().currentTime-this.fragment.start),t=this.fragment.programDateTime||this.fragment.sn}catch(n){t=0,e=0}return Math.round(e+t)}},{key:"goLive",value:function(){this.setCurrentTime(this.getDuration()-this.getFragmentDuration())}},{key:"getLiveTime",value:function(){return this.getMediaElement().duration-this.getFragmentDuration()}},{key:"isLive",value:function(){return Math.round(this.getStartTime()+this.getCurrentTime())>=Math.round(this.getLiveTime())}},{key:"seek",value:function e(n){var i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getStartTime(),e=function(e){return new Promise(function(t,n){try{var r=i.getMediaElement(),a=i.facade.timers.setInterval(function(){Math.round(r.currentTime)===Math.round(e)&&(i.facade.timers.clearInterval(a),r.dispatchEvent(new CustomEvent("seeked")))},100)}catch(e){n(e)}})};return Promise.race([babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"seek",this).call(this,n+r),e(n+r)]).then(function(e){"dvr"===i.mediaProxy.getTemporalType()&&i.sendNotification(re.IS_LIVE,i.isLive())})}},{key:"onplaying",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onplaying",this).call(this),this.retried=!1}},{key:"onError",value:function(e,t){if(this.userSwitched=!1,this.plugin.sendNotification(re.DISPATCH_EVENT,s.create(z.ERROR,{event:e,data:t})),this.config.ignoreErrors!==!0){if(this.config.retryOnError===!1||this.retried===!0)return this.retried=!1,void this.error(t);if(t.fatal&&t.type===Hls.ErrorTypes.MEDIA_ERROR&&t.details===Hls.ErrorDetails.FRAG_LOOP_LOADING_ERROR&&(t.fatal=!1),t.fatal)switch(t.type){case Hls.ErrorTypes.NETWORK_ERROR:this.retried=!0,this.manifestParsed?this.player.startLoad():this.player.loadSource(this.getSrc()),this.facade.logger.error("[AMP HLS] Playback Error trying to recover:",e);break;case Hls.ErrorTypes.MEDIA_ERROR:this.retried=!0,this.player.recoverMediaError(),this.facade.logger.error("[AMP HLS] Playback Error trying to recover:",e);break;default:this.facade.logger.error("[AMP HLS] Playback Error:",e),this.error(t)}else switch(t.details){case Hls.ErrorDetails.FRAG_LOOP_LOADING_ERROR:this.fragErrorTime===this.getMediaElement().currentTime?(this.getMediaElement().currentTime++,this.facade.logger.error("[AMP HLS] Frag Loop Load Error, Seeking to :",this.getMediaElement().currentTime)):this.fragErrorTime=this.getMediaElement().currentTime;break;case Hls.ErrorDetails.BUFFER_STALLED_ERROR:case Hls.ErrorDetails.BUFFER_NUDGE_ON_STALL:this.sendNotification(re.STALLED)}}}},{key:"error",value:function(e){switch(e.type){case Hls.ErrorTypes.NETWORK_ERROR:e.code=MediaError.MEDIA_ERR_NETWORK;break;case Hls.ErrorTypes.MEDIA_ERROR:e.code=MediaError.MEDIA_ERR_DECODE;break;default:e.toString=function(){return e.message}}e.message="".concat(e.type,": ").concat(e.details),this.sendNotification(re.ERROR,e)}},{key:"createTracks",value:function(){function e(e,t){var n=this.facade.tracks.getAudioTracks();t===!0&&(n.some(function(t){t.data.enabled=t.id==e.id}),this.player.audioTrack=e.id)}var t=this,n=this.player.audioTracks,i=this.player.audioTrack,r=this.facade.tracks.getAudioTracks(),a=n.length;n.forEach(function(n,s){if(U.fieldIsUnique(r,"id",n.id)!==!1){var o=new ye({kind:n.type,label:n.name||n.id,language:n.lang,id:n.id,enabled:n.id===i,data:n});o.changeEnabled=e.bind(t,n),r.add(o,s+1===a)}})}},{key:"onaddtrack",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"onaddtrack",this).call(this,e);var n=e.track;null==this.facade.captioning&&Me.test(n.kind)&&this.facade.timers.setTimeout(function(){return n.mode=Ae.DISABLED},10)}},{key:"setQuality",value:function(e){var t=e===-1?St.AUTO:St.MANUAL;return this.setQualityMode(t),t===St.MANUAL?this.setMaxQualityLevel(-1):this.setCapLevelToPlayerSize(),e===this.player.currentLevel&&e>-1?(this.onLevelSwitching("hlsLevelSwitching",this.player.levels[e]),void this.onLevelSwitched("hlsLevelSwitched",{level:e})):(null!=this.player&&(this.player.currentLevel=this.quality=e),this.quality)}},{key:"getQuality",value:function(){var e=this.player,t=null!=e?e.currentLevel:null;return t===-1&&(t=null!=e?e.nextLoadLevel:null),t}},{key:"getQualityLevels",value:function(){var e=this.player;return null!=e?e.levels:babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getQualityLevels",this).call(this)}},{key:"getQualityMode",value:function(){return this.qualityMode}},{key:"setQualityMode",value:function(e){return this.qualityMode=e,e}},{key:"setMaxQualityLevel",value:function(e){if(null!=this.player){var t=this.getQualityLevels(),n=t.filter(function(t){return t.bitrate<=e}).length-1;return this.setCapLevelToPlayerSize(-1>=n),this.player.autoLevelCapping=n,n}}},{key:"getMaxQualityLevel",value:function(){if(null!=this.player)return this.player.autoLevelCapping}},{key:"setCapLevelToPlayerSize",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=U.get(this.config,["data","capLevelToPlayerSize"]),n=St.AUTO===this.qualityMode&&t!==!1&&e;return this.player.capLevelToPlayerSize=n,this.player.capLevelToPlayerSize}},{key:"destroy",value:function(){if(null!=this.player)try{babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"destroy",this).call(this),this.player.destroy(),this.player=null}catch(e){}}},{key:"registerCustomLoader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.playbackCoreName,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"loader";if("function"==typeof e)return this.customLoaders.push({name:t,loader:e,type:n})}}]),t}(Re),nn=function(e){function t(n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,n)||this,i.defaults={types:["application/x-mpegURL"],data:{enableWorker:!0,enableCEA708Captions:!0},settings:{enableSoftwareAES:!0,capLevelToPlayerSize:!0,lowLatencyMode:!1},buffer:null,quality:null,withCredentials:null,retryOnError:!0,ignoreErrors:!1},i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"createPlaybackProxy",value:function(){return new tn(this.getData(),this.facade)}}],[{key:"NAME",get:function(){return J.NAME}}]),t}(en),rn=function(e){function t(){return babelHelpers.classCallCheck(this,t),e.call(this)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"execute",value:function(e){var t,n;"freewheel"===(null!=(n=e.getBody())?n.partner:void 0)&&(t=this.facade.player.getPlaybackRate(),this.proxy.destroy(),this.facade.player.setPlaybackRate(t))}}]),t}(Xt),an=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this)||this,n.moduleName="hls",n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"createModel",value:function(){this.proxy=new nn(this.config),this.registerProxy(this.proxy)}},{key:"createController",value:function(){this.registerCommand($e.BREAK_START,rn),babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"createController",this).call(this)}},{key:"logEvent",value:function(e){/^hls/.test(e.type)!==!0&&babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"logEvent",this).call(this,e)}},{key:"listNotificationInterests",value:function(){return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"listNotificationInterests",this).call(this).concat([$e.BREAK_START])}},{key:"listNotificationPublications",value:function(){return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"listNotificationPublications",this).call(this).concat([re.TIMED_METADATA,re.QUALITY_LEVELS_LOADED,re.QUALITY_CHANGE,re.QUALITY_CHANGING,re.FRAGMENT_LOAD_START,re.FRAGMENT_LOADED])}}]),t}(Jt),sn=function(e){function t(n,i,r){return babelHelpers.classCallCheck(this,t),e.call(this,n,i,r)||this}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"type",get:function(){return"metadata"}},{key:"data",set:function(e){return this.value=e}}]),t}(ge),on=function(e){function n(t,i){var r;return babelHelpers.classCallCheck(this,n),r=e.call(this,t,i)||this,r.buffer=t.buffer,r.decryptionTypes=[H.WIDEVINE,H.PLAYREADY,H.CLEARKEY],r.temporalTypes=["vod","live","dvr"],n.SCTE=r.config.schemeIdUri,n.FRAGMENT_DURATION=r.config.fragmentDuration,r.playbackCoreName="dash",r.context=null,r.player=null,r.buffer=null,r}return babelHelpers.inherits(n,e),babelHelpers.createClass(n,[{key:"resumecomplete",value:function(){try{var e=this.facade.getMediaElement(),t=null!=e?e.textTracks:void 0;if(0!==(null!=t?t.length:void 0)){var i=t[0];null!=i&&(i.mode="hidden")}}catch(e){}babelHelpers.get(babelHelpers.getPrototypeOf(n.prototype),"resumecomplete",this).call(this)}},{key:"onerror",value:function(){}},{key:"ontimeupdate",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(n.prototype),"ontimeupdate",this).call(this,{target:{currentTime:this.getCurrentTime()}})}},{key:"onseeked",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(n.prototype),"onseeked",this).call(this,{target:{currentTime:this.getCurrentTime()}})}},{key:"onseeking",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(n.prototype),"onseeking",this).call(this,{target:{currentTime:this.getCurrentTime()}})}},{key:"ondurationchange",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(n.prototype),"ondurationchange",this).call(this,{target:{duration:this.getDuration()}})}},{key:"onloadedmetadata",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(n.prototype),"onloadedmetadata",this).call(this,e),this.sendNotification(re.CHANGE_DURATION,this.getDuration())}},{key:"oncanplaythrough",value:function(e){babelHelpers.get(babelHelpers.getPrototypeOf(n.prototype),"oncanplaythrough",this).call(this,e),this.sendNotification(re.CHANGE_DURATION,this.getDuration())}},{key:"canPlayMedium",value:function(e){return babelHelpers.get(babelHelpers.getPrototypeOf(n.prototype),"canPlayMedium",this).call(this,e)||"audio"===e}},{key:"getMedium",value:function(){return U.get(this.facade,["media","medium"])||"video"}},{key:"createTracks",value:function(){var e=this;if(!this.player||null!=this.player.getActiveStream()){var t=this.player.getTracksFor("audio"),n=this.player.getCurrentTrackFor("audio"),i=this.facade.tracks.getAudioTracks(),r=t.length;_.each(t,function(t,a){var s=t.id||a;if(null==s||U.fieldIsUnique(i,"id",s)!==!1){var o=new ye({kind:t.roles.join(" "),label:t.id,language:t.lang,id:s,enabled:t===n,data:t});o.changeEnabled=e.changeEnabled.bind(e,t,o),i.add(o,a+1===r)}})}}},{key:"changeEnabled",value:function(e,t,n){var i=this.facade.tracks.getAudioTracks();_.each(i.list,function(e){return e.data.enabled=e===t}),n===!0&&this.player.setCurrentTrack(e)}},{key:"logLevel",value:function(){var e=this.plugin.proxy.getDebug(),t=babelHelpers.typeof(e);switch(t){case"number":return e;case"boolean":return e===!0?dashjs.Debug.LOG_LEVEL_DEBUG:dashjs.Debug.LOG_LEVEL_NONE;default:return dashjs.Debug.LOG_LEVEL_NONE}}},{key:"init",value:function(){var e=this;try{var t=this.config;if(null==this.player){var i=dashjs.MediaPlayer().create();i.on(dashjs.MediaPlayer.events.ERROR,this.onError.bind(this)),i.on(dashjs.MediaPlayer.events.FRAGMENT_LOADING_STARTED,this.onFragmentLoadStart.bind(this)),i.on(dashjs.MediaPlayer.events.FRAGMENT_LOADING_COMPLETED,this.onFragmentLoaded.bind(this)),i.on(dashjs.MediaPlayer.events.QUALITY_CHANGE_REQUESTED,this.onQualityChangeRequested.bind(this)),i.on(dashjs.MediaPlayer.events.QUALITY_CHANGE_RENDERED,this.onQualityChangeRendered.bind(this)),i.on(dashjs.MediaPlayer.events.MANIFEST_LOADED,this.onManifestLoaded.bind(this)),i.on(dashjs.Protection.events.PROTECTION_CREATED,this.onProtectionCreated.bind(this)),i.on(dashjs.MediaPlayer.events.BUFFER_EMPTY,this.onBufferEmpty.bind(this)),i.on(n.SCTE,this.onEmsg.bind(this)),i.on(dashjs.MediaPlayer.events.TTML_TO_PARSE,this.onTmlToParse.bind(this)),i.on(dashjs.MediaPlayer.events.TEXT_TRACKS_ADDED,this.onTracksAdded.bind(this)),i.initialize(this.getMediaElement(),null,!1);var r=U.merge({debug:{logLevel:this.logLevel()},streaming:{fastSwitchEnabled:!0}},t.data,t.settings);null!=t.lowLatencyEnabled&&U.set(r,["streaming","lowLatencyEnabled"],t.lowLatencyEnabled),null!=t.liveDelay&&U.set(r,["streaming","liveDelay"],t.liveDelay),null!=t.catchUpPlaybackRate&&U.set(r,["streaming","liveCatchUpPlaybackRate"],t.catchUpPlaybackRate),null!=t.initialBitrate&&U.set(r,["streaming","abr","initialBitrate",this.getMedium()],t.initialBitrate);var a=this.facade.configuration.getValueOf("cmcd",t);null!=a&&a.enabled!==!1&&U.set(r,["streaming","cmcd"],this.createCmcdConfig(a)),i.updateSettings(r),this.player=i}var s=this.facade.configuration.getValueOf("withCredentials",t);null!=s&&("boolean"==typeof s&&(s={default:s}),_.each(s,function(t,n){return e.player.setXHRWithCredentialsForType(n,t)})),babelHelpers.get(babelHelpers.getPrototypeOf(n.prototype),"init",this).call(this)}catch(e){this.facade.logger.error(e)}}},{key:"isLive",get:function(){return this.getCurrentTime()>=this.getDuration()-n.FRAGMENT_DURATION}},{key:"notifyDVRLiveStatus",value:function(){"dvr"===this.mediaProxy.getTemporalType()&&this.sendNotification(re.IS_LIVE,this.isLive)}},{key:"onplay",value:function(){babelHelpers.get(babelHelpers.getPrototypeOf(n.prototype),"onplay",this).call(this),this.notifyDVRLiveStatus()}},{key:"applySrc",value:function(){var e=this.facade.getMedia().keys;null!=e&&this.player.setProtectionData(e),this.player.attachSource(this.getSrc()),this.load()}},{key:"preload",value:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.facade.getPreload()}},{key:"goLive",value:function(){this.setCurrentTime(this.getDuration())}},{key:"seek",value:function(e){var t=this;return Promise.resolve(this.player.seek(e)).then(function(e){t.notifyDVRLiveStatus()})}},{key:"getCurrentTime",value:function(){return this.player?this.player.time():0}},{key:"getDuration",value:function(){return this.player?this.player.duration():0}},{key:"getCurrentTimeUTC",value:function(){return this.player?Math.round(1e3*this.player.timeAsUTC()):0}},{key:"getStats",value:function(){return{}}},{key:"createCmcdConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={deviceId:"did",contentId:"cid",sessionId:"sid",version:"v"};return Object.keys(e).filter(function(e){return!!n[e]}).reduce(function(t,i){return t[n[i]]=e[i],t},t({enabled:!0},e.useHeaders===!0&&{mode:"header"}))}},{key:"onFragmentLoadStart",value:function(e){var t=e.request.mediaInfo.bitrateList[e.request.quality].bandwidth;this.sendNotification(re.FRAGMENT_LOAD_START,t)}},{key:"onFragmentLoaded",value:function(e){var t=e.request.mediaInfo.bitrateList[e.request.quality].bandwidth;this.sendNotification(re.FRAGMENT_LOADED,t)}},{key:"onQualityChangeRequested",value:function(e){this.sendNotification(re.QUALITY_CHANGING,this.getQualityLevels()[e.newQuality]),this.sendNotification(re.QUALITY_SWITCHED,this.getQualityLevels()[e.newQuality])}},{key:"onQualityChangeRendered",value:function(e){this.sendNotification(re.QUALITY_SWITCHED,this.getQualityLevels()[e.newQuality])}},{key:"onManifestLoaded",value:function(e){this.plugin.sendNotification(re.DISPATCH_EVENT,s.create(dashjs.MediaPlayer.events.MANIFEST_LOADED,e.data))}},{key:"onProtectionCreated",value:function(e){this.plugin.sendNotification(re.DISPATCH_EVENT,s.create(dashjs.Protection.events.PROTECTION_CREATED,e.data))}},{key:"onBufferEmpty",value:function(e){"video"===e.mediaType&&this.sendNotification(re.STALLED)}},{key:"onEmsg",value:function(e){var t=e.event;this.plugin.sendNotification(re.DISPATCH_EVENT,s.create(e.type,t));var i=1e4*(t.presentationTime||t.calculatedPresentationTime/t.presentationTimeDelta),r=i+t.duration/t.presentationTimeDelta*1e4,a=String.fromCharCode.apply(null,t.messageData),o=be.parse(a);t.text=a;var l=new sn(i,r,{key:n.SCTE,data:t,info:o});this.sendNotification(re.TIMED_METADATA,l)}},{key:"onTracksAdded",value:function(e){var t=this.player;if(null==this.facade.captioning)return void t.setTextTrack(-1);var n=this.facade.captioning.getTracks(),i=this.facade.textTracks,r=function(e,t){return(e.isFromCEA608!==!0||t.type===U.mimeTypes.cea608)&&((e.isEmbedded!==!0||t.type===U.mimeTypes.cea708)&&((e.isTTML!==!0||t.type===U.mimeTypes.ttml)&&U.compareLanguageTags(e.language,t.language)===!0))},a=function(e){_.each(i,function(n,i){r(n,e)&&t.setTextTrack(i)})},s=function(e,i){i===!0&&(t.setTextTrack(-1),a(e),_.each(n,function(t){return t.data.enabled=t===e}))};_.each(n,function(e,t){e.changeEnabled=s.bind(this,e),e.enabled===!0&&a(e)})}},{key:"onTmlToParse",value:function(e){this.sendNotification(ve.TTML_CUE_CHANGE,e)}},{key:"onError",value:function(e){var t=e.error;this.plugin.sendNotification(re.DISPATCH_EVENT,s.create(z.ERROR,t)),this.sendNotification(re.ERROR,t)}},{key:"setQuality",value:function(e){if(this.player){var t=e===-1?St.AUTO:St.MANUAL;return this.setQualityMode(t),t===St.MANUAL&&this.setMaxQualityLevel(-1),this.player.setQualityFor("video",e),e}}},{key:"getQuality",value:function(){if(this.player)return this.player.getQualityFor("video")}},{key:"getQualityLevels",value:function(){if(this.player)return this.player.getBitrateInfoListFor("video")||babelHelpers.get(babelHelpers.getPrototypeOf(n.prototype),"getQualityLevels",this).call(this)}},{key:"getQualityMode",value:function(){if(this.player){var e=this.player.getSettings(),t=U.get(e,["streaming","abr","autoSwitchBitrate",this.getMedium()]);return t===!0?St.AUTO:St.MANUAL}}},{key:"setQualityMode",value:function(e){if(this.player&&e!==this.getQualityMode()){var t=this.player.getSettings();return U.set(t,["streaming","abr","autoSwitchBitrate",this.getMedium()],e==St.AUTO),this.player.updateSettings(this.settings),e}}},{key:"setMaxQualityLevel",value:function(e){if(null!=this.player&&"number"==typeof e){var t=this.getQualityLevels(),n=this.player.getSettings(),i=t.filter(function(t){return t.bitrate<=e}).length-1,r=t[i]?t[i].bitrate/1e3:i;return U.set(n,["streaming","abr","maxBitrate",this.getMedium()],r),this.player.updateSettings(this.settings),i}}},{key:"getMaxQualityLevel",value:function(){if(null!=this.player){var e=this.getQualityLevels(),t=this.player.getSettings(),n=U.get(t,["streaming","abr","maxBitrate",this.getMedium()]);return e.filter(function(e){return e.bitrate<=1e3*n}).length-1}}},{key:"destroy",value:function(){this.player&&(this.player.reset(),babelHelpers.get(babelHelpers.getPrototypeOf(n.prototype),"destroy",this).call(this))}}]),n}(Re),ln=function(e){function t(n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,n)||this,i.defaults={types:["application/dash+xml"],buffer:null,initialBitrate:null,lowLatencyEnabled:null,liveDelay:null,catchUpPlaybackRate:null,withCredentials:null,data:null,settings:null,schemeIdUri:"urn:scte:scte35:2013:xml",fragmentDuration:10},i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"createPlaybackProxy",value:function(){return new on(this.getData(),this.facade)}}],[{key:"NAME",get:function(){return J.NAME}}]),t}(en),un=function(e){function t(){var n;return babelHelpers.classCallCheck(this,t),n=e.call(this)||this,n.moduleName="dash",n}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"createModel",value:function(){this.proxy=new ln(this.config),this.registerProxy(this.proxy)}},{key:"listNotificationPublications",value:function(){return babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"listNotificationPublications",this).call(this).concat([re.FRAGMENT_LOAD_START,re.FRAGMENT_LOADED])}}]),t}(Jt);P.constructed=P.construct(),re.init(),Tt.registerPlugin("hls","html",an),Tt.registerPlugin("dash","html",un),Tt.registerPlugin("captioning","html",$t);var cn=MutationObserver||WebKitMutationObserver,hn=new cn(function(e,t){e.forEach(function(e){i(e.addedNodes)})});if(document.body)n();else{var dn=function e(){document.removeEventListener("DOMContentLoaded",e),r(),n()};document.addEventListener("DOMContentLoaded",dn)}r();var fn={fp:_,amp:{ActiveState:ce,Ad:Dt,AdEvents:Object.entries($e).reduce(function(e,t){return e[t[0].replace(/^AD_/,"")]=t[1].replace(/^ads/,""),e},{}),AdPlugin:Rt,ads:{AdNotifications:$e,AdPlugin:Bt,AdProxy:Ut,AdRequest:Vt,AdVO:Dt},ApplicationStateProxy:he,AMP:Tt,AMPError:a,AmpError:a,AuthEvents:de,Authorization:Ht,AuthPlugin:Ot,AuthProvider:Nt,AuthProviderList:_t,AutoplayPolicy:B,AutoplayThreshold:F,CaptionRenderer:He,CaptionCue:me,CaptionTrack:_e,Config:Q,CSS:V,Cue:ge,DataBinding:$,DataBoundConfigurationProxy:J,DisplayState:le,Event:s,Events:z,EventDispatcher:o,KeySystem:H,Logger:Y,Media:Lt,MediaProxy:Be,Medium:Pt,ModuleProxy:J,Notifications:re,OverlayMediator:Je,PlayerProxy:ze,PlayState:ue,Plugin:It,Preload:W,PreviewTrack:Ke,QualityMode:St,QueryString:P,Resource:Mt,get Settings(){return yt.GET()},SMPTETTParser:ke,SRTParser:Ee,Timer:l,Transformer:ne,TransformType:ie,URL:S,Utils:U,XMLUtils:be,utils:{Logger:Y,QueryString:P,Timer:l,Utils:U,XMLUtils:be},WebVTTParser:Te}};return fn}();