this.akamai=this.akamai||{},this.akamai.amp=this.akamai.amp||{},this.akamai.amp.googleanalytics=function(e){"use strict";var t=akamai.fp,a=function(){function e(t,a){babelHelpers.classCallCheck(this,e),this.config=t,this.plugin=a}return babelHelpers.createClass(e,[{key:"data",get:function(){return this.plugin.data}},{key:"viewDuration",get:function(){return this.plugin.viewDuration||0}},{key:"getMetadata",value:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video",n=this.data.events&&this.data.events[a];if(null!=n&&null!=e)return t.find(n,t.filter(function(t){return t&&t.type==e}),t.map(function(e){return e.data||e.detail}))}},{key:"trackEvent",value:function(e,t){}},{key:"generateGoogleAnalyticsVO",value:function(){}}]),e}(),n=function(e){function t(a,n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,a,n)||this,ga("create",i.config.trackingId,"auto"),i.data.disablePageView!==!0&&ga("send","pageview"),i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"generateGoogleAnalyticsVO",value:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video",n=babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getMetadata",this).call(this,e,a),i={};for(var r in n){var s=n[r];if("customDimension"===r){var l=new Object;for(var o in s){var c=s[o];"viewDuration"===c&&(c=this.viewDuration),ga("set",o,c),l[o]=c}s=l}i[r.toLowerCase()]=s}return i}},{key:"trackEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video",a=this.generateGoogleAnalyticsVO(e,t);if(null!=a&&(this.data.nonInteraction!==!1&&ga("set","nonInteraction",!0),ga("send","event",a.eventcategory,a.eventaction,a.eventlabel,a.eventvalue),null!=a.customdimension))for(var n in a.customdimension)ga("set",n,null)}}]),t}(a),i=akamai.fp,r=new Map([["eventAction","event_action"],["eventCategory","event_category"],["eventLabel","event_label"],["eventValue","value"],["nonInteraction","non_interaction"]]),s=function(e){function t(a,n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,a,n)||this,window.dataLayer=window.dataLayer||[],window.gtag=function(){dataLayer.push(arguments)},gtag("js",new Date),gtag("config",i.config.trackingId,{send_page_view:i.data.disablePageView!==!0}),i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"generateGoogleAnalyticsVO",value:function(e,a){var n=this,s=babelHelpers.get(babelHelpers.getPrototypeOf(t.prototype),"getMetadata",this).call(this,e,a),l={};for(var o in s){var c=r.get(o)||o,u=s[o];null!=u&&(l[c]=u,"customDimension"===o&&i.each(u,function(e,t){"viewDuration"===e?l[t]=n.viewDuration:l[t]=e}))}return l}},{key:"trackEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video",a=this.generateGoogleAnalyticsVO(e,t);null!=a&&(this.data.nonInteraction!==!1&&(a.non_interaction=!0),gtag("event",e,a))}}]),t}(a),l=function(){function e(t){babelHelpers.classCallCheck(this,e),this.manager=t}return babelHelpers.createClass(e,[{key:"track",value:function(e,t){this.manager&&this.manager.trackEvent(e,t)}}],[{key:"create",value:function(t,a){var i;return i="gtag"===t.mode?new s(t,a):new n(t,a),new e(i)}}]),e}(),o=function(e){function t(a,n){var i;return babelHelpers.classCallCheck(this,t),i=e.call(this,a,n)||this,i.manager=l.create(n,babelHelpers.assertThisInitialized(i)),i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"trackEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video";this.manager.track(e,t)}},{key:"onready",value:function(){this.bindHandlers(["onadstarted","onadended"]),this.player.addEventListener("adstarted",this.onadstarted),this.player.addEventListener("adended",this.onadended)}},{key:"onstarted",value:function(){this.started=!0,this.currentTime=0,this.viewDuration=0,this.manager.track("started")}},{key:"onended",value:function(){this.started!==!1&&(this.started=!1,this.manager.track("ended"))}},{key:"ontimeupdate",value:function(e){var t=Math.round(e.detail);t>this.currentTime&&(this.viewDuration++,this.currentTime=t)}},{key:"onadstarted",value:function(){this.manager.track("started","ads")}},{key:"onadended",value:function(){this.manager.track("ended","ads")}}]),t}(akamai.amp.Plugin);return akamai.amp.AMP.registerPlugin("googleanalytics",akamai.amp.Plugin.createFactory(o)),e.GoogleAnalytics=o,Object.defineProperty(e,"__esModule",{value:!0}),e}({});