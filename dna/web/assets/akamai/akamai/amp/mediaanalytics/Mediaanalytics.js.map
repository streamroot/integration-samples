{"version":3,"file":"Mediaanalytics.js","sources":["../../../../src/MediaAnalytics.js","../../../../src/MediaAnalyticsFlash.js","../../../../src/main.js"],"sourcesContent":["export default class MediaAnalytics extends akamai.amp.Plugin {\n\n  constructor(player, config) {\n    super(player, config)\n    this.sdk = new JS_AkamaiMediaAnalytics(config.config)\n    this.sdk.disableLocation()\n\n    if (config.iplookup === false) {\n      this.sdk.disableServerIPLookUp()\n    }\n    this.initialized = false\n  }\n\n  setDimensions(value) {\n    let dimensions = this.config.dimensions\n    for (let key in value) {\n      let val = value[key]\n      if (val != null) {\n        dimensions[key] = val // TODO: Does this need to be evaluated for bindings?\n      }\n    }\n    this.applyDimensions(dimensions)\n    return value\n  }\n\n  amaCallbacks(playerInstance) {\n    this.getStreamHeadPosition = function() {\n      if (playerInstance) {\n        return playerInstance.currentTime\n      }\n    }\n  }\n\n  applyDimensions(dimensions) {\n    try {\n      for (let key in dimensions) {\n        this.sdk.setData(key, this.player.evaluateBindings(dimensions[key]))\n      }\n    }\n    catch (error) {\n      this.logger.error(\"[AMP MEDIA ANALYTICS ERROR]\", \"Could not set dimensions:\", error)\n    }\n  }\n\n  onready(event) {\n    this.player.addEventListener(\"adbreakstart\", this.onadbreakstart.bind(this))\n    this.player.addEventListener(\"adbreakend\", this.onadbreakend.bind(this))\n    this.player.addEventListener(\"adloaded\", this.onadloaded.bind(this))\n    this.player.addEventListener(\"adstarted\", this.onadstarted.bind(this))\n    this.player.addEventListener(\"adended\", this.onadended.bind(this))\n    this.player.addEventListener(\"adskipped\", this.onadbreakskipped.bind(this))\n    this.player.addEventListener(\"aderror\", this.onaderror.bind(this))\n    this.player.addEventListener(\"adfirstquartile\", this.onadfirstquartile.bind(this))\n    this.player.addEventListener(\"admidpoint\", this.onadmidpoint.bind(this))\n    this.player.addEventListener(\"adthirdquartile\", this.onadthirdquartile.bind(this))\n  }\n\n  onplayrequest(event) {\n    if (this.initialized == false) {\n      this.logger.log(\"[AMP MA EVENT] - handleSessionInit\")\n      this.sdk.handleSessionInit(new this.amaCallbacks(this.player))\n      this.initialized = true\n    }\n  }\n\n  onmediasequenceended(event) {\n    this.logger.log(\"[AMP MA EVENT] - handlePlayEnd\")\n    this.sdk.handlePlayEnd()\n  }\n\n  onplaying(event) {\n    if (this.player.ads != null && this.player.ads.inProgress)\n      return\n    this.logger.log(\"[AMP MA EVENT] - handlePlaying\")\n    this.sdk.handlePlaying()\n  }\n\n  onmediachange(event) {\n    let media = event.detail\n    let dimensions = null\n\n    this.initialized = false\n    this.logger.log(\"[AMP MA EVENT] - setStreamURL\", media.src)\n    this.sdk.setStreamURL(media.src, true)\n\n    let viewerId = this.config.viewerId || this.config.viewerID || this.config[\"std:viewerId\"]\n    if (viewerId != null) {\n      this.sdk.setViewerId(viewerId)\n    }\n\n    let config = media.mediaanalytics\n    if (config != null && config.dimensions != null) {\n      dimensions = akamia.amp.Utils.override(this.config.dimensions, config.dimensions)\n    } else {\n      dimensions = this.config.dimensions\n    }\n\n    //this.sdk.handleStreamSwitch()\n    this.applyDimensions(dimensions)\n  }\n\n  ondurationchange(event) {\n    this.logger.log(\"[AMP MA EVENT] - setStreamDuration\", event.detail)\n    this.sdk.setStreamDuration(event.detail)\n  }\n\n  updateMedia(media) {\n    this.logger.log(\"[AMP MA EVENT] - handleTitleSwitch\")\n    this.sdk.handleTitleSwitch(media)\n  }\n\n  onfragmentloadstart(event) {\n    if (typeof fragmentDownloadStarted === \"function\") {\n      fragmentDownloadStarted(event.detail)\n    }\n  }\n\n  onadbreakstart() {\n    this.player.mediaElement.dataset.isad = true\n  }\n\n  onadbreakend() {\n    this.player.mediaElement.dataset.isad = false\n  }\n\n  onadloaded(event) {\n    try {\n      let adVO = event.data\n      let adObject = {\n        adTitle: adVO.title,\n        adDuration: adVO.duration,\n        adPartnerId: adVO.partner,\n        adId: adVO.id\n      }\n      this.logger.log(\"[AMP MA EVENT] - handleAdLoaded\")\n      this.sdk.handleAdLoaded(adObject)\n    }\n    catch (error) {\n      this.logger.error(\"[AMP MEDIA ANALYTICS ERROR]\", error)\n    }\n  }\n\n  onadstarted() {\n    this.logger.log(\"[AMP MA EVENT] - handleAdStarted\")\n    this.sdk.handleAdStarted()\n  }\n\n  onadbreakskipped() {\n    this.logger.log(\"[AMP MA EVENT] - handleAdSkipped\")\n    this.sdk.handleAdSkipped()\n  }\n\n  onaderror(event) {\n    this.logger.log(\"[AMP MA EVENT] - handleAdError\")\n    this.sdk.handleAdError(event)\n  }\n\n  onadfirstquartile() {\n    this.logger.log(\"[AMP MA EVENT] - handleAdFirstQuartile\")\n    this.sdk.handleAdFirstQuartile()\n  }\n\n  onadmidpoint() {\n    this.logger.log(\"[AMP MA EVENT] - handleAdMidPoint\")\n    this.sdk.handleAdMidPoint()\n  }\n\n  onadthirdquartile() {\n    this.logger.log(\"[AMP MA EVENT] - handleAdThirdQuartile\")\n    this.sdk.handleAdThirdQuartile()\n  }\n\n  onadended() {\n    this.logger.log(\"[AMP MA EVENT] - handleAdComplete\")\n    this.sdk.handleAdComplete()\n  }\n\n  onpause() {\n    this.logger.log(\"[AMP MA EVENT] - handlePause\")\n    this.sdk.handlePause()\n  }\n\n  onseeking() {\n    if (this.player.currentTime > 0.1 || this.player.currentTime === 0) {\n      this.sdk.handleSeekStart()\n      this.logger.log(\"[AMP MA EVENT] - handleSeekStart\")\n    }\n  }\n\n  onseeked() {\n    if (this.player.currentTime > 0.1 || this.player.currentTime === 0) {\n      this.sdk.handleSeekEnd()\n      this.logger.log(\"[AMP MA EVENT] - handleSeekEnd\")\n    }\n  }\n\n  onerror(event) {\n    this.logger.log(\"[AMP MA EVENT] - handleError\", event.detail)\n    this.sdk.handleError(event.detail)\n  }\n\n  onbufferingchange(event) {\n    this.logger.log(\"[AMP MA EVENT] - handleBufferStart\", event.detail)\n    if (event.detail === true)\n      this.sdk.handleBufferStart()\n    else\n      this.sdk.handleBufferEnd()\n  }\n\n  onqualitychange(event) {\n    this.logger.log(\"[AMP MA EVENT] - handleBitRateSwitch\", event.data.bitrate)\n    this.sdk.handleBitRateSwitch(event.data.bitrate)\n  }\n\n}\n","export default class MediaAnalyticsFlash extends akamai.amp.FlashPlugin {\n\n  constructor(player, config) {\n    super(player, config)\n  }\n\n  get flashPlugins() {\n    return [{\n      id: \"OSMFCSMALoader\",\n      host: \"osmf\",\n      main: \"com.akamai.playeranalytics.osmf.OSMFCSMALoaderInfo\",\n      type: \"application/x-shockwave-flash\"\n    }]\n  }\n\n  setDimensions(value) {\n    this.player.mediaElement.setPlayerProperty(\"maDimensions\", value)\n    return value\n  }\n\n  createFlashVars(event) {\n    const flashvars = event.detail.flashvars\n    const dimensions =  this.player.config && this.player.config.media && this.player.config.media.mediaanalytics\n\n    if (dimensions != null) {\n      for (let key in dimensions) {\n        flashvars[\"report_\" + key] = dimensions[key]\n      }\n    }\n  }\n\n  createXML(event) {\n    const xml = event.detail.xml\n    const application = xml.firstChild\n    let metrics = xml.getElementsByTagName(\"metrics\")[0]\n    let element = null\n\n    if (metrics == null) {\n      metrics = xml.createElement(\"metrics\")\n      application.appendChild(metrics)\n    }\n\n    const vendor = xml.createElement(\"vendor\")\n    vendor.setAttribute(\"id\", \"akamai\")\n    metrics.appendChild(vendor)\n\n    if (this.config.config != null) {\n      this.createProperty(xml, \"MEDIA_ANALYTICS_BEACON\", this.config.config, vendor)\n\n      const path = this.config.plugin.swf || \"http://79423.analytics.edgesuite.net/csma/plugin/csma.swf\"\n      this.createProperty(xml, \"MEDIA_ANALYTICS_PLUGIN_PATH\", path, vendor)\n    }\n\n    if (this.config.dimensions != null) {\n      this.createProperty(xml, \"dimensions\", this.config.dimensions, vendor)\n    }\n  }\n\n  onmediachange(event) {\n    const media = event.detail\n    if (media.mediaanalytics && media.mediaanalytics.dimensions) {\n      media.dimensions = []\n      for (let key in media.mediaanalytics.dimensions) {\n        media.dimensions.push({key: key, value: media.mediaanalytics.dimensions[key]})\n      }\n    }\n  }\n}\n","import MediaAnalytics from \"./MediaAnalytics.js\"\nimport MediaAnalyticsFlash from \"./MediaAnalyticsFlash.js\"\n\nakamai.amp.AMP.registerPlugin(\"mediaanalytics\", \"html\", akamai.amp.Plugin.createFactory(MediaAnalytics))\nakamai.amp.AMP.registerPlugin(\"mediaanalytics\", \"flash\", akamai.amp.Plugin.createFactory(MediaAnalyticsFlash))\n\nexport {MediaAnalytics}\n"],"names":["MediaAnalytics","player","config","sdk","JS_AkamaiMediaAnalytics","disableLocation","iplookup","disableServerIPLookUp","initialized","value","dimensions","key","val","applyDimensions","playerInstance","getStreamHeadPosition","currentTime","setData","evaluateBindings","error","logger","event","addEventListener","onadbreakstart","bind","onadbreakend","onadloaded","onadstarted","onadended","onadbreakskipped","onaderror","onadfirstquartile","onadmidpoint","onadthirdquartile","log","handleSessionInit","amaCallbacks","handlePlayEnd","ads","inProgress","handlePlaying","media","detail","src","setStreamURL","viewerId","viewerID","setViewerId","mediaanalytics","akamia","amp","Utils","override","setStreamDuration","handleTitleSwitch","fragmentDownloadStarted","mediaElement","dataset","isad","adVO","data","adObject","title","duration","partner","id","handleAdLoaded","handleAdStarted","handleAdSkipped","handleAdError","handleAdFirstQuartile","handleAdMidPoint","handleAdThirdQuartile","handleAdComplete","handlePause","handleSeekStart","handleSeekEnd","handleError","handleBufferStart","handleBufferEnd","bitrate","handleBitRateSwitch","akamai","Plugin","MediaAnalyticsFlash","setPlayerProperty","flashvars","xml","application","firstChild","metrics","getElementsByTagName","element","createElement","appendChild","vendor","setAttribute","createProperty","path","plugin","swf","push","FlashPlugin","AMP","registerPlugin","createFactory"],"mappings":"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"}